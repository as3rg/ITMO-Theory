\documentclass[12pt]{article}
\input{../../header.tex}
\title{Линейная алгебра. Теория}
\author{Александр Сергеев}
\date{}

\begin{document}
\maketitle
\section{Линейное отображение}
\subsection{Основные определения. Теорема о ранге и дефекте линейного отображения}
Пусть $V, U$ - линейные пространства над полем $K(\Rset, \Cset)$\\
\textbf{Определение}\\
$\mcA: U \rto V$ -- \textit{линейное отображение}, если $\fall \lambda\ \in K, u_1, u_2 \in U\ \mcA(\lambda u_1 + u_2) = \lambda \mcA(u_1) + \mcA(u_2)$\\
\textbf{Замечания}
\begin{enumerate}
    \item Обозначение: $\mcA(u) = \mcA u$
    \item $\mcA(\0_U) = \0_V$
    \item Для $\mcA, \mcB, \lambda, u$ поточечно определены $\mcA u+\mcB u, \lambda \mcA u$
\end{enumerate}
\textbf{Примеры}
\begin{enumerate}
    \item $\0 u = \0_V$
    \item $\epsilon v = v$
    \item $V, U = P_n$ -- множество многочленов степени $\leq n, A = \frac{\df}{\df t}$ -- дифференциальный оператор
    \item $U = \Rset^n, V = \Rset^m, B$ -- матрица\\
    $\mcA u = B\cdot u$
\end{enumerate}
\textbf{Определение}\\
$L(U, V) = \nm{Hom}_K(U, V) = \nm{Hom}(U, V)$ -- множество всех линейных отображений $U \rto V$\\
Определим операции\\
$\mcC = \mcA + \mcB \Leftrightarrow \mcC u=(\mcA+\mcB)u = \mcA u+\mcB u$\\
$\mcC = \lambda \mcA \Leftrightarrow \mcC u=(\lambda \mcA)u = \lambda \mcA u$\\
$L(U,V)$ -- линейное пространство\\\\
\textbf{Определение}\\
$\im \mcA = \{ v = \mcA u: u\in U\}$ -- образ линейного отображения\\
\textbf{Замечание}\\
$\im \mcA \subset V$ -- линейное подпространство\\
Если $\im \mcA$ -- конечномерное, то $\dim \im \mcA =: \rg \mcA$\\
\textbf{Определение}\\
$\ker \mcA = \{u \in U: \mcA u=\0_V\}$ -- ядро линейного отображения (прообраз $\0_V)$\\
\textbf{Замечание}\\
$\ker \mcA \neq \varnothing$\\
$\0_U \in \ker \mcA$\\
$\ker \mcA \subset U$ -- линейное подпространство\\
Если $\ker \mcA$ конечномерно, то $\dim \ker \mcA = \Def \mcA$\\\
\textbf{Замечание 2}\\
Изоморфизм -- частный случай линейного отображения\\
$\mcA$ - изоморфизм $\LRto \left\{\begin{array}{l}
     \mcA \in L(U, V)\\
     \im \mcA = V\\
     \ker \mcA = \0_U\text{(тривиально)}
\end{array}\right.$\\
\textbf{Следствие}\\
 Если $U, V$ -- конечномерные\\
 $\mcA$ - изоморфизм $\LRto \left\{\begin{array}{l}
     \mcA \in L(U, V)\\
     \rg \mcA = \dim V\\
     \Def \mcA = 0
     \end{array}\right.$\\
\textbf{Определение}\\
$\mcA \in L(U, V)$
\begin{itemize}
    \item $\mcA$ сюръективное $\LRto \im \mcA = V$
    \item $\mcA$ инъективное $\LRto \ker \mcA = \{ \0_U \}$
    \item $\mcA$ биективно $\LRto$ сюръективно + инъективно $\LRto$ изоморфизм
    \item $\mcA$ эндоморфизм $\LRto$ линейный оператор $\LRto \mcA \in L(V, V) \LRto \mcA \in \nm{End}_K(V)$
    \item $\mcA$ автоморфизм $\LRto$ эндоморфизм + изоморфизм $\LRto \mcA \in \nm{Aut}_K(V)$
\end{itemize}
\textbf{Примеры}
\begin{enumerate}
    \item $\0 \in L(U, V)$
    \item $\epsilon \in \nm{Aut}(V)$ -- автоморфизм
    \item $\mcA=\frac{\df}{\df t}$\\
    $\mcA \in L(P_n, P_{n-1})$ -- сюръекция, не инъекция, не эндоморфизм\\
    $\mcA \in L(P_n, P_n)$ -- не сюръекция, не инъекция, эндоморфизм
    \item $U=\Rset^n, V=\Rset^m, A_{m \times n}$ -- матрица\\
    \textbf{Определение}\\
    $\im A = \{ y = Ax \in \Rset^m: x \in \Rset^n \}$ -- образ матрицы\\
    $\ker A = \{ x \in \Rset^n: Ax = \0 \}$ -- ядро матрицы\\
    $\Def A = \dim \ker A$ -- дефект матрицы\\
    $\rg A = \dim \im A$ -- согласуется со старыми определениями ранга матрицы\\
    \textbf{Доказательство}\\
    Для $y \in \im A$\\
    $y = Ax = x_1 A_1 + \ldots + x_n A_n$\\
    $\im A = \span(A_1, \ldots, A_n)$\\
    $\dim \im A = \rg A$\\
    \textbf{Утверждение}\\
    $\ker A$ - множество решений $Ax = 0$\\
    Тогда $\Def A = \dim \ker(A) = n - \rg A $\\\\
    Отображение $u = Av$:
    \begin{enumerate}
        \item Сюръекция $\LRto \rg A = m$
        \item Инъекция $\LRto \rg A = n$
        \item Биекция $\LRto n = m = \rg A$
        \item Эндоморфизм $\LRto n = m$
        \item Автоморфизм $n = m = \rg A$
    \end{enumerate}
\end{enumerate}
\textbf{Определение}\\
$\mcA\mcB = \mcA \circ \mcB$ -- композиция\\
$\mcA \circ \mcB$ -- линейное отображение\\
\textbf{Свойства}
\begin{enumerate}
    \item $(\mcA_1 + \mcA_2)\mcB = \mcA_1\mcB + \mcA_2\mcB$\\
    $\mcA(\mcB_1 + \mcB_2) = \mcA\mcB_1 + \mcA\mcB_2$ -- дистрибутивность
    \item $(\lambda \mcA)\mcB = \lambda (\mcA \mcB) = \mcA (\lambda \mcB)$ -- однородность
    \item $(\mcA \mcB) \mcC = \mcA(\mcB\mcC) = \mcA\mcB\mcC$ -- ассоциативность
    \item $\mcA, \mcB$ -- изоморфизм $\Rto \mcA\mcB$ -- изоморфизм
\end{enumerate}
\textbf{Определение}\\
Пусть $\mcA \in L(U, V)$ -- изоморфизм\\
$\fall v \in V\ \ex! u:\ \mcA u = v$\\
Тогда зададим $\mcA^{-1} v = u$\\
$\mcA^{-1}: V \rto U$\\
$\mcA^{-1}$ -- изоморфизм, обратный к $\mcA$\\
$\mcA\mcA^{-1} = \epsilon_V$\\
$\mcA^{-1}\mcA = \epsilon_U$\\
\textbf{Замечание}\\
$\nm{End}(V)$ - ассициативная унитарная алгебра\\
$\nm{Aut}(V)$ - ассоциативная унитарная алгебра с делением\\
\textbf{Определение}\\
$\mcA \in L(U, V), U_0 \subset U$ -- линейное подпространство\\
Тогда $\mcA_0 : U_0 \rto V$ называется сужением на линейное подпространство $U_0$, если $\fall u \in U_0\ \mcA_0u = \mcA u$\\
Очевидно $\mcA_0 \in L(U_0, V)$\\
$A_0 =: A|_{U_0}$\\
\textbf{Утверждение}\\
$A$ изоморфизм $\Rto A_0 $ изоморфизм $\in L(U_0, \im \mcA_0)$\\
\textbf{Доказательство}\\
$\mcA_0: U_0 \rto \im \mcA_0$ -- сюръекция\\
$\ker \mcA_0 \subset \ker \mcA = \{ \0_U \}$ -- из изоморфизма\\
Отсюда $\ker \mcA_0 = \{ \0_U\}$\\
Тогда $\mcA_0$ инъекция, а значит изоморфизм\\
\textbf{Теорема о ранге и дефекте линейного отображения}\\
$U, V$ -- конечномерные\\
$A \in L(U, V)$\\
Тогда $\dim U = \rg A + \Def A$\\
\textbf{Доказательство}\\
$U_0 = \ker A \subset U$\\
Дополним $U_0$ до $U$:
$U = U_0 \oplus U_1$\\
Пусть $\mcA_1 = \mcA|_{U_1}: U_1 \rto \im \mcA_1$\\
$\fall u \in U\ u=u_0 + u_1, u_0 \in U_0, u_1 \in U_1$ -- единственным образом\\ 
$\mcA u = \mcA u_0 + \mcA u_1 = \mcA u_1$\\
Отсюда $\im \mcA = \im \mcA_1 \Rto \dim \im \mcA = \dim \im \mcA_1 \Rto \rg \mcA = \dim \im \mcA_1$\\
Покажем, что $\mcA_1$ изоморфизм:\\
Сюръекция, т.к. действует в $\im \mcA_1$\\
$\ker \mcA_1 \subset \ker \mcA = U_0, \ker \mcA_1 \subset U_1$\\
Отсюда $\ker \mcA_1 \subset U_0 \cap U_1 = \{ \0_U\}$ из дизъюнктности\\
Тогда $\ker \mcA_1 = \{ \0_U \}$ -- тривиально\\
Тогда $\mcA_1$ инъективно\\
Отсюда $\mcA_1$ изоморфизм, т.е. $\dim U_1 = \dim \im \mcA_1 = \rg \mcA$\\
Тогда $\dim U = \dim U_0 + \dim U_1 = \Def A + \rg A$, ч.т.д.
\subsection{Матрица линейного отображения, изоморфизм алгебр изменение матрицы отображения при замене базиса}
\underline{Далее будем говорить про конечномерные $U, V$}\\
\textbf{Определение}\\
$\mcA \in L(U, V)$\\
$\xi_1, \ldots, \xi_n$ -- базис $U$\\
$\nu_1, \ldots, \nu_m$ -- базис $V$\\
$\fall u \in U\ u = \sum_{i = 1}^n u_i \xi_i \lrto u = \begin{pmatrix}
u_1\\u_2\\\vdots\\u_n
\end{pmatrix}$\\
$\fall v \in V\ v = \sum_{i = 1}^m v_i \nu_i \lrto v = \begin{pmatrix}
v_1\\v_2\\\vdots\\v_m
\end{pmatrix}$\\
$\fall v \in \im \mcA\ v = \mcA u = \sum_{i=1}^n u_i \mcA \xi_i$\\
$\mcA$, как линейное отображение, полностью определяется значениями $\mcA$ на базисных векторах\\
$\mcA_{\xi_i} = \sum_{j=1}^m a_{ji} \nu_j \lrto \begin{pmatrix}
    a_{1i}\\\vdots\\a_{mi}
\end{pmatrix}$\\
$A = (A_1 \ldots A_n)$ - матрица линейного отображения в базисах $(\xi, \nu)$\\\\
\underline{Если $\mcA \in \nm{End}(v)$ -- линейный оператор, то считаем, что исходный и конечный базис совпадают}\\
$v = \sum_{j=1}^m v_j \nu_j$\\
$v = \mcA u = \sum_{i = 1}^n u_i \mcA_{\xi_i} = \sum_{i=1}^n u_i\sum_{j=1}^m a_{ji}\nu_j = \sum_{j=1}^m(\sum_{i=1}^n a_{ji}u_i)\nu_j$\\
Т.к. координаты введены единственным образом, то $\fall j\ v_j = \sum_{i=1}^n a_{ji}u_i \LRto v = \mcA u \LRto v = Au$\\
\textbf{Примеры}
\begin{enumerate}
    \item $\epsilon: \underset{e_1\ldots e_n}V \rto \underset{e_1 \ldots e_n}V$\\
    Тогда $\epsilon \lrto E$
    \item $\epsilon: \underset{\xi_1\ldots \xi_n}V \rto \underset{\nu_1 \ldots \nu_n}V$\\
    Тогда $\epsilon \lrto T_{\nu \rto \xi} = T_{e\rto e'}$
\end{enumerate}
\textbf{Утверждение}\\
$L(U, V) \cong M_{m\times n}$ -- пространство всех матриц $A_{m\times n}, \dim U = n, \dim V = m$\\
(при фиксированных базисах $U, V$)\\
\textbf{Доказательство}\\
Соответствие между $\mcA$ и $A$ взаимооднозначное\\
Докажем линейность\\
$(\mcA+\lambda \mcB)_{\xi_i} = \mcA_{\xi_i}+\lambda\mcB_{\xi_i} = \sum_{j=1}^m a_{ji}\nu_j + \lambda \sum_{j=1}^m b_{ji}\nu_j = \sum_{j=1}^m(a_{ji} + \lambda b_{ji})\nu_j \lrto A+\lambda B$\\\\
\textbf{Утверждение}\\
$\mcA\mcB \lrto AB$\\
\textbf{Доказательство}\\
$\underset{\xi_1\ldots\xi_n}{U}\xrto[\mcB]{} \underset{\theta_1\ldots\theta_r}{W} \xrto[\mcA]{} \underset{\nu_1\ldots\nu_m}{V}$
$(\mcA\mcB)_{\xi_i} = \mcA(\mcB_{\xi_i}) = \mcA(\sum_{k=1}^r b_{ki}\theta_k) = \sum_{k=1}^r b_{ki}\mcA_{\theta_k} = \sum_{k=1}^rb_{ki}\sum_{j=1}^m a_{jk}\nu_j = \sum_{j=1}^m(\sum_{k=1}^r a_{jk}b_{ki})\nu_i = \sum_{j=1}^m AB_{ji} \nu_j \lrto \begin{pmatrix}
    \vdots
\end{pmatrix}$\\
\textbf{Утверждение}\\
Пусть $\mcA \in \nm{Aut}(V)$\\
(В одном базисе)\\
$\mcA^{-1} \lrto A^{-1}$\\
\textbf{Доказательство}\\
Пусть $\mcA^{-1} \lrto B$\\
$\mcA\mcA^{-1} = \epsilon \lrto AB = E$\\
Отсюда $B = A^{-1}$\\
\textbf{Утверждение}\\
$A$ изоморфно $\Rto A_0$ изоморфно\\
\textbf{Доказательство}\\
$A_0: U_0 \rto \im \mcA_0$ -- сюръекция\\
$\ker A_0 \subset \ker A = \{\0_U\}$\\
Отсюда $\ker A_0 = \{\0_U\}$\\
Отсюда $A_0$ - инъективно, а значит изоморфизм\\
\textbf{Теорема о связи матриц линейных отображений в разных базисах}\\
$\mcA \in L(U, V)$\\
$\mcA: \underset{\xi}{U} \rto \underset{\nu}{V} \lrto A$\\
$\mcA: \underset{\xi'}{U} \rto \underset{\nu'}{V} \lrto A'$\\
$T_{\xi \rto \xi'} T_{\nu \rto \nu'}$ -- матрицы перехода\\
Тогда $A' = T_{\nu' \rto \nu} A T_{\xi \rto \xi'}$\\
\textbf{Доказательство}\\
Пусть $\xi_U: \underset{\xi'}{U} \rto \underset{\xi}{U},\\
\xi_V: \underset{\nu}{V} \rto \underset{\nu'}{V}$\\
$\mcA = \xi_v \mcA \xi_u$\\
$A' = T_{\nu'\rto \nu}AT_{\xi \rto \xi'}$\\
\textbf{Следствие}\\
$\mcA \in \nm{End}(V)$\\
$\mcA: \underset{e}{V}\rto\underset{e}{V} \lrto A$\\
$\mcA: \underset{e'}{V}\rto\underset{e'}{V} \lrto A'$\\
$A'=T_{e'\rto e}AT_{e\rto e'}$\\
\textbf{Определение}\\
Матрицы $A_{n\times n},B_{n \times n}$ \textit{подобны}, если $\ex C$ невырожденная$: A=C^{-1}BC$\\
$A$ и $A'$ -- матрицы одного и того же оператора в разных базисах -- подобны\\
\textbf{Утверждение}\\
$\mcA \in L(U, V) \lrto A$\\
Тогда $\ker \mcA \lrto \ker A$\\
$\im \mcA \lrto \im A$\\
\textbf{Доказательство}\\
$\im \mcA = \span(\mcA_{\xi_1},\ldots, \mcA_{\xi_n}) \lrto \span(A_1, \ldots, A_n) = \im A$\\
$\ker \mcA = \{ u\in U: \mcA = 0\}$\\
$\mcA u = 0 \lrto Au = 0$\\
Тогда $\ker \mcA = \ker A$
\subsection{Инвариантность линейного отображения}
\textbf{Определение}\\
Инвариантностью/инвариантном называется свойство, которое не меняется при определенного рода преобразованиях\\
\textbf{Теорема 1}\\
$\mcA \in L(U, V)$\\
$\rg A$ и $\Def A$, где $A \lrto \mcA$, не зависят от выбора базиса, т.е. являются инвариантами относительно выбора базиса\\
\textbf{Доказательство}\\
$\mcA: \us\xi U \rto \us\nu V \lrto A$\\
$\im \mcA = \span(\mcA_{\xi_1},\ldots,\mcA_{\xi_n}) \lrto \span(A_1, \ldots, A_n), \mcA_{\xi_i} \lrto A_i$\\\\
$\rg \mcA = \dim \im \mcA = \dim \span(A_1, \ldots, A_n) = \rg A$\\
$\rg \mcA + \Def \mcA = n = \rg A + \Def A \Rto \Def \mcA = \Def A$\\
\textbf{Следствие}\\
$\mcA$ изоморфизм $\LRto \ex A^{-1}$, где $A \lrto \mcA$\\\\
\textbf{Определение}\\
$\mcA \in \nm{End}(V)$\\
$e_1,\ldots, e_n$ -- базис $V$\\
Тогда $\det \mcA := \det(\mcA e_1, \ldots, \mcA e_n)$ -- определитель системы векторов в базисе $e_1, \ldots, e_n$\\
\textbf{Теорема 2}\\
Значение $\det \mcA$ не зависит от выбора базиса $e_1, \ldots, e_n$ (т.е. является инвариантом), причем $\det \mcA = \det A$, где $A$ -- матрица оператора в некотором базисе\\
\textbf{Доказательство}\\
Выберем базис $e_1, \ldots, e_n$\\
Тогда $\mcA \us{e}\lrto A_{n\times n}$\\
$\det \mcA = \det (\mcA e_1, \ldots, \mcA e_n) = \det(\sum_{i_1=1}^n a_{i_11}e_{i_1}, \ldots, \sum_{i_n=1}^n a_{i_nn}e_{i_n}) =\\ \sum_{i_1=1}^n\ldots\sum_{i_n=1}^n a_{i_11}\ldots a_{i_nn}\det(e_{i_1}, \ldots, e_{i_n}) = \sum_{\sigma \in S_n}(-1)^{\nm{inv}(\sigma)}a_{i_11}\ldots a_{i_nn}\det(e_1,\ldots, e_n) = \sum_{\sigma \in S_n}(-1)^{\nm{inv}(\sigma)}a_{i_11}\ldots a_{i_nn} = \det A$\\
Т.о. в нашем базисе это верно\\
Теперь докажем, что в $e_1', \ldots e_n'$ -- базисе $V$ -- это тоже верно\\
$\mcA \us{e'}\lrto A'$\\
$\det \mcA = \det A'$\\
$T=T_{e\rto e'}$\\
$A' = T^{-1}AT$\\
Тогда $\det A' = \det(T^{-1}AT) = \det T^{-1}\det A\det T = \det A$\\
\textbf{Следствие}\\
$\fall f$ -- n-форма на $V$\\
$\fall \xi_1, \ldots, \xi_n \in V\ f(\mcA \xi_1, \ldots, \mcA \xi_n) = \det \mcA f(\xi_1, \ldots, \xi_n)$\\
\textbf{Доказательство}\\
$g(\xi_1, \ldots, \xi_n):=f(\mcA \xi_1, \ldots, \mcA \xi_n)$\\
$g$ -- n-форма, т.к. f -- n-форма\\
$g(\xi_1, \ldots, \xi_n) = g(e_1, \ldots, e_n)\det(\xi_1, \ldots, \xi_n)$\\
$g(\xi_1, \ldots, \xi_n)=f(\mcA \xi_1, \ldots, \mcA \xi_n) = \det A f(e_1, \ldots, e_n)$ (см. доказательство теоремы)\\
$g(\xi_1, \ldots, \xi_n) = g(e_1, \ldots, e_n)\det(\xi_1, \ldots, \xi_n) = \det \mcA f(e_1, \ldots, e_n)\det(\xi_1,\ldots,\xi_n) = \det \mcA f(\xi_1, \ldots, \xi_n)$\\
\textbf{Следствие 2}\\
$\mcA, \mcB \in \nm{End}(V) \Rto \det(\mcA\mcB) = \det\mcA\det\mcB$\\
\textbf{Следствие 3}\\
$\mcA \in \nm{Aut}(V) \lrto \det \mcA \neq 0$\\
Причем $\det \mcA^{-1} = \frac{1}{\det \mcA}$\\
$\det \mcA^{-1} = \det A^{-1}$\\
\textbf{Доказательство}\\
$\mcA \in \nm{Aut}(V) \LRto \ex \mcA^{-1} \in \nm{Aut}(V)$\\
$\mcA\mcA^{-1} = \epsilon$\\
$\det \mcA\mcA^{-1} = \det\mcA\det \mcA^{-1} = \det \epsilon = 1$\\\\
\textbf{Примеры}
\begin{enumerate}
    \item В $V_3$\\
    $f(a,b,c) = (a, b, c) =$ ориентированный объем $= \det(a,b,c)$\\
    $\mcA: V_3 \rto V_3$\\
    $(\mcA a, \mcA b, \mcA c) = \det \mcA \det (a,b,c)$\\
    $\lambda = \det \mcA$ -- коэффициент пропорциональности объемов
    \begin{enumerate}
        \item $\mcA v = \mu v$ -- оператор подобия\\
        Тогда $\lambda = \mu^3$
        \item Поворот\\
        Пусть $i,j,k$ перешли в $e_1, e_2, e_3$ поворотом\\
        Тогда $e_i = \begin{pmatrix}
            \cos \alpha_i\\
            \cos \beta_i\\
            \cos \gamma_i
        \end{pmatrix}$\\
        Тогда $\mcA \us{ijk}\lrto\begin{pmatrix}
            \cos \alpha_1 & \cos \alpha_2 & \cos \alpha_3\\
            \cos \beta_1 & \cos \beta_2 & \cos \beta_3\\
            \cos \gamma_1 & \cos \gamma_2 & \cos \gamma_3
        \end{pmatrix}$ -- матрица поворота\\
        $f(\mcA a, \mcA b, \mcA c) = \det A \det (a,b,c)$\\
        $\det A = (e_1, e_2, e_3) = 1$ -- смешанное произведение\\
        Отсюда при повороте объем сохраняется
    \end{enumerate}
\end{enumerate}
\textbf{Определение}\\
$A_{n\times n}$\\
$\tr A := \sum_{i=1}^n a_{ii}$ -- след матрицы\\
\textbf{Теорема 3}\\
Если матрицы подобные, то $\tr A = \tr B$\\
\textbf{Доказательство}\\
$A, B$ -- подобные $\Rto \ex$ невырожденная $C: A=C^{-1}BC=SBC$\\
$\tr A = \sum_{i=1}^na_{ii}=\sum_{i=1}^n\sum_{k=1}^n S_{ik}(BC)_{ki} = \sum_{i=1}^n\sum_{k=1}^n S_{ik}\sum_{m=1}^nB_{km}C_{ki} = \sum_{m=1}^n\sum_{k=1}^n B_{km}\sum_{i=1}^nC_{mi}S_{ik} = \sum_{m=1}^n\sum_{k=1}^n B_{km} E_{mk} = \sum_{k=1}^n B_{kk} = \tr B$\\
\textbf{Следствие}\\
$A$ и $A'$ матрицы $\mcA \in \nm{End}(V)$ в разных базисах\\
Тогда $\tr A = \tr A'$(из формулы перехода)\\
\textbf{Определение}\\
$\tr \mcA:=\tr A$, где $A$ -- матрица $\mcA$ в некотором базисе (не зависит от выбора базиса)\\\\
\textbf{Определение}\\
$L \subset V, \mcA \in \nm{End}(V)$\\
$L$ называется инвариантным относительно $\mcA$, если $\fall x\in L\ \mcA x \in L$\\
Если $L$ -- линейное подпространство, то говорим об инвариантном линейном подпространстве\\
\textbf{Примеры}
\begin{enumerate}
    \item $\0, V$
    \item $\ker \mcA, \im \mcA$
    \item $\mcA$ -- вращение пространства вокруг оси $l$ на фиксированный угол\\
    Тогда $l, L \perp l$ -- инвариантное пространство ($L$ -- плоскость)\\
    Линейные многообразия $P = x_0 + L$ -- линейные многообразия -- инвариантные пространства (хоть и не линейные пространства)
\end{enumerate}
\textbf{Теорема 4}\\
$L \subset V$ -- инвариантное линейное подпространство относительно $\mcA \in \nm{End}(V)$\\
Тогда $\ex$ базис $V$ такой, что матрица оператора будет иметь в нем ступенчатый вид $A = \begin{pmatrix}
    A^1 & A^2\\
    \0 & A^3
\end{pmatrix}$, где $A^1_{k\times k}, k = \dim L$\\
\textbf{Доказательство}\\
Пусть $L$ -- инвариантное линейное подпространство относительно $\mcA$\\
$\fall x\in L\ \mcA x \in L$\\
Пусть $e_1, \ldots, e_k$ -- базис $L$\\
Дополним его до базиса $V$:\\
$V = \span (e_1, \ldots, e_k, e_{k+1}, \ldots, e_n)$\\
$\mcA e_{j\in 1\ldots k} \in L \Rto \mcA e_j = \sum_{i=1}^k a_{ij}e_i \lrto A_j = \begin{pmatrix}
    a_{1j}\\
    \vdots\\
    a_{k_j}\\
    0\\
    \ldots\\
    0
\end{pmatrix}$\\
Отсюда Видим, что $A$ имеет ожидаемый вид\\
\textbf{Следствие 1}\\
$L_1, L_2 \subset V: L_1\oplus L_2 = V$ -- инвариантные линейные пространства относительно $\mcA \in \nm{End}(V)$\\
Тогда существует базис $V$ такой, что матрица оператора $\mcA$ имеет блочно-диагональный вид\\
$A = \begin{pmatrix}
    A^1 & \0\\
    \0 & A^2
\end{pmatrix}$, где $A^i_{\dim L_i\times \dim L_i}$\\
\textbf{Доказательство}\\
Пусть $e_1, \ldots, e_k$ -- базис $L_1$\\
$e_{k+1}, \ldots, e_n$ -- базис $L_2$\\
Тогда $\mcA e_{j \in 1\ldots k} \in L_1 \lrto \begin{pmatrix}
    A^1_j\\\0
\end{pmatrix}$\\
Тогда $\mcA e_{j \in k+1\ldots n} \in L_2 \lrto \begin{pmatrix}
    \0\\A^2_{j-k}
\end{pmatrix}$\\
\textbf{Следствие 2}\\
$V = \bigoplus_{i=1}^m L_i$\\
$L_i \subset V$ -- инвариантные линейные пространства относительно $\mcA \in \nm{End}(V)$\\
Тогда существует базис $V$ такой, что матрица оператора $\mcA$ имеет блочно-диагональный вид(аналогично предыдущему следствию)\\
Пусть $A|_{L_j}: L_j \rto L_j$ (эндоморфизм)\\
Тогда $\mcA|_{L_j} \lrto A_i$\\
\textbf{Следствие 3}\\
$V = \bigoplus_{i=1}^m L_i$\\
$L_i \subset V$ -- инвариантные линейные пространства относительно $\mcA \in \nm{End}(V)$\\
Тогда $\im \mcA = \bigoplus_{i=1}^m \im (A|_{L_j})$\\
\textbf{Доказательство}\\
$V = \bigoplus_{i=1}^m L_i$\\
$\fall x\in V\ \ex! x_1 \in L_1,\ldots,x_m \in L_m:\ x=\sum_{i=1}^m x_i$\\
$\mcA x = \sum_{i=1}^m \mcA x_i$\\
$\mcA x_i \in \im \mcA_i$\\
Отсюда $\im \mcA = \sum_{i=1}^m \im \mcA_i$\\
Докажем дизъюнктность\\
Пусть $y_i \in \im \mcA_i$\\
Тогда $\ex x_i \in L_i: y_i = \mcA x_i = \mcA_i x_i$\\
$y_1+\ldots+y_m = \0 \LRto \mcA x_1 + \ldots + \mcA x_m = \0$\\
$\mcA x_i \in L_i$, т.к. $L_i$ -- инвариант\\
Т.к. $L_1\ldots L_m$ -- дизъюнктны, то $\mcA x_i = \0$\\
Отсюда $y_i = \0$\\
Отсюда $\im \mcA_i$ дизъюнктны
\subsection{Собственные числа и собственные векторы линейного оператора. Характеристический многочлен. Алгеброическое и геометрическое кратности собственного числа}
$V$ -- линейное пространство над полем $K(\Rset, \Cset)$\\
\textbf{Определение}\\
$\lambda \in K$ -- \textit{собственное число} $\mcA \in \nm{End}(V)$, если $\ex v \neq \0 \in V: \mcA v = \lambda v$\\
$v$ -- собственный вектор $\mcA$, отвечающий собственному числу $\lambda$\\\\
Отсюда  $v$ -- СВ $\LRto$ $(\mcA - \lambda \epsilon)v = \0$\\
$V_\lambda = \ker (\mcA - \lambda\epsilon) = $ (множество всех СВ $\mcA$, отвечающих $\lambda$) $ \cup \{\0\}$ -- собственное подпространство $\mcA$, отвечающее $\lambda$\\
$\gamma(\lambda) := \dim V_\lambda$ -- геометрическая кратность числа $\lambda$\\
$V_\lambda, \gamma_\lambda$ -- инвариантны относительно оператора $\mcA$ и выбора базиса\\
\textbf{Примеры}
\begin{enumerate}
    \item Оператор подобия:\\
    $\fall v\in V\ \mcA v:= \lambda v$\\
    У него $\lambda$ -- собственное число, $V = V_x$\\
    $\mcA \us{e}\lrto \lambda E$
    \item $\mcA$ -- поворот на плоскости относительно начала координат на угол $\alpha \in (-\frac\pi2, \frac\pi2)$
    \item $\lambda = 0$ -- собственное число $\mcA$\\
    $\LRto \ker \mcA \neq \{\0\}$\\
    $\LRto \mcA$ -- не изоморфизм\\
    $\LRto \det \mcA = \0$
    \item $v_1,\ldots,v_n$ -- базис $V$, где $v_j$ -- СВ $\mcA$ для стационарного числа $\lambda_j$\\
\end{enumerate}
Научимся находить СЧ и СВ\\
$\chi_\mcA(t) = \det (A-tE) = (-1)^nt^n+(-1)^{n-1}t^{n-1}\tr A + \ldots + \det A$ -- характеристический могочлен $\mcA(A)$
$\lambda$ -- СЧ $\LRto \chi_\mcA(\lambda) = 0 \land \lambda \in K$\\
Из основной теоремы алгебры $\chi_\mcA(\lambda)$ имеет ровно $n$ корней с учетом кратности (некоторые из которых могут быть комплексными)\\
Если $\lambda_{i \in 1\ldots n}$ -- корни, то $\det A = \lambda_1\lambda_2\ldots\lambda_n$ (т.к. свободный член $\chi$)\\
Т.о. $\det A = 0 \lrto \ex \lambda_i = 0$\\
Также из теоремы Виета $\tr A = \lambda_1 + \ldots + \lambda_n$\\\\
$\chi_\mcA(t) = (-1)^n \prod_\text{$\lambda$ -- корень} (t - \lambda)^{\alpha(\lambda)}$, где $\alpha(\lambda)$ -- алгебраическая кратность СЧ $\lambda$ (кратность корня)\\\\
Рассмотрим пример с поворотом в $\Rset^2$ на $\alpha \in (-\pi, \pi)$\\
Найдем характеристический многочлен:\\
$\chi_\mcA(t) = (\cos \alpha - t)^2 + \sin^2 \alpha = \cos^2 \alpha - 2t\cos \alpha + t^2  + \sin^2 \alpha = t^2 - 2t \cos \alpha + 1$\\
Очевидно, что у данного многочлена нет вещественных корней, а значит нет СЧ и СВ\\
$\det A = 1, \tr A = 2\cos \alpha$\\\\
\textbf{Теорема 1}\\
$\fall \mcA \in \nm{End}(V), \lambda$ -- СЧ $1 \leq \gamma(\lambda) \leq \alpha(\lambda)$\\
\textbf{Доказательство}\\
$1 \leq \gamma(\lambda)$ очевидно, т.к. $\gamma(\lambda) = \dim V_\lambda = \gamma$\\
Пусть $v_1,\ldots,v_\gamma$ -- базис $V_\lambda$\\
$V_\lambda$ -- инвариант относительно $\mcA$\\
Тогда существует базис $V_\lambda$ такой, что $A$ имеет ступенчатый вид $A = \begin{pmatrix}
    A^1 & A^3\\
    \0 & A^2
\end{pmatrix}$\\
Отсюда $\chi_\mcA(t) = \det(A-tE) = |A^1-tE||A^2-tE|=\chi_{A^1}(t)\chi_{A^2}(t)$\\
Пусть $v_1,\ldots,v_\gamma, e_{\gamma+1},\ldots,e_n$ -- наш базис\\
Т.к. $\mcA v_{j\in 1\ldots\gamma} = \lambda v_j$, то $A^1 = \lambda E_{\gamma\times \gamma}$\\
$\chi_{A_1}(t) = (\lambda - t)^\gamma$\\
$\chi_A(t) = (\lambda - t)^\gamma\chi_{A_2}(t) \Rto \alpha(\lambda) \geq \gamma$, т.к. возможо $\lambda$ -- корень $\chi_{A_2}(t)$\\
\textbf{Определение}\\
Набор СЧ $\mcA$ с учетом кратности является спектном оператора $\mcA$\\
Спектр называется простым, если все СЧ попарно различны, т.е. $\fall \lambda$ -- СЧ $\alpha(\lambda) = 1$\\
\textbf{Теорема 2}\\
$\lambda_1, \ldots, \lambda_m$ попарно различные СЧ $\mcA$\\
$v_1, \ldots, v_m$ -- соответствующие СВ\\
Тогда $v_1, \ldots, v_n$ -- линейно независимые\\
\textbf{Доказательство}\\
Методом математической индукции:
\begin{enumerate}
    \item $m = 1$ -- очевидно (т.к. $v_1 \neq \0)$
    \item Пусть верно для $m$\\
    Докажем для $m+1$ от противного\\
    Пусть $\lambda_{m+1} \neq \lambda_{j \in 1\ldots m}, v_{m+1}$ -- соответсвует $\lambda_{m+1}$\\
    Пусть $v_1,\ldots,v_{m+1}$ линейно зависимые\\
    Тогда $v_{m+1} = \sum_{i=1}^m \alpha_i v_i$\\
    //todo
\end{enumerate}
\textbf{Следствие 1}\\
$\lambda_1, \ldots, \lambda_m$ попарно различные СЧ $\mcA$\\
Тогда $V_{\lambda_1}, \ldots, V_{\lambda_m}$ -- дизъюнктные\\
\textbf{Доказательство}\\
$v_1 + \ldots + v_m = \0, v_i \in V_{\lambda_i}$\\
Пусть $v_i \neq \0$. Тогда $v_i$ - СВ для $\lambda_i$ (т.к. $v_i \in V_{\lambda_i}$)\\
Тогда линейная комбинация СВ $=\0$, чего не может быть из теоремы\\
Тогда $v_i = \0$, откуда дизъюнктность\\
\textbf{Следствие 2}\\
Пусть $V = \bigoplus_{\lambda  \text{ -- СЧ}} V_\lambda$\\
$\mcA_\lambda = \mcA|_{V_\lambda} \in \nm{End}(V_\lambda)$\\
Тогда $\chi_\mcA(t) = \prod_{\lambda \text{ -- СЧ}}\chi_{\mcA_\lambda}(t)$\\
\textbf{Доказательство}\\
$V = \bigoplus_{\lambda \text{ -- СЧ}} V_\lambda$\\
$V_\lambda$ -- инвариант относительно $\mcA$\\
Тогда существует базис такой, что $A = \begin{pmatrix}
    A^{\lambda_1} & \ldots & \0\\
    \vdots & \ddots & \vdots\\
    \0 & \ldots & A^{\lambda_m}
\end{pmatrix}$\\
$A^{\lambda_k} \lrto \mcA_{\lambda_k}$\\
$A^{\lambda_k} = \lambda_k E$\\
Тогда $V = \span(\ldots, v_1^{\lambda_k}, \ldots, v_{\gamma(\lambda_k)}^{\lambda_k},\ldots)$, где $v_1^{\lambda_k}, \ldots, v_{\gamma(\lambda_k)}^{\lambda_k}$ -- базис $V_{\lambda_k}$\\
Тогда базис $V$ -- объединение базисов\\
Отсюда $\chi_A(t) = \det (A-tE) = \det (A^1-tE) \ldots \det (A^m-tE)$
\subsection{Операторы простой структуры(ОПС). Диагонализируемая матрица. Проекторы. Спектральное разложение ОПС. Функция от матрицы}
\textbf{Определение}\\
$\mcA \in \nm{End}(V)$ называется оператором простой структуры, если существует базис $V$ такой, что матрица оператора в этом базисе имеет диагональный вид\\
$\Lambda = \nm{diag}(\lambda_1, \ldots, \lambda_n)$\\
\textbf{Замечание}\\
$\mcA$ -- ОПС $\LRto$ в $V$ существует базис из СВ\\
\textbf{Теорема}\\
Если все корни $\chi_\mcA(t) \in K$, т.е. являются СЧ (т.е. $\sum_{\lambda \text{ -- СЧ}} \alpha(\lambda) = n = \deg \chi_\mcA(t)$)\\
$\mcA$ -- ОПС $\LRto \fall \lambda$ -- СЧ $\alpha(\lambda) = \gamma(\lambda)$\\
\textbf{Доказательство}\\
$\gamma(\lambda) \leq \alpha(\lambda)$\\
$\mcA$ -- ОПС $\LRto \ex$ базис из СВ $\LRto М = \bigoplus_{\lambda \text{ -- СЧ}} V_{\lambda} \LRto n = \sum_{\lambda \text{ -- СЧ}} \gamma(\lambda)$\\
Отсюда $n = \sum_{\lambda \text{ -- СЧ}} \alpha(\lambda), \alpha = \gamma$\\
\textbf{Следствие}\\
Если $\lambda_1, \ldots, \lambda_n$ попарно различные СЧ $\mcA$, то $\mcA$ - ОПС\\
\textbf{Определение}\\
Матрица называется \textit{диагонализируемой}, если она подобна диагональной\\
$\ex T$ невырожденная $: T^{-1}AT = \nm{diag}(\lambda_1, \ldots, \lambda_n), \lambda_i$ -- СВ\\
\textbf{Теорема о приведении матрицы к диагональному виду}\\
Матрица $A$ диагонализируема $\LRto$ $A$ -- матрица ОПС $\mcA$ в некотором базисе\\
Причем $T=T_{e\rto v}$, где $e_1,\ldots,e_n$ -- базис, в котором была записана $A, v_1, \ldots, v_n$ -- базис из СВ $\mcA$, соответствующих $\lambda_1, \ldots, \lambda_n$\\
\textbf{Доказательство $\Lto$}\\
$\mcA$ -- ОПС\\
$e_1, \ldots, e_n$ -- базис $V$
$v_1, \ldots, v_n$ -- СВ, соответствующие $\lambda_1, \ldots, \lambda_n$ -- СЧ, базис $V$\\
$\mcA \us e\lrto A$
$\mcA \us v\lrto A'=\nm{diag}(\lambda_1, \ldots, \lambda_n)$\\
$T = T_{e\rto v}$\\
$A' = T^{-1}AT$\\
Отсюда $A$ подобна диагональной\\
\textbf{Доказательство $\Rto$}\\
//todo\\
\textbf{Определение}\\
Пусть $V = \bigoplus_{i=1}^m L_i, L_i$ -- линейное подпространство\\
Тогда $\fall v\in V \ex! v_1, \ldots v_m: v_i \in L_i, v=\sum_{i=1}^m v_i$\\
Зададим $\rho_i \in \nm{End}(V): \rho_i v = v_i \in L_i$\\
$\rho_i$ -- \textit{оператор проектирования(проектор)} на $L_i$\\
Свойства:
\begin{enumerate}
    \item $\fall i \neq j\ \rho_i \rho_j = \0$
    \item $\sum_{i=1}^m \rho_i = \epsilon$
    \item $\rho_i^k = \rho_i, k \in \Nset$ -- идемпотентность
    \item $\im \rho_i = L_i$\\
    $\ker \rho_i = \sum_{j \neq i} L_j$
\end{enumerate}
\textbf{Утверждение}\\
Пусть $\rho_1, \ldots, \rho_m \in \nm{End}(V)$, удовлетворяющие свойствам 1 и 2\\
Тогда $V = \bigoplus_{i=1}^m \im \rho_i$ (т.е. $\rho$ -- проектор на $L_i = \im \rho_i$)\\
\textbf{Доказательство}\\
Докажем $1, 2 \Rto 3$\\
$\rho_i = \rho_i \epsilon = \rho_i \sum_{i=1}^m \rho_j = \rho_i^2$\\
Докажем, что $V = \bigoplus_{i=1}^m \im \rho_i$\\
$\fall v \in V\ v = \epsilon v = \sum_{i=1}^m \rho_i v \Rto V = \sum_{i=1}^m \im \rho_i$\\
Докажем дизъюнктность\\
$\0 = v_1 (\in \im \rho_1) + \ldots + v_m (\in \im \rho_m)$\\
$\fall i = 1\ldots m\ v_i = \rho_i \omega_i (\ex \omega_i \in V)$\\
$v_i = \rho_i \omega_i = $ из свойства 3 $ = \rho_i (\sum_{j=1}^m \rho_j \omega_j) = \rho_i (\sum_{j=1}^m v_j) = \rho_i \0 = \0$, ч.т.д.\\
\textbf{Теорема о спектральном разложении о.п.с.}\\
$\fall \mcA \in \nm{End}(V)$ -- о.п.с.\\
Тогда $\mcA = \sum_{\lambda \text{ -- С.Ч.}} \lambda \rho_\lambda$, где $\rho_\lambda$ -- проектор на $V_\lambda$\\
\textbf{Доказательство}\\
Обозначение: Пусть все $\lambda$ -- С.Ч.
$\mcA$ -- о.п.с $\LRto V = \bigoplus_{\lambda} V_\lambda$\\
$v = \sum_{\lambda} v_\lambda, v_\lambda \in V_\lambda$\\
$\fall v\in V\ \mcA v = \mcA(\sum_\lambda v_\lambda) = \sum_\lambda (\mcA v) = \sum_\lambda \lambda v_\lambda = \sum_\lambda \lambda\rho_\lambda(v) = (\sum_\lambda \lambda\rho_\lambda) v$\\
Отсюда $\mcA = \sum_\lambda \lambda \rho_\lambda$ -- \textit{спектральное разложение}\\
\textbf{Следствие}\\
$A$ -- диагонализируема $\Rto\ex \rho_\lambda, \lambda$ -- С.Ч. $A: A = \sum_\lambda \lambda \rho_\lambda$\\
\textbf{Определение}\\
$(A_m)_{m=1}^\infty$ -- последовательность матриц $A_{n\times n} = (a_{ij}^m)_{n\times n}, m$ -- индекс, а не степень\\
$\lim_{m \rto \infty} A_m = A = (a_{ij})_{n\times n} \LRto \fall i,j = 1\ldots n\ a_{ij}=\lim_{m\rto \infty} a_{ij}^m$\\
\textbf{Немного про ряды}\\
$\sum_{m=1}^\infty a_m$ -- числовой ряд ($a_m \in \Rset(\Cset)$)\\
$S_m = \sum_{i=1}^m a_k$ -- частичная сумма ряда\\
Если $S_m$ сходится, то ряд называется сходящимся\\
\textbf{Определение}\\
$\sum_{m=1}^\infty A_m$ -- ряд из матриц\\
$\sum_{m=1}^\infty A_m$ -- сходится $\LRto \fall i,j = 1\ldots n\ \sum_{m=1}^\infty a_{ij}^m$ -- сходится\\
\textbf{Далее про ряды}\\
$\sum_{n=1}^\infty u_n(x), u_n: \Rset \rto \Rset$ -- функциональный ряд\\
При фиксированном $x$ -- числовой ряд\\
Множество $x$ таких, что числовой ряд сходится -- множество поточечной сходимости ряда $= E$\\
$\sum_{m=1}^\infty C_m (x-x_0)^m$ -- степенные ряды\\
Утверждается, что ряд сходится при $|x-x_0| < R$, где $R$ -- радиус сходимости\\
В $\Cset$ -- круг сходимости\\
В $\Rset$ -- интервал сходимости\\
Для $\Rset:\ \frac1R = \overline{\lim_{m\rto \infty}} \sqrt[m]{|C_m|}$\\
Примеры сходящихся рядов -- ряды Тейлора-Маклорена\\
$e^x = \sum_{m=1}^\infty \frac{x^m}{m!}$, сходится при $|x-x_0| \leq \infty$\\
$\sin x = \sum_{m=0}^\infty \frac{(-1)^m x^{2m+1}}{(2m+1)!}$, сходится при $|x| \leq \infty$\\
На окружности (при $|x-x_0| = R$) ряд может как сходиться, так и расходиться\\
\textbf{Определение}\\
Пусть $f(x) = \sum_{m=0}^\infty C_m x^m, |x| \leq R$\\
Тогда $f(A):= \sum_{m=0}^\infty C_m A^m$ (если ряд сходится)\\
\textbf{Теорема 1 (первый способ вычисления $f(A)$ для диагонализируемой матрицы)}\\
Пусть $A_{n\times n}$ диагонализируема\\
$f(x) = \sum_{m=1}^\infty C_m x^m, |x| \leq R$\\
Тогда если $\fall \lambda$ -- СЧ $|\lambda| < R$, то ряд $\sum_{m=1}^\infty C_m A^m$ сходится\\
$f(A) = T\nm{diag}(f(\lambda_1), \ldots, f(\lambda_n))T^{-1}$, где $\Lambda = T^{-1}AT = \nm{diag}(\lambda_1, \ldots, \lambda_n)$\\
\textbf{Доказательство}\\
$A_{n\times n}$ диагонализируема, а значит $\ex T: \Lambda = T^{-1}AT = \nm{diag}(\lambda_1, \ldots, \lambda_n)$\\
$S_m = \sum_{k = 0}^m C_k A^k, R = \infty$\\
$A^k = (T \Lambda T^{-1})^k = T \Lambda^k T^{-1} = T\nm{diag}(\lambda_1^k, \ldots, \lambda_n^k)T^{-1}$\\
Отсюда $S_m = T\nm{diag}(\sum_{k=0}^m C_k\lambda_1^k, \ldots, \sum_{k=0}^m C_k\lambda_n^k)T^{-1}$ (т.к. $R = \infty$, то все ряды сойдутся)\\
$S = \lim_{m\rto \infty} S_m = T\nm{diag}(f(\lambda_1), \ldots, f(\lambda_n))T^{-1}$\\
\textbf{Теорема 2 (второй способ вычисления $f(A)$ для диагонализируемой матрицы)}\\
Пусть $A_{n\times n}$ диагонализируема\\
$f(x) = \sum_{m=0}^\infty C_m x^m, |x| \leq R$\\
Тогда если $\fall \lambda$ -- СЧ $|\lambda| < R$, то ряд $\sum_{m=1}^\infty C_m A^m$ сходится\\
$f(A) = \sum_{\lambda \text{-- СЧ}} f(\lambda) \rho_\lambda$, где $A = \sum_{\lambda \text{ -- СЧ}} \lambda\rho_\lambda$ -- спектральное разложение\\
\textbf{Доказательство}\\
$A$ -- диагонализируема $\Rto A = \sum_{\lambda \text{ -- СЧ}} \lambda \rho_\lambda$\\
Тогда $A^k = (\sum_{\lambda \text{ -- СЧ}} \lambda \rho_\lambda)^k = \sum_{\lambda \text{ -- СЧ}} \lambda^k \rho_\lambda$\\
Отсюда $S_m = \sum_{k=0}^m C_k A^k = \sum_{k=0}^m C_k\sum_{\lambda \text{ -- СЧ}} \lambda^k \rho_\lambda =  \sum_{\lambda \text{ -- СЧ}} (\sum_{k=0}^mC_k\lambda^k) \rho_\lambda \xrto[m \rto \infty]{} \sum_{\lambda \text{ -- СЧ}} f(\lambda) \rho_\lambda$\\
\textbf{Следствие}\\
$A$ -- диагонализируема, $f(x) = \sum_{m=0}^\infty C_m x^m, |x| < R$\\
$\fall \lambda$ -- СЧ $|\lambda| < R$\\
$t \in \Rset(\Cset): \fall \lambda$ -- СЧ $|t\lambda| < R$\\
Тогда $f(At) = T\nm{diag}(f(\lambda_1 t), \ldots, f(\lambda_nt))T^{-1}$\\
или $f(At) = \sum_{\lambda \text{-- СЧ}} f(\lambda t) \rho_\lambda$\\
\textbf{Пример}\\
$\exp At = e^{At} = \sum_\lambda e^{t\lambda}\rho_\lambda = T \nm{diag}(e^{\lambda_1t}, \ldots, e^{\lambda_nt})T^{-1}$\\
\textbf{Свойства}
\begin{enumerate}
    \item $e^{A(t_1 + t_2)} = e^{At_1}e^{At_2}$
    \item $e^{A0} = E$
    \item $(e^{At})'=Ae^{At} = e^{At}A$\\
    \textbf{Доказательство}\\
    $(e^{At})' = (\sum_\lambda f(\lambda t)\rho_\lambda)'=\sum_\lambda \lambda e^{\lambda t}\rho_\lambda = (\sum_{\lambda} \lambda \rho_\lambda)(\sum_{\lambda} e^{t\lambda} \rho_\lambda) = Ae^{At} = e^{At}A$
\end{enumerate}
\textbf{Поиск обратной матрицы}\\
Пусть $A$ диагонализируема\\
$\fall \lambda\ \lambda \neq 0 \LRto \ex A^{-1}$\\
$A^{-1} = T\nm{diag}(\frac1{\lambda_1}, \ldots, \frac1{\lambda_n})T^{-1}$\\
$A^{-1} = \sum_\lambda \frac1\lambda \rho_\lambda$\\
\textbf{Определение}\\
$\sqrt[m]A$ -- арифметический корень\\
Если $\fall \lambda\ \lambda \geq 0$, то результат определен однозначно\\
$A^{-1} = T\nm{diag}(\sqrt[m]{\lambda_1}, \ldots, \sqrt[m]{\lambda_n})T^{-1}$\\
\subsection{Комплексификация вещественного линейного пространства. Продолжение вещественного линейного оператора}
$V$ -- линейное пространство над полем $K = \Rset (\Cset)$\\
Рассмотрим все ситуации
\begin{enumerate}
    \item Все корни $\chi_\mcA(t) \in K$\\
    Т.е. все корни являются С.Ч. $\mcA$\\
    $\fall \lambda\ \alpha(\lambda) = \gamma(\lambda)$, т.е. $\mcA$ -- о.п.с. (тогда матрица диагонализируема)
    \item Все корни $\chi_\mcA(t) \in K$\\
    Т.е. все корни являются С.Ч. $\mcA$\\
    $\ex \lambda: \gamma(\lambda) < \alpha(\lambda)$, т.е. $\mcA$ -- не о.п.с. (тогда матрица приводится к жордановой форме)
    \item При $K = \Rset$ не все корни $\chi_\mcA(t) \in \Rset$\\
    Тогда применяется комплексификация пространства
\end{enumerate}
Займемся комплексификацией\\
\textbf{Определение}\\
$V$ -- вещественное линейное пространство над $\Rset$\\
$\fall x,y \in V (x,y) \sim z:= x+iy$\\
$V_\Cset = \{ z = x+iy: x,y \in V \}$\\
$x+iy = x'+iy' \LRto x=x' \land y=y'$ в $V$\\
$\0 = \0 + i\0$ -- нулевой в $V_\Cset$\\
$\fall x \in V\ V_\Cset \ni x+\0i = x$\\
$z_1 + z_2 := (x_1+x_2)+i(y_1+y_2)$\\
$\fall \lambda = \alpha + i\beta\ \lambda z = (\alpha x - \beta y) + i (\alpha y + \beta x)$\\
\textbf{Утверждение}\\
$V_\Cset$ -- линейное пространство\\
\textbf{Теорема (о вещественном базисе $V_\Cset$)}\\
Пусть $\dim V = n, e_1, \ldots, e_n$ -- базис $V, e_j \in V(V_\Cset)$\\
Тогда $e_1, \ldots, e_n$ -- базис $V_\Cset (\dim V = \dim V_\Cset)$\\
\textbf{Доказательство}\\
$\fall z \in V_\Cset: z = x+iy, x,y \in V$\\
$x = \sum_{j=1}^n x_je^j$\\
$y = \sum_{j=1}^n y_je^j$\\
Отсюда $z = \sum_{j=1}^n(x_j + iy_j) e_j$, т.е. $e_1, \ldots, e_n$ -- порождающая\\
//todo
Отсюда $e_1, \ldots, e_n$ -- линейно независимые\\
\textbf{Определение}\\
$z=x+iy$\\
Тогда $\overline z = x-iy$ -- сопряженный вектор\\
\textbf{Утверждение}\\
$z_1, \ldots, z_m$ -- линейно независимые в $V_\Cset \LRto \ol z_1, \ldots, \ol z_m$ -- линейно независимые\\
($\Rto \rg (z_1, \ldots, z_m) = \rg (\ol z_1, \ldots, \ol z_m)$)\\
\textbf{Доказательство}\\
$c_1 \ol z_1 + \ldots c_m \ol z_m = \0$\\
$\ol{c_1 \ol z_1 + \ldots c_m \ol z_m} = \ol \0 = \0 = \ol c_1 z_1 + \ldots + \ol c_m z_m$ -- линейно независимые\\
Отсюда $\ol c_i = 0 \LRto c_i = 0$\\
\textbf{Определение}\\
$\mcA \in \nm{End}(V)$\\
Продолжением $\mcA$ на $V_\Cset$ называется $\mcA_\Cset \in \nm{End}(V_\Cset)$ такой, что\\
$\fall z=x+iy\in V_\Cset\ \mcA_\Cset z = \mcA x + i\mcA y \in V_\Cset$\\
\textbf{Свойства}
\begin{enumerate}
    \item $e_1, \ldots, e_n$ -- базис $V$\\
    $\mcA \us{e}\lrto A = (a_{ij})_{n\times n}, a_{ij} \in \Rset$\\
    Тогда $\mcA_\Cset \us e\lrto A_\Cset = A = (a_{ij})_{n\times n}$\\
    \textbf{Доказательство}\\
    $\mcA_\Cset e_j = \ldots = \mcA e_j = \sum_{k=1}^n a_{kj}e_k$\\
    Отсюда $A_\Cset = A$
    \item $\chi_\mcA(t) = \chi_{\mcA_\Cset}(t)$ (т.к. матрицы равны)
    \item $\fall z \in V_\Cset\ \ol{\mcA_\Cset z} = \mcA_\Cset(\ol z)$
    \item $\alpha\pm  i\beta$ -- пара сопряженных корней $\chi_\mcA(t)$ -- СЧ для $\mcA_\Cset$\\
    Тогда $z$ -- СВ, отвечающий СЧ $\alpha + i \beta \LRto \ol z$ -- СВ, отвечающий СЧ $\alpha - i \beta$\\
    \textbf{Доказательство}\\
    $\mcA_\Cset \ol z = \ol{\mcA_\Cset z} = \ol {(\alpha+i\beta)z} = (\alpha - i\beta)\ol{z}$
\end{enumerate}
Тогда:\\
Т.о. если $\chi_\mcA(t)$ имеет комплексные корни, то после комплексификации будет реализовываться случай 1 или 2
\subsection{Минимальный многочлен линейного оператора. Теорема Кэли-Гамильтона}
\textbf{Определение}\\
$\mcA \in \nm{End}(V)$\\
\textit{Нормализованный многочлен} -- многочлен, старший коэффициент которого 1\\
Нормализованный многочлен $\psi(t)$ называется \textit{аннулятором} элемента $x \in V$, если $\psi(\mcA)x = \0$\\
$\psi(t) = t^m + a_{m-1}t^{m-1} + \ldots + a_0 = \prod_{\lambda \text{ -- корень многочлена}} (t-\lambda)^{m(\lambda)}$, где $m(\lambda)$ -- кратность корня\\
$\psi(\mcA) = \mcA^m + a_{m-1} \mcA^{m-1} + \ldots + a_0\epsilon = \prod_{\lambda \text{ -- корень}} (A-\lambda\epsilon)^{m(\lambda)}$\\
\textbf{Определение}\\
Минимальный аннулятор $x$ -- аннулятор минимальной степени\\
\textbf{Теорема о минимальном аннуляторе элемента}\\
$\mcA \in \nm{End}(V)$
\begin{enumerate}
    \item $\fall x \in V\ \ex!$ минимальный аннулятор $x$
    \item Любой аннулятор $x$ делится на минимальный
\end{enumerate}
\textbf{Доказательство 1}\\
(алгоритм)
\begin{enumerate}
    \item $x = \0, \psi \equiv 1$\\
    $\epsilon = \psi(\mcA)$
    \item $x \neq \0$\\
    Пусть $x, \mcA x, \ldots, \mcA^{m-1}x$ -- линейно независимые и $m$ максимальное\\
    $\ex! \alpha_1, \ldots, \alpha_{m-1}: \mcA^m x = \sum_{i=0}^{m-1} \alpha_i \mcA^i x$\\
    $(\mcA^m - \sum_{i=0}^{m-1} \alpha_i \mcA^i) x = \0$\\
    $\psi(t) = t^m - \sum_{i=0}^{m-1} \alpha_i t^i$ -- минимальный и определен единственным образом
\end{enumerate}
\textbf{Доказательство 2}\\
Пусть $\psi'(t) = a(t)\psi(t)+r(t), \deg r < \deg \phi$ -- аннулятор\\
$\0 = \psi'(\mcA)x = a(\mcA)\ub\0{\psi(\mcA)x} + r(\mcA)x$\\
Отсюда $r(\mcA) = \0$\\
Но т.к. $\psi$ -- минимальный, то $r \equiv \0$\\
\textbf{Определение}\\
Нормализованный многочлен $\phi(t)$ называется аннулятором $\mcA$, если $\fall v \in V\ \phi(\mcA)v = \0$ (т.е. $\phi(\mcA) = \0$)\\
Аннулятор $\mcA$ минимальной степени -- \textit{минимальный многочлен}\\
\textbf{Теорема о минимальном многочлене}\\
$\mcA \in \nm{End}(V)$
\begin{enumerate}
    \item $\fall \mcA \ex!$ минимальный многочлен
    \item Любой аннулятор $\mcA$ делится на минимальный многочлен
\end{enumerate}
\textbf{Доказательство}\\
(алгоритм)
\begin{enumerate}
    \item $e_1, \ldots, e_n$ -- базис $V$\\
    По теореме 1 $\fall e_i \ex! \psi_i(t)$ -- минимальный аннулятор $e_i$\\
    $\phi(t) := \nm{lcm} (\psi_1, \ldots, \psi_n)$\\
    Тогда $\fall j \phi(t) = a_j(t)\psi_j(t)$\\
    Докажем, что $\phi(t)$ -- аннулятор\\
    $\fall v \in V \phi(\mcA)v = \phi(\mcA) \sum_{j=1}^m v_j e_j = \sum_{j=1}^m \phi(\mcA) v_j e_j = \sum_{j=1}^m a_j(t)\psi_j(t) v_j e_j = \0$\\
    Т.о. $\phi$ -- аннулятор
    \item Докажем, что любой другой аннулятор делится на $\phi$\\
    Пусть $\phi_1(t)$ -- аннулятор $\mcA$\\
    $\fall v \in V \phi_1(\mcA)v = \0 \Rto \fall j=1\ldots n\ \phi_1(\mcA)e_j=\0$ - тогда $\phi_1(\mcA)$ -- аннулятор $e_j$\\
    Т.к. $\psi_j(t)$ -- минимальный аннулятор $e_j$, то $\phi_1(t)$ делится на $\psi_i(t)$\\
    Отсюда $\phi_1(t)$ делится на $\nm{lcm}(\psi_1, \ldots, \psi_n) = \phi(t)$\\
    Отсюда $\deg \phi$ -- минимальная из возможных, а значит $\phi$ -- минимальный многочлен
    \item Докажем, что минимальный многочлен единственный\\
    Пусть $\phi_2(t)$ -- аннулятор $\mcA$ такой, что $\deg \phi = \deg \phi_2 = m$\\
    Тогда $\delta = \phi_2(t) - \phi(t) = a_{m-1}t^{m-1} + \ldots + a_0$ -- степень меньше $m$\\
    Но тогда $\delta$ -- аннулятор, $\deg \delta < m$ -- противоречие\\
    Отсюда $\phi_2 = \phi$\\
\end{enumerate}
\textbf{Теорема Кэли-Камильтона}\\
$\fall \mcA \in \nm{V}$\\
$\chi_\mcA$ -- аннулятор $\mcA$ (т.е. $\chi_\mcA(\mcA) \equiv 0$)\\
\textbf{Доказательство}\\
Пусть $\mcA \us{e_1, \ldots, e_n}\lrto A$\\
$\chi_\mcA(t) = \chi(t) = \det (\mcA - t\epsilon) = \det (A-tE)$\\
Пусть $\mu$ не корень $\chi$\\
Тогда $\det(A-\mu E) \neq 0$\\
$(A-\mu E)^{-1} = \frac1{\det(A - \mu E)}(b_{ij} := A_{ji})$\\
$b_{ij}$ - многочлен $n-1$ степени от $\mu$\\
Отсюда $(A-\mu E)^{-1} = \frac1{\det(A-\mu E)}(\mu^{n-1} B_{n-1} + \ldots + B_0)$, где $B_i$ -- матрица $n \times n$\\
Отсюда $\det (A-\mu E)E = (A-\mu E)(\mu^{n-1} B_{n-1} + \ldots + B_0) = -\mu^n B_{n-1} + \mu^{n-1}(AB_{n-1}-B_{n-2}) + \ldots + \mu (AB_1 - B_0) + AB_0$\\
$\det(A-\mu E)E = \chi(\mu) E = \sum_{k=0}^n \alpha_k \mu^k E$\\
$\sum_{k=0}^n \alpha_k \mu^k E = -\mu^n B_{n-1} + \mu^{n-1}(AB_{n-1}-B_{n-2}) + \ldots + \mu (AB_1 - B_0) + AB_0$\\
Отсюда $\alpha_0 E = AB_0$\\
$\alpha_1 E = AB_1 - B_0$\\
$\vdots$\\
$\alpha_{n-1} E = AB_{n-1} - B_{n-2}$\\
$\alpha_n E = -B_{n-1}$\\
$\chi (A) = \sum_{k=0}^n \alpha_k A^k = AB_0 + A(AB_1 - B_0) + A^2 (AB_2 - B_1) + \ldots + A^{n-1} (AB_{n-1}-B_{n-2}) = \0$\\
\textbf{Следствие}\\
$\fall \mcA \in \nm{End}(V)\ \chi_\mcA$ делится на $\phi_\mcA$\\
\textbf{Следствие 2}\\
$\deg \phi_\mcA = n = \dim V \Rto \phi_\mcA \equiv (-1)^n\chi_\mcA$\\
\textbf{Теорема (о корнях минимального многочлена)}\\
Множество корней характеристического многочлена и минимального многочлена совпадают (без учета кратности)\\
\textbf{Доказательство $\Rto$}\\
Пусть $\lambda$ -- корень $\chi(t)$
\begin{enumerate}
    \item Пусть $\lambda \in K \Rto \lambda$ -- С.Ч. $\mcA \Rto \ex v \neq 0: (\mcA - \lambda \epsilon)v = \0$\\
    Отсюда $\psi(t) = (t-\lambda)$ -- минимальный аннулятор элемента $v$\\
    Т.к. $\phi$ -- минимальный многочлен, то $\phi(\mcA) v = \0 \Rto \phi(\mcA)$ аннулятор $v$\\
    Тогда по теореме 1 $\phi$ делится на $\psi \Rto \lambda$ -- корень $\phi$
    \item Пусть $\lambda \not\in K$, т.е. $K = \Rset, \lambda \in \Cset$\\
    $V \rto V_\Cset$\\
    $\mcA \rto \mcA_\Cset$\\
    $e_1, \ldots, e_n$ -- базис $V \rto$ базис $V_\Cset$\\
    $\mcA \us{V, e}\lrto A \us{V_\Cset, v} \lrto \mcA_\Cset$\\
    $\chi_\mcA(t) = \chi_{\mcA_\Cset}(t) \Rto \lambda$ -- корень $\chi_{\mcA_\Cset} \Rto \lambda$ -- корень $\phi_{\mcA_\Cset}$\\
    Заметим, что из алгоритма построения минимального многочлена $\phi_\mcA = \phi_{\mcA_\Cset}$\\
    Отсюда $\lambda$ -- корень $\phi_{\mcA_\Cset}$
\end{enumerate}
\textbf{Доказательство $\Lto$}\\
Пусть $\lambda$ -- корень $\phi_\mcA(t)$\\
$\chi_\mcA$ делится на $\phi_\mcA(t) \Rto \lambda$ -- корень $\chi_\mcA(t)$\\
\textbf{Замечание}\\
Получаем второй способ получения С.Ч. $\mcA$\\
$m(\lambda) \leq \alpha(\lambda)$
\subsection{Операторное разложение единицы. Корневое подпространство}
$\phi(t) = \prod_\lambda (t-\lambda)^{m(\lambda)} = (t-\lambda)^{m(\lambda)} \prod_{\mu \neq \lambda} (t-\mu)^{m(\mu)} = (t-\lambda)^{m(\lambda)}\phi_\lambda(t), \phi_\lambda(t) := \prod_{\mu \neq \lambda} (t-\mu)^{m(\mu)}$\\
$\deg \phi = m = \sum_{\lambda} m(\lambda)$\\
\textbf{Определение}\\
$I_\lambda := \{ p \in P_{m-1}: p$ делится на $\phi_\lambda\}$ -- главный идеал, порождающий многочлен $\phi_\lambda$\\
$I_\lambda$ -- линейное подпространство $P_{m-1}$\\\\
$I_\lambda \ni p(t) = a_\lambda(t)\phi_\lambda(t)$\\
$m - 1 \geq \deg p = \deg a_\lambda + \deg \phi_\lambda = \deg a_\lambda + m - m_\lambda$\\
$\deg a_\lambda \leq m(\lambda) - 1$\\
$I_\lambda \cong P_{m(\lambda) - 1}$\\
$p \lrto a_\lambda$\\
$\dim I_\lambda = m(\lambda)$\\
\textbf{Теорема}\\
$P_{m-1} = \bigoplus_\lambda I_\lambda$\\
\textbf{Доказательство}
\begin{enumerate}
    \item Проверим, что $I_\lambda$ дизъюнктны\\
    $\0 = \sum_\lambda p_\lambda(t) = \sum_\lambda a_\lambda(t)\phi_\lambda(t) = \ub{\text{делится на $(t-\lambda)^{m(\lambda)}$}}{a_\lambda(t)\ub{\text{не делится на $(t-\lambda)^{m(\lambda)}$}}{\phi_\lambda(t)}} + \ub{\text{делится на $(t-\lambda)^{m(\lambda)}$}}{\sum_{\mu \neq \lambda} a_\mu(t)\phi_\mu(t)}$\\
    Отсюда $a_\lambda(t)$ делится на $(t-\lambda)^{m(\lambda)}$, но $\deg a_\lambda \leq m(\lambda) - 1$\\
    Тогда $a_\lambda(t) = 0 \LRto p_\lambda(t) \equiv 0 \Rto$ дизъюнктные\\
    \item $\bigoplus_\lambda I_\lambda \subset P_{m-1}, \dim P_{m-1} = m$\\
    $\dim \bigoplus_\lambda I_\lambda = \sum_\lambda m(\lambda) = m$\\
    Отсюда $P_{m-1} = \bigoplus_\lambda I_\lambda$
\end{enumerate}
\textbf{Следствие}\\
$\fall p \in P_{m-1} \ex ! (p_\lambda): p_i \in I_i, p=\sum_\lambda p_\lambda$\\
В частности, для $p\equiv 1\ \ex! (p_\lambda): p_i \in I_i, 1=\sum_\lambda p_\lambda$ -- полиноминальное разложение единицы (порожденное многочленом $\phi$)\\
$p_\lambda(t) = a_\lambda(t)\phi_\lambda(t)$\\
\textbf{Замечание}
\begin{enumerate}
    \item $\lambda \neq \mu \Rto p_\lambda p_\mu$ делится на $\phi$\\
    \textbf{Доказательство}\\
    $p_\lambda(t) = a_\lambda \phi_\lambda(t)$\\
    $p_\mu(t) = a_\mu \phi_\mu(t)$\\
    $p_\lambda(t)p_\mu(t) = a_\lambda(t)a_\mu(t)\phi_\lambda(t)\phi_\mu(t) = b(t)\phi(t)$
    \item Пусть все корни $\phi$ взаимно-простые, т.е. $\fall \lambda\ m(\lambda) = 1$\\
    $\phi(t) = \prod_\lambda (t-\lambda)$\\
    $\deg a_\lambda(t) \leq m(\lambda) - 1 = 0$\\
    Отсюда $a_\lambda(t) = \const$
\end{enumerate}
\textbf{Теорема Лагранжа}\\
Пусть все корни $\phi(t)$ взаимно прострые\\
Т.е. $\fall \lambda: m(\lambda) = 1\ \phi(t) = \prod_\lambda (t-\lambda)$\\
Тогда $\fall p \in P_{m-1}\ p(t) = \sum_\lambda \frac{p(\lambda)}{\phi'(\lambda)}\phi_\lambda(t)$\\
($a_\lambda = \frac{p(\lambda)}{\phi'(\lambda)}$)\\
\textbf{Доказательство}\\
$\ex! (p_\lambda): p_i \in I_i, p(t) = \sum_\lambda \ub{\phi_\lambda(t)\in I_\lambda}{a_\lambda \phi_\lambda(t)}$\\
$p(\lambda) = \sum_\mu a_\mu \phi_\mu(\lambda) = a_\lambda \phi_\lambda(\lambda) \Rto a_\lambda = \frac{p(\lambda)}{\phi_\lambda(\lambda)}$\\
$\phi(t) = \prod_\mu (t-\mu) = (t-\lambda) \ub{\phi_\lambda(t)}{\prod_{\mu \neq \lambda} (t-\mu)}$\\
$\phi'(t) = \sum_\mu \prod_{\xi \neq \mu}(t-\xi)$\\
$\phi'(\lambda) = \prod_{\xi \neq \lambda} (\lambda - \xi) = \phi_\lambda(\lambda)$\\
Отсюда $a_\lambda = \frac{p(\lambda)}{\phi'(\lambda)}$\\
\textbf{Следствие}\\
Пусть $\fall \lambda: m(\lambda) = 1$\\
Тогда $1 = \sum_\lambda p_\lambda \Rto p(t) = t = \sum_\lambda \lambda p_\lambda$\\
\textbf{Доказательство}\\
$1 = \sum_\lambda a_\lambda \phi_\lambda(t) = \sum_\lambda \frac1{\phi'(\lambda)}\phi_\lambda(t)$\\
$t = \sum_\lambda \frac\lambda{\phi'(\lambda)}\phi_\lambda(t) = \sum_\lambda \lambda p_\lambda(t)$\\\\
Пусть $\phi(t) = \prod_\lambda (t-\lambda)^{m(\lambda)}$ -- минимальный многочлен $\mcA \in \nm{End}(V)$\\
Построим полиноминальное разложение $1$, порождающее многочлен $\phi$\\
$1 = \sum_\lambda p_\lambda(t) = \sum_\lambda a_\lambda(t)\phi_\lambda(t)$\\
$\epsilon = \sum_\lambda \ub{\rho \text{-- спектр. проектор оператора $\mcA$}}{p_\lambda(\mcA)} = \sum_\lambda a_\lambda(\mcA) \phi_\lambda(\mcA)$\\
$\epsilon = \sum_\lambda \rho_\lambda$ -- операторное разложение единицы (порожденное оператором)\\
\underline{\textbf{Спектральный оператор действует не на собственное подпространство}}\\\\
\textbf{Свойства}\\
Пусть $\lambda \neq \mu$\\
Проверим, что $\rho_\lambda \rho_\mu = \0$\\
$\rho_\lambda = p_\lambda(\mcA) = a_\lambda(\mcA)\phi_\lambda(\mcA)$\\
$\rho_\mu = p_\mu(\mcA) = a_\mu(\mcA)\phi_\mu(\mcA)$\\
$\rho_\lambda\rho_\mu = (\rho_\lambda\rho_\mu)(\mcA) = b(\mcA)\phi(\mcA) = \0$\\\\
Если $\lambda$ единственный корень $\phi(t) = (t-\lambda)^{m(\lambda)} \cdot \ub{\phi_\lambda(t)}1$\\
$1 = 1 \LRto p_\lambda = \epsilon$\\
Если все корни взаимно прострые:\\
$\fall \lambda\ m(\lambda) = 1$\\
По следствию из т. Лагранжа:\\
$\epsilon = \sum_\lambda p_\lambda$\\
$\mcA = \sum_\lambda \lambda p_\lambda$\\
Далее покажем, что $p_\lambda$ -- проекторы на $V_\lambda$, т.е. совпадает со спектральным разложением о.п.с\\
Т.е. $\mcA$ -- о.п.с.\\
\textbf{Определение}\\
$K_\lambda = \ker (\mcA - \lambda \epsilon)^{m(\lambda)}$ называется корневым подпространством $\mcA$\\
$\lambda$ -- СЧ $\mcA$\\
Очевидно, что $V_\lambda \subset K_\lambda$\\
$V_\lambda = \ker (\mcA - \lambda \epsilon) \subset \ker (\mcA - \lambda \epsilon)^{m(\lambda)} = K_\lambda$\\
\textbf{Теорема о корневом подпространстве}
\begin{enumerate}
    \item $K_\lambda$ -- инвариантно относительно $\mcA$
    \item $\im \rho_\lambda = K_\lambda (\Rto \bigoplus_\lambda K_\lambda = V)$
    \item $(t-\lambda)^{m(\lambda)}$ минимальный многочлен для $A\vl_{K_\lambda} \in \nm{End}(K_\lambda)$
\end{enumerate}
\textbf{Доказательство}
\begin{enumerate}
    \item $x \in \ker (\mcA - \lambda\epsilon)^{m(\lambda)} = K_\lambda$\\
    $\ub{\text{перестановочные, т.к. многочлены}}{(\mcA - \lambda \epsilon)^{m(\lambda)} \mcA x} = \mcA (\mcA - \lambda \epsilon)^{m(\lambda)} x = \0$\\
    Отсюда $\mcA x \in \ker (\mcA - \lambda \epsilon)^{m(\lambda)} = K_\lambda$\\
    $\mcA^k = \mcA^{k-1}\mcA = \mcA \mcA^{k-1}$
    \item $\fall x \in V \rho_\lambda x = a_\lambda(\mcA) \phi_\lambda(\mcA)x$\\
    $(\mcA - \lambda \epsilon)^{m(\lambda)} \ub{\im \rho_\lambda}{\rho_\lambda x} = (\mcA - \lambda \epsilon)^{m(\lambda)} a_\lambda (\mcA) \phi_\lambda(\mcA) x = a_\lambda(\mcA)\ub{\phi(\mcA) = 0}{(\mcA - \lambda \epsilon)^{m(\lambda)}\phi_\lambda(\mcA)}x = \0$\\
    Отсюда $\rho_\lambda \ni \rho_\lambda x \in \ker (\mcA - \lambda \epsilon)^{m(\lambda)} = K_\lambda$\\
    Отсюда $\im \rho_\lambda \subset K_\lambda$\\
    \textbf{Обратно}\\
    $x \in K_\lambda = \ker (\mcA - \lambda \epsilon)^{m(\lambda)}$\\
    Пусть $\mu \neq \lambda$\\
    $\rho_\mu x = a_\mu(\mcA)\ub{b(\mcA)(\mcA - \lambda \epsilon)^{m(\lambda)}}{\phi_\mu(\mcA)}x = \0$\\
    $x = \epsilon x = \sum_\mu \rho_\mu x = \rho_\lambda x \in \im \rho_\lambda$\\
    Отсюда $K_\lambda \subset \im \rho_\lambda$
    \item $\mcB = \mcA\vl_{K_\lambda} \in \nm{End}(K_\lambda)$\\
    Проверим, что $(t-\lambda)^{m(\lambda)}$ -- минимальный многочлен\\
    $(t-\lambda)^{m(\lambda)}$ -- аннулятор $\mcB$\\
    Докажем от противного, что он минимальный\\
    Пусть $(t-\lambda)^k$ -- минимальный многочлен, $k < m(\lambda)$\\
    $\phi_1 (t) := (t-\lambda)^k \phi_\lambda(t), \deg \phi_1 \leq \deg \phi$\\
    Покажем, что $\phi_1$ -- аннулятор $\mcA$\\
    $\fall v \in V=\bigoplus_\mu K_\mu\ v = \sum_\mu \ub{\in K_\mu}{v_\mu}$ -- раскладывается единственным образом\\
    $\phi_1(\mcA) v = \sum_\mu (\mcA - \lambda \epsilon)^k \ub{\text{содержит множитель $(\mcA - \lambda \epsilon)^{m(\lambda)}$}}{\phi_\lambda(\mcA)}\ub{\in \ker (\mcA - \lambda \epsilon)^{m(\lambda)}}{v_\mu} = \sum_{\mu \neq \lambda} (\mcA - \lambda \epsilon)^k b_\mu(\mcA)(\mcA - \lambda \epsilon)^{m(\lambda)}v_\mu + (\mcA - \lambda \epsilon)^k \phi_\lambda(\mcA)v_\lambda = \0$\\
    Отсюда $\phi_1$ аннулятор $\mcA$, причем степени меньшей, чем $\phi$, что противоречит минимальности $\phi$\\
    Отсюда $(t-\lambda)^{m(\lambda)}$ минимальный многочлен $\mcB$
\end{enumerate}
\textbf{Следствие 1}\\
$\fall \lambda\ m(\lambda) \leq \dim K_\lambda$ (очевидно из п.3 теоремы)\\
\textbf{Следствие 2}\\
$\mcA$ -- о.п.с $\LRto \fall \lambda\ m(\lambda) = 1$\\
\textbf{Доказательство $\Rto$}\\
$V = \bigoplus_\lambda V_\lambda$\\
Пусть $\phi(t):= \prod_{\lambda \text{ -- СЧ}} (t-\lambda)$\\
Очевидно аннулятор $\mcA$, причем минимальный\\
$\fall v \in V\ v = \sum_\lambda \ub{\in V_\lambda}{v_\lambda}$ -- раскладывается единственным образом\\
$\phi(\mcA) = \prod_{\mu} \prod_\lambda (\mcA - \lambda \epsilon)\ub{\in V_\mu = \ker (\mcA - \mu \epsilon)}{v_\mu} = \prod_\mu \prod_{\lambda \neq \mu} (\mcA - \lambda \epsilon)(\mcA - \mu \epsilon) v_\mu = \0$\\
\textbf{Доказательство $\Lto$}\\
$\fall \lambda\ m(\lambda) = 1$\\
$\phi(t) = \prod_\lambda (t-\lambda)$\\
$\fall \lambda\ K_\lambda = \ker (\mcA - \lambda \epsilon)^1 = V_\lambda$\\
Отсюда $\bigoplus_\lambda K_\lambda = V = \bigoplus_{\lambda}V_\lambda \LRto \mcA$ -- о.п.с.\\
\subsection{Нильпотентные операторы. Разложение Жордана}
\textbf{Определение}\\
$\mcB \in \nm{End}(V)$ называется \textit{нильпотентным}, если $\chi_\mcB = t^\nu, \nu \geq 1$\\
$\nu$ -- индекс нильпотентности ($\nu \leq n$)\\
(Т.е. $\mcB^\nu = \0$)\\
\textbf{Теорема (разложение Жордана)}\\
$\fall \mcA \in \nm{End}(V)$\\
$\ex \mc{D}$ -- оператор простой структуры $\in \nm{End}(V), \mcB$ нильпотентный $\in \nm{End}(V): \mcA = \mc D + \mcB$, причем $\mcB \mc D = \mc D \mcB$\\
\textbf{Доказательство}\\
$\phi(t)$ -- минимальный многочлен $\mcA$(все корни $\in K$)\\
$\epsilon = \sum_\lambda \rho_\lambda$\\
$\mcD:= \sum_\lambda \lambda \rho_\lambda$\\
Проверим, что $\mcD$ -- о.п.с.\\
Достаточно убедиться, что $\lambda$ -- СЧ $\mcD, \im \rho_\lambda = V_\lambda^D$ -- собственное подпространство для $\mcD$\\
Пусть $v_\lambda \in \im \rho_\lambda$\\
$\mcD v_\lambda = \sum_\mu \mu \ub{\mu \neq \lambda \Rto \ldots = 0}{\rho_\mu \ub{\in \im \rho_\lambda}{v_\lambda}} = \lambda \rho_\lambda v_\lambda = \lambda v_\lambda \Rto \lambda$ -- СЧ $\mcD$\\
$V = \bigoplus_\mu \im \rho_\mu$ -- дизъюнктны\\
Отсюда $\im \rho_\lambda \subset V_\lambda^\mcD$\\
$V = \bigoplus_\lambda \im p_\lambda \subset \bigoplus_\lambda V_\lambda^\mcD \subset V$\\
Отсюда $\im p_\lambda = V_\lambda^\mcD$\\
$\mcD$ -- о.п.с\\
$V = \bigoplus_\lambda V_\lambda^\mcD$\\
$D = \sum_\lambda \rho_\lambda$ -- спектральное разложение $\mcD$\\
$\mcB := \mcA - \mcD$\\
$\nu := \max_\lambda m(\lambda)$\\
Покажем, что $\mcB^\nu = \0$\\
$(\mcA - \mcD)^\nu = (\mcA - \sum_\lambda \lambda \rho_\lambda)^\nu = (\mcA\sum_\lambda \rho_\lambda - \sum_\lambda \lambda\rho_\lambda)^\nu = (\sum_\lambda (\mcA - \lambda \epsilon)\rho_\lambda)^\lambda = \sum_\lambda (\mcA - \lambda \epsilon)^\nu\rho_\lambda = \sum_\lambda b_\lambda(\mcA) (\mcA - \lambda \epsilon)^{m(\lambda)} \phi_\lambda(\mcA) = \0$\\
$\mcB\mcD = (\mcA - \sum_\lambda \lambda \rho_\lambda)(\sum_\mu \mu \rho_\mu) = (\sum_\mu \mu \rho_\mu)(\mcA - \sum_\lambda \lambda \rho_\lambda) = \mcD\mcB$\\
\textbf{Теорема (единственность разложения Жордана)}\\
Разложение Жордана $\mcA = \us{\text{о.п.с}}\mcD + \us{\text{нильпот.}}\mcB$ возможно единственным образом\\
\textbf{Доказательство}\\
Пусть $\mcA = \us{\text{о.п.с}}\mcD' + \us{\text{нильпот.}}\mcC$\\
$\mcD' = \sum_\mu \mu Q_\mu$ -- спектральное разложение\\
Достаточно доказать, что
\begin{enumerate}
    \item множество $\mu$ с.ч. $\mcD'$ совпадает с множеством с.ч. $\mcA$
    \item $\im Q_\lambda = K_\lambda(D = \sum_\lambda \lambda \rho_\lambda, \im \rho_\lambda = K_\lambda)$\\
    $\Rto \mcD = \mcD'$
    \item $\mcC = \mcA - \mcD' = \mcA - \mcD = \mcB$
\end{enumerate}
$(\mcA - \mu\epsilon)Q_\mu = (\sum_\xi \xi Q_\xi + \mcC - \mu\epsilon)Q_\mu = \mcC Q_\mu$\\
Покажем, что $\mcC Q_\mu = Q_\mu \mcC$\\
$\letus \lambda \neq \mu\ (\lambda - \mu) Q_\lambda C Q_\mu = \lambda Q_\lambda C Q_\mu - Q_\lambda C \mu Q_\mu = Q_\lambda D' C Q_\mu - Q_\lambda CD' Q_\mu = Q_\lambda(D'C-CD')Q_\mu = \0$\\
Отсюда $Q_\lambda C Q_\mu = \0 = Q_\mu C Q_\lambda, \lambda \neq \mu$\\
$\sum_\lambda Q_\lambda C Q_\mu = \sum_\mu Q_\lambda C Q_\mu$\\
При $\lambda = \mu: CQ_\mu = Q_\mu C$\\
$(\mcA - \mu \mcC)^k Q_\mu = \mcC^kQ_\mu$\\
Пусть $m(\mu)$ -- минимальное $k: (\mcA - \mu \epsilon)^{m(\mu)} = \0$\\
Такой $k$ найдется, т.к. $\mcC$ нильпотентный и при каком-то $k$ дает $= \0$\\
$\psi_\mu (t) = (t-\mu)^{m(\mu)}$\\
$\fall x \in \im Q_\mu\ \psi_\mu(\mcA)x = \0$\\
Тогда $\psi_\mu(\mcA)$ -- минимальный аннулятор элементов $\im Q_\mu$\\
$\phi$ -- минимальный многочлен, т.е. аннулятор любых элементов, в частности и $\im Q_\mu$\\
Тогда $\phi$ делится на $\psi_\mu$\\
Тогда $\fall \mu\ \mu$ -- корень $\phi$\\
Рассмотрим $\psi = \prod_\mu \psi_\mu (t)$. Покажем, что это аннулятор $\mcA$\\
$\fall v \in V\ v = \sum_\mu \ub{\in \im Q_\mu}{v_\mu}$\\
$\psi(\mcA)v = \sum_\xi \psi(\mcA)v_\xi = \sum_\xi b_\xi(\mcA)\psi_\xi(\mcA)v_\xi = \0$\\
Отсюда $\psi$ -- аннулятор $\mcA$\\
Тогда $\psi$ делится на $\phi$\\
Т.о. $\psi \equiv \phi$\\
Докажем пункт 2\\
$(\mcA - \lambda \epsilon)^{m(\lambda)}Q_\lambda = \0$\\
$\im Q_\lambda \subset \ker (\mcA - \lambda\epsilon)^{m(\lambda)} = K_\lambda$\\
$V = \bigoplus_\lambda \im Q_\lambda \subset \bigoplus_\lambda K_\lambda = V$\\
$\im Q_\lambda = K_\lambda = \im p_\lambda$\\
\textbf{Теорема 3}\\
$\mcA = \mcD + \mcB$ -- разложение Жордана\\
$\chi_\mcA \equiv \chi_\mcD$\\
\textbf{Доказательство}\\
$\mcD = \sum_\lambda \lambda p_\lambda$\\
$\mcB = \mcA - \mcD$\\
$\mcB^\nu = \0, \nu = \max m(\lambda)$\\
$\mcA,\mcB,\mcD$ -- попарно перестановочные\\
$\epsilon = \sum_\lambda \rho_\lambda$\\
$\im p_\lambda = K_\lambda = \ker (\mcA - \lambda \epsilon)^{m(\lambda)}$\\
$(\chi_\mcA(\mu))^\nu = (\det \mcA - \mu \epsilon)^\nu = \det (\mcA - \mu \epsilon)^\nu$\\
$t \in K, (\mcA - \mu \epsilon)^\nu - t^\nu \mcB^\nu = (\mcA - \mu\epsilon - t\mcB)((\mcA - \mu\epsilon)^{\nu - 1} + (\mcA - \mu\epsilon)^{\nu - 2}t\mcB + \ldots + t^{\nu-1}\mcB^{\nu - 1})$\\
$\ub{\text{не зависит от $t$}}{\det (\chi_\mcA(\mu))^\nu} = \ub{\text{многочлен от $t$}}{\det (\mcA - \mu\epsilon - t\mcB)}\ub{\text{многочлен от $t$}}{\det((\mcA - \mu\epsilon)^{\nu - 1} + (\mcA - \mu\epsilon)^{\nu - 2}t\mcB + \ldots + t^{\nu-1}\mcB^{\nu - 1})}$\\
Отсюда $\det (\mcA - \mu\epsilon - t\mcB)$ и $\det((\mcA - \mu\epsilon)^{\nu - 1} + (\mcA - \mu\epsilon)^{\nu - 2}t\mcB + \ldots + t^{\nu-1}\mcB^{\nu - 1})$ не зависит от $t$\\
Тогда $\det (\mcA - \mu\epsilon - t\mcB) \us{t = 1}= \det (\mcA - \mu\epsilon - \mcB) = \det (\mcD-\mu\epsilon)$\\
$\det((\mcA - \mu\epsilon)^{\nu - 1} + (\mcA - \mu\epsilon)^{\nu - 2}t\mcB + \ldots + t^{\nu-1}\mcB^{\nu - 1}) \us{t=0}= \det((\mcA - \mu\epsilon)^{\nu - 1})$\\
$(\chi_\mcA(\mu))^\nu = \ub{\chi_\mcD(\mu)}{\det (\mcD - \mu \epsilon)}\ub{\chi_\mcA(\mu)}{\det (\mcA - \mu \epsilon)^{\nu-1}}$\\
Отсюда $\chi_\mcA(\mu) = \chi_\mcD(\mu)$\\
$\chi_\mcA(\lambda) = \chi_\mcD(\lambda) = 0$\\
\textbf{Следствие 1}\\
$\det \mcA = \chi_\mcA(0) = \chi_\mcD(0) = \det \mcD$\\
\textbf{Следствие 2}\\
$\dim K_\lambda = \alpha(\lambda)$\\
\textbf{Доказательство}\\
$\alpha(\lambda)$ -- кратность корня в $\chi_\mcA \Rto $ в $\chi_\mcD$. А т.к. $\mcD$ -- о.п.с., то $\dim K_\lambda^\mcD = \dim V_\lambda^\mcD = \alpha(\lambda)$
\subsection{Жорданова форма матрицы. Жорданов базис. Функция от матрицы}
Пусть все корни $\chi(t)\in K$\\
$V = \bigoplus_\lambda K_\lambda$\\
$K_\lambda = \ker (\mcA - \lambda \epsilon)^{m(\lambda)}$\\
Построим в каждом $K_\lambda$ такой базис, что матрица оператора в нем будет иметь определенный вид. Этот вид и базис будут называться жордановыми\\
Пусть $K_\lambda =: K, m(\lambda) =: m, \mcB = (\mcA - \lambda \epsilon)\vl_{K_\lambda = K}$\\
Пусть $K_j = \ker (\mcA - \lambda \epsilon)^j, j = 1\ldots m$\\
$V_\lambda = K_1 \subset K_2 \subset \ldots \subset K_m = K_\lambda = K$\\
$K_r \neq K_{r+1}$\\
Пусть это не так\\
Тогда $\ker \mcB^r = \ker \mcB^{r+1}$\\
$\dim K = \rg \mcB^r + \dim K_r = \rg \mcB^{r+1} + \dim K_{r+1}$\\
Отсюда $\rg \mcB^r = \rg \mcB^{r+1}$\\
$\im \mcB^{r+1} \subset \im \mcB^r$\\
Т.о. $\im \mcB^{r+1} = \im \mcB^r$\\
Тогда $\im \mcB^r = \im \mcB^{r+1} = \ldots = \im \mcB^m = \0$, что противоречит минимальности $m$\\\\
Рассмотрим $K_1 \ldots K_m$\\
Найдем $j_m$ -- компоненту, которая лежит в $K_m$, но не лежит в $K_{m-1}$\\
$j_m \in K_m \setminus K_{m-1}$
$j_r := \mcB j_{r+1}, r = m-1\ldots 1$\\
Заметим, что $j_r \in K_r$\\
$j_r \in K_r = \ker \mcB^r$\\
$j_{r-1} = \mcB j_r$\\
$\mcB ^ {r-1} j_{r-1} = \mcB^r j_r = \0$\\
Отсюда $j_{r-1} \in K_{r-1} = \ker \mcB^{r-1}$\\
$Bj_1 = \0$\\
$\ub{\text{присоединенные вектора}}{j_1, \ldots, j_{m-1}}, j_m$ -- циклический базис, порожденный вектором $j_m$\\
Далее повторяем это для всех векторов $K_m, K_{m-1}, \ldots$\\
Максимальная длина циклического базиса, порожденного $j_r = r$\\
$j_1 \in V_\lambda$ -- собственном подпространстве\\
Линейное подпространство, порожденное $\span$ циклических базисов -- \textit{башня} высоты, равной длине циклического базиса\\
Башни образуют \textit{замок Жордана}\\
Ширина башни -- число циклических базисов в ней\\
Высота башни -- размер циклического базиса\\
Опорные вектора(фундамент башни) -- вектора $j_m$\\
Крыша башни -- вектора $j_1$\\
Крыша башна -- собственное подпространство\\
Башню рисуют опорными подпространствами как сверху, так и снизу\\
Если $\gamma(\lambda) = \alpha(\lambda)$, то $V_\lambda = K_\lambda$, то замок будет состоять из одной башни высоты 1\\
$K = K_\lambda = \span (\ldots, j_1, j_2, \ldots, j_m, \ldots)$ -- линейная оболочка всех векторов всех башен\\
$j_r = \mcB j_{r+1}$\\
$j_r = (\mcA - \lambda \epsilon)j_{r+1}$\\
$\mcA j_{r+1} = j_r + \lambda j_{r+1}$\\
$\begin{array}{l}
     \mcA j_1 = \lambda j_1\\
     \mcA j_2 = j_1 + \lambda j_2\\
     \vdots\\
     \mcA j_m = j_{m-1} + \lambda j_m
\end{array} \lrto J_m = \begin{pmatrix}
    \lambda & 1 & 0 & \ldots & 0\\
    0 & \lambda & 1 & \ldots & 0\\
    \vdots & \ddots & \ddots & \ddots & \vdots\\
    0 & \ddots & 0 & \lambda & 1\\
    0 & 0 & \ldots & 0 & \lambda
\end{pmatrix}$ -- клетка Жордана $m$-ого порядка (блок нижнего уровня)\\
Каждая клетка соответствует одному циклическому базису размера $m$\\
Рассмотрим теперь блочную матрицу $\nm{diag}(\ub{\text{блок среднего уровня}}{J_1, \ldots J_1}, \ldots, \ub{\text{блок среднего уровня}}{J_m, \ldots, J_m})$ -- блок верхнего уровня, отвечающий корневому подпространству $K_\lambda$\\
Каждый блок среднего уровня соответствует башне соответствующей высоты\\
Объединим все блоки вернего уровня всех корневых пространств в блочно-диагональную матрицу\\
Получим жорданов базис пространства $V$\\
Матрица $\mcA$ в этом базисе будет иметь блочно-диагональный вид, где на диагонали будут находиться клетки Жордана, отвечающие циклическим базисам -- Жорданова форма матрицы\\
$T_{e\rto j} = T = (\ldots, j_1, \ldots j_m, \ldots)\\$
$T^{-1}AT = J$\\
$J = \nm{diag}($блоки верхнего уровня всех корневых пространств$)$\\
\textbf{Обоснование алгоритма}\\
Пусть $\mcB K = \im \mcB$\\
$Z_0 = \mcB K$\\
$Z_r = \mcB K + K_r, r = 1\ldots m$\\
$Z_m = \mcB K + K_m = K$\\
$Z_0 \subseteq Z_1 \subseteq \ldots \subseteq Z_m$\\
$\ol K_1\subset K_1: Z_1 = Z_0 \oplus \ol K_1$\\
$\ol K_2\subset K_2: Z_2 = Z_1 \oplus \ol K_2$\\
$\ol K_r \subset K_r: Z_r = Z_{r-1}\oplus \ol K_r = K$\\
$K = \ol K_1 \oplus \ldots \oplus \ol K_m \oplus \mcB K$ (1)\\
$\ol K_j$ -- опорные подпространства\\
\textbf{Теорема}\\
$1 \leq r \leq m$\\
$\mcB^r K = \mcB^r \ol K_{r+1}\oplus \mcB^r \ol K_{r+2} \oplus \ldots \oplus \mcB^r \ol K_m \oplus \mcB^{r+1}K$\\
\textbf{Доказательство}\\
$K = \ol K_1 \oplus \ldots \oplus \ol K_m \oplus \mcB K$ (1)\\
$\fall x \in K:\ \ex! (x_i \in \ol K_j): x = x_1 + \ldots + x_m + \mcB x', x' \in K $\\
$\mcB^r x = \sum_{j=1}^m \mcB^r \ub{\in K_j = \ker \mcB^j}{x_j} + \mcB^{r+1}x' = \sum_{j=r+1}^m \mcB^r x_j +\mcB^{r+1}x' \in \sum_{j=r+1}^m \mcB^r \ol K_j + \mcB^{r+1}K$\\
Докажем дизъюнктность\\
$\sum_{j=r+1}^m \mcB^r x_j +\mcB^{r+1}x' = \0$\\
$\mcB^r\ub{\in K_r \subset Z_r \ol K_1 \oplus \ol K_r  \oplus \mcB K}{(\sum_{j=r+1}^m \ub{\in \ol K_j}{x_j} + \mcB x')}=\0$\\
$\sum_{j=r+1}^m \ub{\in \ol K_j}{x_j} + \mcB x' = \sum_{j=1}^m x_j + \mcB y'$\\
В силу единственности разложения и дизъюнктности $\ol K_j$ и $\mcB K$ $\fall j\ x_j = \0$\\
$\0 + \mcB^{r+1} = \0$ -- дизъюнктность\\\\
$K = \ol K_1 \oplus \ldots \oplus \ol K_m \oplus \mcB K$\\
$\mcB K = \mcB \ol K_2 \oplus \mcB \ol K_3 \oplus \ldots \oplus \mcB \ol K_m \oplus \mcB^2 K$\\
$\vdots$\\
$\mcB^{m-1}K = \mcB^{m-1}\ol K_m \oplus \ub{=\0}{\mcB^m K}$\\
Отсюда следствие\\
\textbf{Следствие}\\
$K = \ol K_1 \oplus \ldots \oplus \ol K_m \oplus \mcB \ol K_2 \oplus \ldots \oplus \mcB\ol K_m \oplus \mcB^3 \ol K_3 \oplus \ldots \oplus \mcB^3 \ol K_m \oplus \ldots \oplus \mcB^{m-1}\ol K_m$\\
Сумма представляется в виде пирамиды\\
\begin{tabular}{ccccc}
     & & & & $\ol K_m$\\
     & & & $\ol K_{m-1}$ & $\ol \mcB K_m$\\
     & & $\iddots$ & $\iddots$ & $\vdots$\\
     & $\ol K_2$ & \ldots & $\mcB^{m-3}\ol K_{m-1}$ & $\ol \mcB^{m-2} K_m$\\
     $\ol K_1$ & $\mcB \ol K_2$ & \ldots & $\mcB^{m-2}\ol K_{m-1}$ & $\ol \mcB^{m-1} K_m$\\
\end{tabular}\\
Данная таблица соответствует башням\\
$\mcB^{r-1}\ol K_r \subset V_\lambda$\\
$\mcB (\mcB^{r-1}\ol K_r) = \mcB^r \ol K^r = \-$\\
Отсюда $\mcB^{r-1}\ol K_r \subset \ker \mcB = V_\lambda$\\
Если $\ol K_r \neq \0$, то $J_r = \ol K_r \oplus \ldots \oplus \mcB^{r-1} \ol K_r$\\
$\ol K_r$ -- основание башни (опорное пространство, поорожденное $J_r$)\\
$V_\lambda = \ol K_1 \oplus \mcB \ol K_2 \oplus \ldots \oplus \mcB^{m-1} \ol K_m$ -- основание (1 этаж -- крыша)\\
Верхние клетки каждого этажа -- основание\\\\
$l$-ый этаж: $\ol K_l \oplus \mcB \ol K_{l+1} \oplus \ldots \oplus \mcB^{m-l}\ol K_m \subset K_l$\\
$\mcB^l (\mcB^j \ol K_{l+j}) = \mcB^{l+j}\ol K_{l-j} = \0, j = 0\ldots m-l$\\
Отсюда $\mcB^j\ol K_{l+j} \subset K_l$\\
Первые $j$ этажей соответствуют $K_j$\\
Отсюда каждый следующий этаж -- прямое дополнение предыдущих\\
\textbf{Теорема (о размерности башни)}\\
Все этажи башни имеют однинаковую размерность $d_r = \dim \ol K_r = \dim \mcB^j \ol K_r, j = 1 \ldots r-1$\\
\textbf{Доказательство}\\
Рассмотрим $\mcB^j$ (очевидно, что $\mcB^j$ -- эндоморфизм)\\
Докажем, что $\mcB^j$ -- изоморфизм, т.е.  сохраняет размерность, т.е. $\dim \ol K_r = \dim \mcB^j \ol K_r$\\
Для этого докажем тривиальность ядра\\
Пусть $x \in \ol K_r, \mcB^j (x) = \0$\\
Тогда $x \in \ker B^j = K^j$\\
$x \in \ol K_r \cap K^i, i = 1\ldots r-1$\\
$K_1, \ldots, K_{r-1}$ дизъюнктны с $\ol K_r$\\
Т.о. $x = \0$\\
Тогда ядро тривиально, ч.т.д.\\
\textbf{Следствие}\\
$\dim V_\lambda = \gamma(\lambda) = \sum_{r=1}^m d_r$\\
$\dim K_\lambda = \alpha(\lambda) = \sum_{r=1}^m r d_r$\\
\textbf{Следствие 2 (теорема Фробениуса)}\\
$\fall r = 1\ldots m\ d_r = \rg \mcB^{r-1} - 2\rg \mcB^r + \rg \mcB^{r+1}$\\
(при $r = m\ d_m = \rg \mcB^{m-1}$)\\
\textbf{Доказательство}\\
$\rho_j = \rg \mcB^j$\\
$\ub{\im \mcB^j}{\mcB^j K} = \ub{d_{j+1}}{\mcB^j \ol K_{j+1}} \oplus \ldots \oplus \ub{d_m}{\mcB^j \ol K_{m}} \oplus \ub{\im \mcB^{j+1}}{\mcB^{j+1}K}$\\
$\rho_j = d_{j+1} + \ldots + d_m + \rho_{j+1}$\\
$\rho_j-\rho_{j+1} = d_{j+1}+\ldots+d_m$\\
$\rho_0 = \rg \mcB^0 = \rg \epsilon = \dim K_\lambda = \alpha(\lambda)$\\
$d_1 + \ldots + d_m = \rho_0 - \rho_1$\\
$\vdots$\\
$d_{n-1}+d_m = \rho_{m-2}-\rho_{m-1}$\\
$d_m =\rho_{m-1}-\rho_m$\\
Отсюда $d_r = \rho_{r-1}-2\rho_r + \rho_{r+1}$\\
$d_m = \rho_{m-1}+0+0$\\
\textbf{Замечание}\\
На практике удобнее\\
$\rho \mcB^j = \dim K_\lambda - \dim K_j$\\\\
Рассмотрим башню\\
$\dim \ol K_r = d_r = d$\\
$\ol K_r = \span (g_1, \ldots, g_d)$\\
\begin{tabular}{c|cccc}
    $\ol K_r$ & $g_1$ & $g_2$ & $\ldots$ & $g_d$ \\
    $\mcB \ol K_r$ & $\mcB g_1$ & $\mcB g_2$ & $\ldots$ & $\mcB g_d$ \\
    $\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ & $\vdots$\\
    $\mcB^{r-1}\ol K_r$ & $\mcB^{r-1} g_1$ & $\mcB^{r-1} g_2$ & $\ldots$ & $\mcB^{r-1} g_d$\\
\end{tabular}
$\mcB^j$ -- изоморфизм, т.е. базис переходит в базис\\
$\mcB^j g_1 \ldots \mcB^j g_d$ -- базис $\mcB^j \ol K^r$ -- циклический базис\\
Тогда $J_r = \bigoplus_{i=1}^d \span (\mcB^{r-1} g_i, \ldots, \mcB g_i, g_i)$\\
$\mcA(\mcB^j g_i) = (\mcB + \lambda\epsilon)\mcB^j g_i = \mcB^{j+1}g_i + \lambda \mcB^j g_i$\\
$\mcA\vl_{\span (\mcB^{r-1} g_i, \ldots, \mcB g_i, g_i)} \us{\text{в цикл.базисе}}\lrto J_r$ -- клетка Жордана размерности $r\times r$ -- блок нижнего уровн\\
$\mcA\vl_{J_i} \lrto \nm{diag}(\ub{\text{$d_r$ штук}}{J_r(\lambda), \ldots, J_r(\lambda)}) = \mc T_{J_r}(\lambda)$\\
$\mcA\vl_{K = \bigoplus_{r=1}^m J_r} \lrto \nm{diag}(\mc T_{J_1}(\lambda), \ldots, \mc T_{J_m}(\lambda)) = \mc J(\lambda)$\\
$\mcA \lrto \nm{diag}(\mc J(\lambda_1), \mc J(\lambda_2), \ldots) = \mc J_A = \mc J$\\
//todo 13:11 16.03
\subsection{Функция от матрицы, приводимой к жордановой форме}
Пусть $f(x) = \sum_{k=0}^\infty c_k x^k, |x| < R$\\
$f(A) = \sum_{k=0}^\infty c_k A^k$\\
$\letus T(j_1, \ldots, j_n), A=T\mcJ T^{-1}$\\
Пусть $\mcJ = \nm{diag}(\mcJ_1, \ldots, \mcJ_n)$
Тогда $\mcJ^k = \nm{diag}(\mcJ(\lambda_1)^k, \ldots, \mcJ(\lambda_n)^k)$\\
$A^k = T\nm{diag}(\mcJ(\lambda_1)^k, \ldots, \mcJ(\lambda_n)^k)T^{-1}$\\
$f(A) = T\nm{diag}(f(\mcJ(\lambda_1)), \ldots, f(\mcJ(\lambda_n)))T^{-1}$\\
$J_r = \begin{pmatrix}
    \lambda & 1 & 0 & \ldots & 0\\
    0 & \lambda & 1 & \ldots & 0\\
    \vdots & \ddots & \ddots & \ddots & \vdots\\
    0 & \ddots & 0 & \lambda & 1\\
    0 & 0 & \ldots & 0 & \lambda
\end{pmatrix} = \lambda E_{r\times r} + I_r, I_r = \begin{pmatrix}
    0 & 1 & 0 & \ldots & 0\\
    0 & 0 & 1 & \ldots & 0\\
    \vdots & \ddots & \ddots & \ddots & \vdots\\
    0 & \ddots & 0 & 0 & 1\\
    0 & 0 & \ldots & 0 & 0
\end{pmatrix}$\\
$I_r^2 = \begin{pmatrix}
    0 & 0 & 1 & 0 & \ldots & 0\\
    0 & 0 & 0 & 1 & \ldots & 0\\
    \vdots & \ddots & \ddots & \ddots & \ddots & \vdots\\
    0 & \ddots & 0 & 0 & 0 & 1\\
    0 & 0 & \ldots & 0 & 0 & 0\\
    0 & 0 & \ldots & 0 & 0 & 0
\end{pmatrix}$\\
Т.е. ряд единиц "уезжает вверх"\\
Отсюда $J_r^k = (\lambda E_{r\times r} + I_r)^k = \sum_{m=0}^k C_k^m \lambda ^{k-m} I_r^m = C_k^0\begin{pmatrix}
    \lambda^k & 0 & 0 & \ldots & 0\\
    0 & \lambda^k & 0 & \ldots & 0\\
    \vdots & \ddots & \ddots & \ddots & \vdots\\
    0 & \ddots & 0 & \lambda^k & 0\\
    0 & 0 & \ldots & 0 & \lambda^k
\end{pmatrix} + C_k^1 \begin{pmatrix}
    0 & \lambda^{k-1} & 0 & \ldots & 0\\
    0 & 0 & \lambda^{k-1} & \ldots & 0\\
    \vdots & \ddots & \ddots & \ddots & \vdots\\
    0 & \ddots & 0 & 0 & \lambda^{k-1}\\
    0 & 0 & \ldots & 0 & 0
\end{pmatrix} + \ldots\\ = \begin{pmatrix}
    C_k^0\lambda^k & C_k^1\lambda^{k-1} & C_k^2\lambda^{k-2} & \ldots & C_k^{k-r+1}\lambda^{k-r+1} & 0 & 0 & \ldots 0\\
    0 & C_k^0\lambda^k & C_k^1\lambda^{k-1} & C_k^2\lambda^{k-2} & \ldots & C_k^{k-r+1}\lambda^{k-r+1} & 0 & \ldots & 0\\
    0 & 0 & \ddots & \ddots & \ddots & \ddots & \ddots & \ddots & \ddots\\
\end{pmatrix}$\\
//todo 23.03 10:27
\section{Черная магия}
$(\ln |x|)' = \frac1x$\\
Отсюда $(\ln |y|)' = \frac{y'}{y}$\\
$y' = y (\ln |y|)'$ (удобно)
\section{Тензоры}
\subsection{Линейные формы. Сопряженное пространство. Ковариантные и контрвариантные преобразования}
$V$ -- линейное пространство над $K(\Rset, \Cset)$\\
\textbf{Определение}\\
Линейная функция $f:V\rto K$ называется \textit{линейной формой(линейным функционалом)}\\
Т.е. $f(x_1 + \lambda x_2) = f(x_1) + \lambda f(x_2)$\\
\textbf{Пример}
\begin{enumerate}
    \item Скалярное умножение на фиксированный вектор
    \item $A_{n\times n}, f:M_{n\times n} \rto \Rset(\Cset)$\\
    $f(A) = \tr A$
    \item $P_n, t_0 \in \Rset$\\
    Пусть $f^j = P_n \rto \Rset, f^j(p) = \frac{p^{(j)}(t)}{j!}(t_0)$\\
    Тогда $f^0, f^1, \ldots$ -- линейная форма
    \item $f: \ub{\text{функции, непрерывные на }\Rset}C(\Rset) \rto \Rset$\\
    $\delta(f) := f(0)$ -- $\delta$-функция Дирака\\
    $\delta(f)$ -- линейная форма на бесконечномерном пространстве
\end{enumerate}
$n:=\dim V$\\
$V^* = \{ f: V \rto K\, f \text{ -- линейнаяя форма}\}$\\
$\0(x) := 0, \0 \in V^*$\\
$\fall f\in V^*\ -f\in V^*$\\
Тогда $V^*$ -- линейное пространство над полем $K$\\
$V^*$ -- \textit{сопряженное(дуальное)} к $V$\\\\
Вспоминаем правило Эйнштейна\\
Выражение $\alpha^i\beta_i := \sum_{i}\alpha_i\beta_i$\\
иначе: $\alpha^i := \alpha_i$\\\\
$f\in V^*\\ \fall x \in V\ f(x) = f(x^i e_i) = x^i \ub{a_i \in K}{f(e_i)}$\\
$a:= f(e_i)$ называется \textit{коэффициентами линейной формы} $f$\\
Тогда $f(x) = x^i a_i$ -- $f$ полностью описывается значениями на базисных элементах\\
Тогда $f \lrto a = \begin{pmatrix}
    a_1 & a_2 & \ldots & a_n
\end{pmatrix}$ -- зависит от выбора базиса\\
Сопоставление -- изоморфизм\\
\textbf{Фанфакт}\\
\textit{Естественный изоморфизм} -- изоморфизм, который не зависит от выбора базиса. Но это не наш случай\\
$V^* \cong K_n (K^n)$ -- пространство $n$-мерных строк\\
\textbf{Определение}\\
$\omega^i \in V^*, x = x^i e_i$\\
$\fall x\in V \omega^i (x)=x_i$ -- координатные функции\\
(очевидно, что $\omega^i \in V^*, w^i(x_1+\lambda x_2) = x_1^i + \lambda x_2^i$)\\
$w^i (e_j) = \delta_j^i = +(i == j) \lrto \begin{pmatrix}
    0 & 0 & \ldots & \ub{i}1 & \ldots & 0)
\end{pmatrix}$\\
\textbf{Теорема}\\
$\omega^1, \ldots, \omega^n$ -- базис $V^*$\\
\textbf{Доказательство}\\
$\omega^1, \ldots, \omega^n$ -- линейно независимые\\
$\alpha_i \omega^i = \0$\\
$\alpha_i \in K$\\
$j=1\ldots n\ \alpha_i\omega^i(e_j)=\alpha_i \delta_j^i = \alpha_j \Rto \alpha_j = 0 \Rto $ линейно независимые\\
$\dim V^* = n \Rto $ базис\\
\textbf{Следствие}\\
$a_i$ -- координаты $f$ в базисе $\omega^1\dots\omega^n$\\
\textbf{Доказательство}\\
$f(x)=x^ia_i = \omega^i(x)a_i \LRto f=a_i\omega^i$\\
\textbf{Определение}\\
$\omega=\begin{pmatrix}
    \omega^1 & \ldots & \omega^n
\end{pmatrix}$ называется \textit{сопряженным(дуальным)} базисом к базису $e$ пространства $V$\\\\
Вопрос: есть другой базис в $V^*$. Будет ли он сопряженным к некоторому базису $V$\\
\textbf{Теорема}\\
$\omega'^1, \ldots, \omega'^n$ -- базис $V^*$\\
Тогда $\ex e'_1, \ldots, e'_n$ -- базис в $V$ такой, что $\omega'$ сопряжен с $e'$\\
\textbf{Доказательство}\\
Пусть $e'_1, \ldots, e'_n$ -- базис в $V$\\
Базис $V\ \omega^1, \ldots, \omega^n$ сопряжен с $e$\\
$\omega'^1, \ldots, \omega'^n$ -- базис $V^* \Rto \begin{pmatrix}
    \omega'^1 & \ldots & \omega^n
\end{pmatrix} = \begin{pmatrix}
    \omega^1 & \ldots & \omega^n
\end{pmatrix}T_{\omega \rto \omega'}$\\
$\begin{pmatrix}
    \omega'^1\\\vdots\\\omega^n
\end{pmatrix} = \ub{=:S_{\omega \rto \omega'}}{T_{\omega \rto \omega'}^T}\begin{pmatrix}
    \omega^1\\\vdots\\\omega^n
\end{pmatrix}$\\
Построим новый базис $e'$\\
$T_{e\rto e'} = S^{-1} = T$\\
$\begin{pmatrix}
    e_1' & \ldots & e_n'
\end{pmatrix}:= \begin{pmatrix}
    e_1 & \ldots & e_n
\end{pmatrix}T$ -- тоже базис по определению\\
Покажем, что $\omega'$ сопряжен к $e'$, т.е. $\omega'^i$ -- координатные функции по отношению к $e'$\\
Пусть $s^i_j = s_{ij}, t^i_j = t_{ij}$\\
$\fall x\in V\ \omega'^i(x) = s^i_k\omega^k(x) = s^i_k x^k = \ub{\ub{E}{(ST)_j^i} = \delta_j^i}{s^i_k t_j^k} x'^i = \delta^i_j x'^j = x'^i$\\
Отсюда $\omega'^i$ -- координатная функция $\Rto$ базис сопряженный\\
\textbf{Замечание}\\
Вообще говоря, базис $e'$ существует и единственный (очевидно из доказательства)
\textbf{Следствие}\\
$\begin{pmatrix}
    \omega'^1\\\vdots\\\omega^n
\end{pmatrix} = S\begin{pmatrix}
    \omega^1\\\vdots\\\omega^n
\end{pmatrix}, S = T_{\omega \rto \omega'}^T$\\
Тогда $a'=aT$\\
$T = S^{-1} = T_{e\rto e'}$\\
$x'=Sx$\\
\textbf{Доказательство}\\
$X' = SX$ очевидно($X=TX'=S^{-1}X'$)\\
$\begin{pmatrix}
    \omega'^1 & \ldots & \omega^n
\end{pmatrix} = \begin{pmatrix}
    \omega^1 & \ldots & \omega^n
\end{pmatrix} T_{\omega \rto \omega'}$\\
$a^T = T_{\omega\rto \omega'}(a')^T$
$a=a'T^T_{\omega\rto\omega'} = a'S \LRto a'=aS^{-1}aT$\\\\
\textbf{Определение}\\
Если координаты вектора при смене базиса изменяются по тому же закону(т.е. с той же матрицей), что и сам базис, то такой закон называется \textit{ковариантным(согласованным)}, координаты вектора называются \textit{ковариантными} координатами, а сам вектор называется \textit{ковариантным} или \textit{ковектором}\\
Элементы $V^*$ -- это ковекторы (линейная форма $\equiv$ ковектор)\\
В противном случае, если координаты вектора при смене базиса изменяются по закону, провоположному(т.е. с обратной матрицей) тому, по которому сам базис, то такой вектор называется \textit{контрвариантным}, координаты -- \textit{контрвариантными}, вектор -- \textit{контровариантным} или просто вектором\\
Элементы $V$ -- контрвариантные векторы\\
Принято писать индекс координаты контрвектора сверзу, а ковариантного -- снизу\\\\
$\fall f \in V^*, x\in V\ f(x) = x'ia'_i = s^i_k x^k a_m t^m_i = \ub{\delta^m_k}{t^m_i s^i_k} x^k a_m = x^ka_k$\\
Т.о. форма записи $f$ -- инвариант относительно замены базиса\\
\textbf{Определение}\\
$V^{**} = (V^*)^*$\\
$\dim V^{**} = \dim V^* = \dim V$ -- можем построить изоморфизм между $V$ и $V^{**}$\\
\textbf{Теорема 3 (естественный изоморфизм $V$ и $V^{**}$)}\\
\textit{Вместо обозначения "x" буду использовать <x>}\\
$\fall x \in V \rto <x>\in V^{**}$\\
$\fall f \in V^* <x>(f)=f(x)$\\
Отсюда $x \lrto <x>$\\
$V\cong V^{**}$\\
\textbf{Доказательство}\\
$\fall f_1, f_2 \in V^*, \lambda \in K\ <x>(f_1+\lambda f_2) = (f_1 + \lambda f_2)(x) = f_1(x) + \lambda f_2(x) = <x>(f_1) + \lambda <x>(f_2)$\\
Отсюда $<x> \in (V^*)^*$\\
Покажем, что $V$ линейно вложено в $V^{**}$, т.е. $x \in V \rto <x> \in V^{**}$\\
//todo 12:00 23.03\\
Покажем, что базис $V\ e_1, \ldots e_n$ перейдет в базис $V^{**}$\\
$e_j \rto <e_j>$\\
$\fall f\in V^* <e_j>(f) = f(e_j) = a_j$ -- координата $f$ в базисе $\omega^1, \ldots \omega_n$, сопр. с $e$\\
Т.о. $<e_j>$ -- координатная функция в пространстве $V^*$ относительно $\omega^1, \ldots \omega_n$\\
Т.о. по теореме 1 координатные функции -- базис сопряженного пространства\\
Т.о. $<e_j>$ -- базис $V^{**}$\\
Базис $V\ e_1,\ldots, e_n \rto$ базис $V^{**} <e_1>, \ldots, <e_n>$\\
Т.о. отображение линейно, то изоморфизм\\
\textbf{Замечание}
\begin{enumerate}
    \item принято отождествлять элементы $V$ и $V^{**}$ с помощью изоморфизма, описанного в теореме 3\\
    Поэтому $<>$ не пишут\\
    $\fall f\in V^*, x\in V\ f(x)=a_ix^i = f(e_i)x^i = e_i(f)x^i = x(f)$\\
    $a_i = f(e_i)$\\
    $x^i = x(\omega^i)$
    \item $\omega^i(e_j) = \delta_j^i = e_j(\omega^i)$\\
    Как найти на практике?\\
    $e_1, \ldots, e_n \lrto \begin{pmatrix}\vdots\end{pmatrix}\ldots\begin{pmatrix}\vdots\end{pmatrix}$ -- столбцы\\
    $w^i(e_j)=\ub a{\begin{pmatrix}\ldots\end{pmatrix}}\ub x{\begin{pmatrix}\vdots\end{pmatrix}} = \delta_j^i$\\
    Отсюда $\ub{S=T^{-1}}{\begin{pmatrix}
        \omega^1\\\vdots\\\omega^n
    \end{pmatrix}}\ub{T}{\begin{pmatrix}e_1 & \ldots & e_n\end{pmatrix}} = E$
    \item Т.о. понятие сопряженного пространства и сопряженного базиса дуальны\\
    $\omega$ сопряженный базис к $e$\\
    $e$ сопряженный базис к $\omega$\\
    (здесь подразумевается элементы $V^{**}$)
    \item Задача о построении проекторов (разложение элемента на проекции)\\
    $V = \bigoplus_\lambda V_\lambda$\\
    $\fall x \in V\ \ex! x = \sum_\lambda x_\lambda, x_\lambda \in V_\lambda$\\
    $\rho_\lambda: V\rto V, \im \rho_\lambda = V_\lambda, \sum_\lambda \rho_\lambda = \epsilon$\\
    $\fall x \in V\ \rho x := x_\lambda, \ub{\lambda\neq \mu}{\rho_\lambda\rho\mu} = 0$\\
    $v_1,\ldots, v_n$ -- базис $V$ = объединение базисов $V_\lambda$\\
    $x = x^i v_i = \sum_\lambda \ub{x_\lambda}{\sum_{m_\lambda} x^{m_\lambda}v_{m_\lambda}} = \omega^1, \ldots, \omega^n$ -- сопряженный базис $= \sum_\lambda \sum_{m_\lambda}\omega^{m_\lambda}(x)v_{m_\lambda}$\\
    $\omega^{m_\lambda} \lrto (a^{m_\lambda}_i)_i$ -- строка\\
    $x \lrto X$\\
    $\omega^{m_\lambda} (x) = a^{m_\lambda}X$\\
    $v_{m_\lambda} \lrto (V_{m_\lambda, i})_i$ -- столбец\\
    $x = \sum_\lambda \sum_{m_\lambda}V_{m_\lambda}a^{m_\lambda}X = \sum_\lambda \ub{\rho_\lambda}{(\sum_{m_\lambda} V_{m_\lambda}a^{m_\lambda})}X = \sum_\lambda (\sum_{m_\lambda} \ub{\omega^{m_\lambda}(x)}{(a^{m_\lambda}x)} V_{m_\lambda})$\\
\end{enumerate}
\subsection{Два определения тензора. Линейное пространство тензоров. Многомерная матрица}
\textbf{Определение}\\
$V, V^*$ -- сопряженные линейные пространства над полем $K(\Rset, \Cset)$\\
$f: V^p\times (V^*)^q \rto K, p, q \geq 0$ -- линейная по каждому аргументу\\
$f$ -- тензор порядка $(p,q)$ или $p$ раз конвариантом, $q$ раз контрвариантным\\
Множество таких функций обозначим $T_{(p,q)}$\\
$p,q$ -- \textit{валентности}\\
$r = p+q$ -- полная валентность/ранг тензора (не наш $\rg$)\\
$f \in T_{p,0}$ -- ковариантный тензор валентности $p$\\
$f \in T_{0,q}$ -- контрвариантный тензор валентности $q$\\
$r = 0$ -- тензор нулевого ранга. $f = \const \in K$\\
\textbf{Пример}\\
$\ub{V}{x \in \Rset^n}$ -- столбец\\
$\ub{V^*}{a \in \Rset_n}$ -- строка\\
$f(x,a) = ax \in \Rset, f \in T_{(1,1)}$\\\\
$\0$ -- нулевой тензор\\
$\fall \xi_1, \ldots, \xi_p \in V, \nu^1, \ldots, \nu^p \in V^*\ 0(\xi_1, \ldots, \xi_p, \nu^1,\ldots,\nu^q) = 0$\\
$\fall f \in T_{(p,q)}\ -f \in T_{(p,q)}$\\
$T_{(p,q)}$ -- линейное пространство\\\\
$e_1, \ldots, e_n$ -- базис $V$\\
$\omega^1, \ldots, \omega^n$ -- базис $V^*$\\
$e, \omega$ -- сопряженные\\
Для $\xi \in V\ \xi = \xi^i e_j$\\
Для $\nu \in V^*\ \nu = \nu_i \omega^j$\\
Тогда $f(\xi_1, \ldots, \xi_p, \nu^1, \ldots, \nu^q) = f(\xi_1^{j_1} e_{j_1}, \ldots, \xi_p^{j_p}e_{j_p}, \nu^1_{i_1}\omega^{i_1}, \ldots, \nu^q_{i_q}\omega^{i_p})\\ = \xi_1^{j_1}\ldots\xi_p^{j_p}\nu^1_{i_1}\ldots\nu^q_{i_q}f(e_{j_1},\ldots,e_{j_p},\omega^1,\ldots,\omega^{i_q})$ -- любой тензор определяется значениями на всевозможных наборах $e_j, \omega^i$\\
$\alpha_{j_1, \ldots, j_p}^{i_1, \ldots, i_q} := f(e_{j_1}, \ldots, e_{j_p},\omega^{i_1}, \ldots, \omega^{i_q})$ -- коэффициенты тензона $f$ относительно базисов $e, \omega$\\
$f(\xi_1, \ldots, \xi_p, \nu^1, \ldots, \nu^q)\xi_1^{j_1}\ldots\xi_p^{j_p}\nu^1_{i_1}\ldots\nu^q_{i_q}\alpha_{j_1, \ldots, j_p}^{i_1, \ldots, i_q}$\\
\textbf{Определение}\\
$S$ -- множество элементов, записанных с помощью двух типов индексов $s_{j_1, \ldots, j_p}^{i_1, \ldots, i_q}$, где $i_k, j_m \in (1,\ldots n)$ называется $p+q$-мерной матрицей порядка $n$\\
\textbf{Пример}\\
$n = 3$, трехмерная матрица
\begin{enumerate}
    \item $S^{ijk}$
    \item $S^{ij}_k$
    \item $S^i_{jk}$
    \item $S_{ijk}$
\end{enumerate}
$f \lrto \alpha = (\alpha_{j_1, \ldots, j_p}^{i_1, \ldots, i_q})$ -- изоморфизм\\
$T_{(p,q)} \cong S_(p+q)$\\
\textbf{Правило записи элементов тензора в многомерной записи}\\
В $\alpha_{j_1, \ldots, j_p}^{i_1, \ldots, i_q}$ сначала читаются верхние индексы, потом нижние индексы\\
Для двумерных матриц:
\begin{enumerate}
    \item строка
    \item столбец
\end{enumerate}
Для трехмерных матриц:
\begin{enumerate}
    \item строка
    \item столбец
    \item слой
\end{enumerate}
Запись: $\left(\begin{array}{cc|cc|cc}
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot\\
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot
\end{array}\right)$\\
Для четырехмерных матриц:
\begin{enumerate}
    \item строка
    \item столбец
    \item слой
    \item срез
\end{enumerate}
Запись: $\left(\begin{array}{cc|cc|cc}
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot\\
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot\\
    \hline\\
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot\\
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot\\
    \hline\\
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot\\
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot
\end{array}\right)$\\
//todo 11:59 30.03\\
$\fall \xi \in V\ \xi = \xi^i e_i = \xi^{ij}e^i_j$\\
$\xi^i = t^i_j \xi'^j$\\
$\fall \eta \in V^*\ \eta=\eta_i \omega^i =n'_j \omega'^j$\\
$\eta_i = s_i^j \eta'_j$\\
$\fall \xi_1, \ldots, \xi_p \in V, \eta^1,\ldots,\eta^q \in V^* f(\xi_1, \ldots, \xi_p, \eta^1, \ldotp, \eta^q) = \alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} \xi_1^{j_1}\cdot \ldots \cdot \xi_p^{j_p} \eta_{i_1}^1\cdot\ldots\cdot \eta_{i_q}^q = \alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} t_{u_1}^{j_1}\xi_1'^{u_1} \cdot \ldots \cdot t_{u_p}^{j_p}\xi_p'^{u_p} \cdot s_{i_1}^{r_1}\eta'^1_{r_1} \cdot \ldots\cdot s_{i_q}^{r_q}\eta'^1_{r_q}$\\
$\alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} t_{u_1}^{j_1}\cdot\ldots\cdot t_{u_p}^{j_p} s_{i_1}^{r_1} \cdot \ldots \cdot s_{i_q}^{r_q} = \alpha'^{r_1, \ldots, r_q}_{u_1, \ldotp, u_p}$\\
$f('e_{u_1}, \ldots, e'_{u_p}, \omega'^{r_1},\ldots, \omega'^{r_q}) = \alpha'^{r_1, \ldots, r_q}_{u_1, \ldotp, u_p}$\\
Нижние индексы -- ковариантные, т.к. при смене базиса соответствующая координата пересчитывается по ковариантному закону (т.е. через $T$)\\
Верхние индексы -- контрвариантные\\
\textbf{Пример}\\
$\fall x \in V \cong V^{**}, x$ -- линейное отображение\\
$x \lrto \begin{pmatrix}
    \alpha^1\\\vdots\\\alpha^n
\end{pmatrix} = \alpha, x \in T_{(0,1)}$\\
$\alpha'^r = \alpha^i s^r_i$\\
$\alpha' = S\alpha \Rto \alpha=T\alpha'$\\
$\fall f \in V^*, f$ -- линейное отображение\\
$f \lrto a=\begin{pmatrix}
    a_1 & \ldots & a_n
\end{pmatrix}, f \in T_{(0,1)}$\\
$a'_u = a_j t_u^j$\\
$a' = aT \Rto a=a'S$\\
\textbf{Определение 2}\\
Геометрический объект на линейном пространстве $V$ над полем $K$, описываемый $p+q$-мерной матрицей размерности $n(т = \dim V)$ с элементами из поля $K$, которая при смене пространства $V$ пересчитывается по формуле $\alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} t_{u_1}^{j_1}\cdot\ldots\cdot t_{u_p}^{j_p} s_{i_1}^{r_1} \cdot \ldots \cdot s_{i_q}^{r_q} = \alpha'^{r_1, \ldots, r_q}_{u_1, \ldotp, u_p}$, где $(t_j^i) = T_{e\rto e'}, S = T^{-1}$, называется тензором типа $(p,q)$ или $p$ раз ковариантным и $q$ раз контрвариантным\\\\
Пусть $\0$ -- нулевая матрица, $-\alpha$ -- противоположная матрица, задано умножение на скаляр и сложение\\
Докажем, что $+$ и $\lambda \cdot$ сохраняют свойство тензоров\\
$\alpha, \beta \in T_{(p,q)}, \fall \lambda \in K$\\
$(\alpha + \lambda \beta)_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} = \alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} + \lambda\beta_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} $\\
$(\alpha + \lambda\beta)'^{r_1, \ldots, r_q}_{u_1, \ldotp, u_p} = (\alpha + \lambda \beta)_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} t_{u_1}^{j_1}\ldots t_{u_p}^{j_p}s_{i_1}^{r_1}\ldots s_{u_q}^{r_q} = \alpha'^{r_1, \ldots, r_q}_{u_1, \ldotp, u_p} + \lambda\beta'^{r_1, \ldots, r_q}_{u_1, \ldotp, u_p}$ -- верно
\subsection{Произведение тензоров. Базис пространства тензоров. Свойства тензоров}
\textbf{Определение}\\
$\alpha \in T_{(p_1, q_1)}$\\
$\beta \in T_{(p_2, q_2)}$\\
$\gamma = \alpha \otimes \beta \in T_{(p_1+q_1, p_2+q_2)}$\\
$\gamma_{j_1,\ldots,j_{p_1},m_1, \ldots, m_{p_2}}^{i_1,\ldots, i_{q_1},k_1,\ldots,k_{q_2}} = \alpha_{j_1, \ldotp, j_{p_1}}^{i_1, \ldots, i_{q_1}}\beta_{m_1, \ldotp, m_{p_2}}^{k_1, \ldots, k_{q_2}}$\\
\textbf{Доказательство корректности произведения}\\
$\gamma'^{r_1 \ldots r_{q_1} \sigma_1 \ldots \sigma_{q_2}}_{u_1\ldots u_{p_1}v_1\ldots v_{p_2}} = \gamma_{j_1,\ldots,j_{p_1},m_1, \ldots, m_{p_2}}^{i_1,\ldots, i_{q_1},k_1,\ldots,k_{q_2}} t_{u_1}^{j_1}\ldots t_{v_{p_2}}^{m_{p_2}} s_{i_1}^{r_1}\ldots s_{k_{q_2}}^{\sigma_{q_2}}$\\
$ = \alpha_{j_1, \ldotp, j_{p_1}}^{i_1, \ldots, i_{q_1}}t_{u_1}^{j_1}\ldots t_{u_{p_1}}^{j_{p_1}}s_{i_1}^{r_1}\ldots s_{r_{q_1}}^{r_{q_1}}\beta_{m_1, \ldotp, m_{p_2}}^{k_1, \ldots, k_{q_2}}t_{v_1}^{m_1}\ldots t_{v_{p_2}}^{m_{p_2}}s_{k_1}^{\sigma_1}\ldots s_{k_{q_2}}^{\sigma_{q_2}}$\\
$ = \alpha'^{r_1, \ldots, r_{q_1}}_{u_1, \ldotp, u_{p_1}}\beta'^{\sigma_1, \ldots, \sigma_{q_2}}_{v_1, \ldotp, v_{p_2}}$\\
\textbf{Замечание}
\begin{enumerate}
    \item $\lambda \in K \lrto \lambda \in T_{(0,0)}$\\
    $\fall \alpha \in T_{(p,q)}\ \lambda \otimes \alpha = \lambda\alpha$
    \item $\oplus$ ассоциативно, не коммутативно, дистрибутивно по сложению
\end{enumerate}
$\alpha \in T_{(p_1, q_1)} \us{e_1, \ldots, e_n}\lrto f: V^{p_1}\times (V^*)^{q_1} \rto K$ -- полилинейная\\
$\beta \in T_{(p_2, q_2)} \us{e_1, \ldots, e_n}\lrto f: V^{p_2}\times (V^*)^{q_2} \rto K$ -- полилинейная\\
Тогда $\gamma = \alpha \otimes \beta \in T_{(p_1 + p_2, q_1 + q_2)} \lrto t: V^{p_1+p_2}\otimes (V^*)^{q_1+q_2} \rto R$\\
$\fall \xi_1, \ldots, \xi_{p_1}, \zeta_1,\ldots, \zeta_{p_2} \in V$\\
$\fall \eta^1,\ldots, \eta^{q_1}, \theta^1,\ldots, \theta^{q_2} \in V^*$\\
$t(\xi_1, \ldots, \xi_{p_1}, \zeta_1,\ldots, \zeta_{p_2}, \eta^1,\ldots, \eta^{q_1}, \theta^1,\ldots, \theta^{q_2})$\\
$ = \gamma_{j_1,\ldots,j_{p_1},m_1, \ldots, m_{p_2}}^{i_1,\ldots, i_{q_1},k_1,\ldots,k_{q_2}} \xi_1^{j_1}\ldots \xi_{p_1}^{j_{p_1}}\zeta_1^{m_1}\ldots \zeta_{p_2}^{m_p}\eta_{i_1}\ldots \eta_{i_{q_1}}^{q_1}\theta_{k_1}^1\ldots k_{q_2}^{q_2}$\\
$=\alpha_{j_1, \ldotp, j_{p_1}}^{i_1, \ldots, i_{q_1}}\xi_1^{j_1}\ldots \xi_{p_1}^{j_{p_1}}\eta_{i_1}\ldots \eta_{i_{q_1}}^{q_1}\beta_{m_1, \ldotp, m_{p_2}}^{k_1, \ldots, k_{q_2}}\zeta_1^{m_1}\ldots \zeta_{p_2}^{m_p}\theta_{k_1}^1\ldots k_{q_2}^{q_2}$\\
$= f(\xi_1, \ldots, \xi_{p_1},\eta^1,\ldots, \eta^{q_1})g(\zeta_1,\ldots, \zeta_{p_2}, \theta^1,\ldots, \theta^{q_2})$\\
Отсюда $\gamma = \alpha \otimes \beta \lrto t=fg$\\
В частности:\\
$\fall f^1,\ldots,f^p \in V^*, g_1, \ldots, g_q \in V\ f^1 \otimes \ldots \otimes f^p \otimes g_1 \otimes \ldots \otimes g_q(\xi_1,\ldots,\xi_p, \eta^1,\ldots,\eta^q) = f^1(\eta_1)\ldots f^p(\eta_p)g_1(\eta^n)\ldots g_q(\eta^q)$\\\\
Пусть $e_1, \ldots, e_n$ -- базис $V$\\
$\omega^1, \ldots, \omega^n$ -- базис $V^*$\\
$\omega^{j_1}\otimes \ldots \otimes \omega^{j_p} \otimes e_{i_1}\otimes\ldots \otimes e_{i_q} (\xi_1,\ldots, \xi_p, \eta^1,\ldots, \eta^q) = \xi_1{j_1},\ldots, \xi_p^{j_p}, \eta^1_{i_1},\ldots, \eta^q_{i_q}$\\
\textbf{Теорема о базисе пространства тензоров}\\
Набор тензоров $\omega^{j_1}\otimes \ldots \otimes \omega^{j_p} \otimes e_{i_1} \otimes \ldots \otimes e_{i_q}$ по всем возможным $i, j$ -- базис $T_{(p,q)}$\\
\textbf{Доказательство}\\
$\omega^j \in T_{(1,0)}, e_i \in T_{(0,1)}$\\
$\{\omega^{j_1}\otimes \ldots \otimes \omega^{j_p} \otimes e_{i_1} \otimes \ldots \otimes e_{i_q}\}$ -- набор из $n^{p+q}$\\
Система порождающая:\\
$\fall \xi_1, \ldots, \xi_p \in V$\\
$\fall \eta^1,\ldots,\eta^q \in V^*$\\
$\fall f \in T_{(p,q)}\ f(\xi_1,\ldots,\xi_p,\eta^1,\ldots,\eta^q) = \alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} \ub{\omega^{j_1}\otimes \ldots \otimes \omega^{j_p} \otimes e_{i_1} \otimes \ldots \otimes e_{i_q}(\xi_1,\ldots,\xi_p,\eta^1,\ldots,\eta^q)}{\xi_1^{j_1}\ldots \xi_p^{j_p} \eta_{i_1}^1\ldots\eta_{i_q}^q}$\\ 
Отсюда $f = \ub{\text{в будущем: координата}}{\alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q}} \omega^{j_1}\otimes \ldots \otimes \omega^{j_p} \otimes e_{i_1} \otimes \ldots \otimes e_{i_q}$\\
Система линейно независимая\\
Рассмотрим $\alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q}\omega^{j_1}\otimes \ldots \otimes \omega^{j_p} \otimes e_{i_1} \otimes \ldots \otimes e_{i_q}$\\
Применим к $e_{u_1},\ldots, e_{u_p} \in V, \omega^{r_1},\ldots, \omega^{r_q} \in V^*$\\
$\alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q}\ub{\delta_{u_1}^{j_1}\ldots\delta_{u_p}^{j_p}\delta_{i_1}^{r_1}\ldots\delta_{i_q}^{r_q}}{\omega^{j_1}\otimes \ldots \otimes \omega^{j_p} \otimes e_{i_1} \otimes \ldots \otimes e_{i_q} (e_{u_1},\ldots, e_{u_p},\omega^{r_1},\ldots, \omega^{r_q})} = \0$\\
Отсюда $\alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} = 0$\\
Тогда все $\alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q}$ нули $\Rto$ линейно независимые\\
\textbf{Следствие}\\
$\dim T_{(p,q)} = n^{p+q}$\\
\textbf{Замечание}\\
//todo 14:20 30.03\\
\textbf{Определение}\\
Пусть $\alpha \in T(p,q), p,q \neq 0$\\
Тензор $\beta \in T_{p-1, q-1}$ называется сверткой тензора $\alpha$, если\\
$\beta^{i_1, \ldots, \hat{i_k},\ldots, i_q}_{j_1, \ldots \hat{j_m} \ldots j_p} := \sum_{\kappa}\alpha^{i_1, \ldots, \us{\text{k-ая позиция}}\kappa \ldots i_q}_{j_1, \ldots \us{\text{m-ая позиция}}\kappa \ldots j_p}$, где $\hat{i_k}$ -- отсутствие $i_k$\\
\textbf{Доказательство корректности определения}\\
$\beta'^{i_1, \ldots, \hat{i_k},\ldots, i_q}_{j_1, \ldots \hat{j_m} \ldots j_p} = \alpha'^{r_1,\ldots,\kappa,\ldots,r_q}_{u_1,\ldots,\kappa,\ldots u_p} = \alpha'^{r_1,\ldots,i_k,\ldots,r_q}_{u_1,\ldots,j_m,\ldots u_p}t_{u_1}^{j_1}\ldots t_\kappa^{j_m} \ldots t_{u_p}^{j_m} s_{i_1}^{r_1}\ldots s_{i_k}^\kappa\ldots s_{i_q}^{r_q}$\\
$t_\kappa^{j_m}s_{i_k}^\kappa = \delta_{i_k}^{j_m}$\\
$\beta'^{i_1, \ldots, \hat{i_k},\ldots, i_q}_{j_1, \ldots \hat{j_m} \ldots j_p} = \ub{\beta^{i_1, \ldots, \hat{i_k},\ldots, i_q}_{j_1, \ldots \hat{j_m} \ldots j_p}}{\alpha'^{r_1,\ldots,\omega,\ldots,r_q}_{u_1,\ldots,\omega,\ldots u_p}}t_{u_1}^{j_1}\ldots \hat{t_\kappa^{j_m}} \ldots t_{u_p}^{j_m} s_{i_1}^{r_1}\ldots \hat{s_{i_k}^\kappa}\ldots s_{i_q}^{r_q}$\\
Свертка может быть по нескольким парам индексов\\
Если в результате свертки получится тензор (0,0), т.е. число, то свертка \textit{полная}\\
\end{document}