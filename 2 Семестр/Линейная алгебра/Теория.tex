\documentclass[12pt]{article}
\input{../../header.tex}
\title{Линейная алгебра. Теория}
\author{Александр Сергеев}
\date{}

\begin{document}
\maketitle
\section{Линейное отображение}
\subsection{Основные определения. Теорема о ранге и дефекте линейного отображения}
Пусть $V, U$ - линейные пространства над полем $K(\Rset, \Cset)$\\
\textbf{Определение}\\
$\mcA: U \rto V$ -- \textit{линейное отображение}, если $\fall \lambda\ \in K, u_1, u_2 \in U\ \mcA(\lambda u_1 + u_2) = \lambda \mcA(u_1) + \mcA(u_2)$\\
\textbf{Замечания}
\begin{enumerate}
    \item Обозначение: $\mcA(u) = \mcA u$
    \item $\mcA(\0_U) = \0_V$
    \item Для $\mcA, \mcB, \lambda, u$ поточечно определены $\mcA u+\mcB u, \lambda \mcA u$
\end{enumerate}
\textbf{Примеры}
\begin{enumerate}
    \item $\0 u = \0_V$
    \item $\epsilon v = v$
    \item $V, U = P_n$ -- множество многочленов степени $\leq n, A = \frac{\df}{\df t}$ -- дифференциальный оператор
    \item $U = \Rset^n, V = \Rset^m, B$ -- матрица\\
    $\mcA u = B\cdot u$
\end{enumerate}
\textbf{Определение}\\
$L(U, V) = \nm{Hom}_K(U, V) = \nm{Hom}(U, V)$ -- множество всех линейных отображений $U \rto V$\\
Определим операции\\
$\mcC = \mcA + \mcB \Leftrightarrow \mcC u=(\mcA+\mcB)u = \mcA u+\mcB u$\\
$\mcC = \lambda \mcA \Leftrightarrow \mcC u=(\lambda \mcA)u = \lambda \mcA u$\\
$L(U,V)$ -- линейное пространство\\\\
\textbf{Определение}\\
$\im \mcA = \{ v = \mcA u: u\in U\}$ -- образ линейного отображения\\
\textbf{Замечание}\\
$\im \mcA \subset V$ -- линейное подпространство\\
Если $\im \mcA$ -- конечномерное, то $\dim \im \mcA =: \rg \mcA$\\
\textbf{Определение}\\
$\ker \mcA = \{u \in U: \mcA u=\0_V\}$ -- ядро линейного отображения (прообраз $\0_V$)\\
\textbf{Замечание}\\
$\ker \mcA \neq \varnothing$\\
$\0_U \in \ker \mcA$\\
$\ker \mcA \subset U$ -- линейное подпространство\\
Если $\ker \mcA$ конечномерно, то $\dim \ker \mcA = \Def \mcA$\\\
\textbf{Замечание 2}\\
Изоморфизм -- частный случай линейного отображения\\
$\mcA$ - изоморфизм $\LRto \left\{\begin{array}{l}
     \mcA \in L(U, V)\\
     \im \mcA = V\\
     \ker \mcA = \0_U\text{(тривиально)}
\end{array}\right.$\\
\textbf{Следствие}\\
 Если $U, V$ -- конечномерные\\
 $\mcA$ - изоморфизм $\LRto \left\{\begin{array}{l}
     \mcA \in L(U, V)\\
     \rg \mcA = \dim V\\
     \Def \mcA = 0
     \end{array}\right.$\\
\textbf{Определение}\\
$\mcA \in L(U, V)$
\begin{itemize}
    \item $\mcA$ сюръективное $\LRto \im \mcA = V$
    \item $\mcA$ инъективное $\LRto \ker \mcA = \{ \0_U \}$
    \item $\mcA$ биективно $\LRto$ сюръективно + инъективно $\LRto$ изоморфизм
    \item $\mcA$ эндоморфизм $\LRto$ линейный оператор $\LRto \mcA \in L(V, V) \LRto \mcA \in \nm{End}_K(V)$
    \item $\mcA$ автоморфизм $\LRto$ эндоморфизм + изоморфизм $\LRto \mcA \in \nm{Aut}_K(V)$
\end{itemize}
\textbf{Примеры}
\begin{enumerate}
    \item $\0 \in L(U, V)$
    \item $\epsilon \in \nm{Aut}(V)$ -- автоморфизм
    \item $\mcA=\frac{\df}{\df t}$\\
    $\mcA \in L(P_n, P_{n-1})$ -- сюръекция, не инъекция, не эндоморфизм\\
    $\mcA \in L(P_n, P_n)$ -- не сюръекция, не инъекция, эндоморфизм
    \item $U=\Rset^n, V=\Rset^m, A_{m \times n}$ -- матрица\\
    \textbf{Определение}\\
    $\im A = \{ y = Ax \in \Rset^m: x \in \Rset^n \}$ -- образ матрицы\\
    $\ker A = \{ x \in \Rset^n: Ax = \0 \}$ -- ядро матрицы\\
    $\Def A = \dim \ker A$ -- дефект матрицы\\
    $\rg A = \dim \im A$ -- согласуется со старыми определениями ранга матрицы\\
    \textbf{Доказательство}\\
    Для $y \in \im A$\\
    $y = Ax = x_1 A_1 + \ldots + x_n A_n$\\
    $\im A = \span(A_1, \ldots, A_n)$\\
    $\dim \im A = \rg A$\\
    \textbf{Утверждение}\\
    $\ker A$ - множество решений $Ax = 0$\\
    Тогда $\Def A = \dim \ker(A) = n - \rg A $\\\\
    Отображение $u = Av$:
    \begin{enumerate}
        \item Сюръекция $\LRto \rg A = m$
        \item Инъекция $\LRto \rg A = n$
        \item Биекция $\LRto n = m = \rg A$
        \item Эндоморфизм $\LRto n = m$
        \item Автоморфизм $n = m = \rg A$
    \end{enumerate}
\end{enumerate}
\textbf{Определение}\\
$\mcA\mcB = \mcA \circ \mcB$ -- композиция\\
$\mcA \circ \mcB$ -- линейное отображение\\
\textbf{Свойства}
\begin{enumerate}
    \item $(\mcA_1 + \mcA_2)\mcB = \mcA_1\mcB + \mcA_2\mcB$\\
    $\mcA(\mcB_1 + \mcB_2) = \mcA\mcB_1 + \mcA\mcB_2$ -- дистрибутивность
    \item $(\lambda \mcA)\mcB = \lambda (\mcA \mcB) = \mcA (\lambda \mcB)$ -- однородность
    \item $(\mcA \mcB) \mcC = \mcA(\mcB\mcC) = \mcA\mcB\mcC$ -- ассоциативность
    \item $\mcA, \mcB$ -- изоморфизм $\Rto \mcA\mcB$ -- изоморфизм
\end{enumerate}
\textbf{Определение}\\
Пусть $\mcA \in L(U, V)$ -- изоморфизм\\
$\fall v \in V\ \ex! u:\ \mcA u = v$\\
Тогда зададим $\mcA^{-1} v = u$\\
$\mcA^{-1}: V \rto U$\\
$\mcA^{-1}$ -- изоморфизм, обратный к $\mcA$\\
$\mcA\mcA^{-1} = \epsilon_V$\\
$\mcA^{-1}\mcA = \epsilon_U$\\
\textbf{Замечание}\\
$\nm{End}(V)$ - ассициативная унитарная алгебра\\
$\nm{Aut}(V)$ - ассоциативная унитарная алгебра с делением\\
\textbf{Определение}\\
$\mcA \in L(U, V), U_0 \subset U$ -- линейное подпространство\\
Тогда $\mcA_0 : U_0 \rto V$ называется сужением на линейное подпространство $U_0$, если $\fall u \in U_0\ \mcA_0u = \mcA u$\\
Очевидно $\mcA_0 \in L(U_0, V)$\\
$A_0 =: A|_{U_0}$\\
\textbf{Утверждение}\\
$A$ изоморфизм $\Rto A_0 $ изоморфизм $\in L(U_0, \im \mcA_0)$\\
\textbf{Доказательство}\\
$\mcA_0: U_0 \rto \im \mcA_0$ -- сюръекция\\
$\ker \mcA_0 \subset \ker \mcA = \{ \0_U \}$ -- из изоморфизма\\
Отсюда $\ker \mcA_0 = \{ \0_U\}$\\
Тогда $\mcA_0$ инъекция, а значит изоморфизм\\
\textbf{Теорема о ранге и дефекте линейного отображения}\\
$U, V$ -- конечномерные\\
$A \in L(U, V)$\\
Тогда $\dim U = \rg A + \Def A$\\
\textbf{Доказательство}\\
$U_0 = \ker A \subset U$\\
Дополним $U_0$ до $U$:
$U = U_0 \oplus U_1$\\
Пусть $\mcA_1 = \mcA|_{U_1}: U_1 \rto \im \mcA_1$\\
$\fall u \in U\ u=u_0 + u_1, u_0 \in U_0, u_1 \in U_1$ -- единственным образом\\ 
$\mcA u = \mcA u_0 + \mcA u_1 = \mcA u_1$\\
Отсюда $\im \mcA = \im \mcA_1 \Rto \dim \im \mcA = \dim \im \mcA_1 \Rto \rg \mcA = \dim \im \mcA_1$\\
Покажем, что $\mcA_1$ изоморфизм:\\
Сюръекция, т.к. действует в $\im \mcA_1$\\
$\ker \mcA_1 \subset \ker \mcA = U_0, \ker \mcA_1 \subset U_1$\\
Отсюда $\ker \mcA_1 \subset U_0 \cap U_1 = \{ \0_U\}$ из дизъюнктности\\
Тогда $\ker \mcA_1 = \{ \0_U \}$ -- тривиально\\
Тогда $\mcA_1$ инъективно\\
Отсюда $\mcA_1$ изоморфизм, т.е. $\dim U_1 = \dim \im \mcA_1 = \rg \mcA$\\
Тогда $\dim U = \dim U_0 + \dim U_1 = \Def A + \rg A$, ч.т.д.
\subsection{Матрица линейного отображения, изоморфизм алгебр изменение матрицы отображения при замене базиса}
\underline{Далее будем говорить про конечномерные $U, V$}\\
\textbf{Определение}\\
$\mcA \in L(U, V)$\\
$\xi_1, \ldots, \xi_n$ -- базис $U$\\
$\nu_1, \ldots, \nu_m$ -- базис $V$\\
$\fall u \in U\ u = \sum_{i = 1}^n u_i \xi_i \lrto u = \begin{pmatrix}
u_1\\u_2\\\vdots\\u_n
\end{pmatrix}$\\
$\fall v \in V\ v = \sum_{i = 1}^m v_i \nu_i \lrto v = \begin{pmatrix}
v_1\\v_2\\\vdots\\v_m
\end{pmatrix}$\\
$\fall v \in \im \mcA\ v = \mcA u = \sum_{i=1}^n u_i \mcA \xi_i$\\
$\mcA$, как линейное отображение, полностью определяется значениями $\mcA$ на базисных векторах\\
$\mcA_{\xi_i} = \sum_{j=1}^m a_{ji} \nu_j \lrto \begin{pmatrix}
    a_{1i}\\\vdots\\a_{mi}
\end{pmatrix}$\\
$A = (A_1 \ldots A_n)$ - матрица линейного отображения в базисах $(\xi, \nu)$\\\\
\underline{Если $\mcA \in \nm{End}(v)$ -- линейный оператор, то считаем, что исходный и конечный базис совпадают}\\
$v = \sum_{j=1}^m v_j \nu_j$\\
$v = \mcA u = \sum_{i = 1}^n u_i \mcA_{\xi_i} = \sum_{i=1}^n u_i\sum_{j=1}^m a_{ji}\nu_j = \sum_{j=1}^m(\sum_{i=1}^n a_{ji}u_i)\nu_j$\\
Т.к. координаты введены единственным образом, то $\fall j\ v_j = \sum_{i=1}^n a_{ji}u_i \LRto v = \mcA u \LRto v = Au$\\
\textbf{Примеры}
\begin{enumerate}
    \item $\epsilon: \underset{e_1\ldots e_n}V \rto \underset{e_1 \ldots e_n}V$\\
    Тогда $\epsilon \lrto E$
    \item $\epsilon: \underset{\xi_1\ldots \xi_n}V \rto \underset{\nu_1 \ldots \nu_n}V$\\
    Тогда $\epsilon \lrto T_{\nu \rto \xi} = T_{e\rto e'}$
\end{enumerate}
\textbf{Утверждение}\\
$L(U, V) \cong M_{m\times n}$ -- пространство всех матриц $A_{m\times n}, \dim U = n, \dim V = m$\\
(при фиксированных базисах $U, V$)\\
\textbf{Доказательство}\\
Соответствие между $\mcA$ и $A$ взаимооднозначное\\
Докажем линейность\\
$(\mcA+\lambda \mcB)_{\xi_i} = \mcA_{\xi_i}+\lambda\mcB_{\xi_i} = \sum_{j=1}^m a_{ji}\nu_j + \lambda \sum_{j=1}^m b_{ji}\nu_j = \sum_{j=1}^m(a_{ji} + \lambda b_{ji})\nu_j \lrto A+\lambda B$\\\\
\textbf{Утверждение}\\
$\mcA\mcB \lrto AB$\\
\textbf{Доказательство}\\
$\underset{\xi_1\ldots\xi_n}{U}\xrto[\mcB]{} \underset{\theta_1\ldots\theta_r}{W} \xrto[\mcA]{} \underset{\nu_1\ldots\nu_m}{V}$
$(\mcA\mcB)_{\xi_i} = \mcA(\mcB_{\xi_i}) = \mcA(\sum_{k=1}^r b_{ki}\theta_k) = \sum_{k=1}^r b_{ki}\mcA_{\theta_k} = \sum_{k=1}^rb_{ki}\sum_{j=1}^m a_{jk}\nu_j = \sum_{j=1}^m(\sum_{k=1}^r a_{jk}b_{ki})\nu_i = \sum_{j=1}^m AB_{ji} \nu_j \lrto \begin{pmatrix}
    \vdots
\end{pmatrix}$\\
\textbf{Утверждение}\\
Пусть $\mcA \in \nm{Aut}(V)$\\
(В одном базисе)\\
$\mcA^{-1} \lrto A^{-1}$\\
\textbf{Доказательство}\\
Пусть $\mcA^{-1} \lrto B$\\
$\mcA\mcA^{-1} = \epsilon \lrto AB = E$\\
Отсюда $B = A^{-1}$\\
\textbf{Утверждение}\\
$A$ изоморфно $\Rto A_0$ изоморфно\\
\textbf{Доказательство}\\
$A_0: U_0 \rto \im \mcA_0$ -- сюръекция\\
$\ker A_0 \subset \ker A = \{\0_U\}$\\
Отсюда $\ker A_0 = \{\0_U\}$\\
Отсюда $A_0$ - инъективно, а значит изоморфизм\\
\textbf{Теорема о связи матриц линейных отображений в разных базисах}\\
$\mcA \in L(U, V)$\\
$\mcA: \underset{\xi}{U} \rto \underset{\nu}{V} \lrto A$\\
$\mcA: \underset{\xi'}{U} \rto \underset{\nu'}{V} \lrto A'$\\
$T_{\xi \rto \xi'} T_{\nu \rto \nu'}$ -- матрицы перехода\\
Тогда $A' = T_{\nu' \rto \nu} A T_{\xi \rto \xi'}$\\
\textbf{Доказательство}\\
Пусть $\xi_U: \underset{\xi'}{U} \rto \underset{\xi}{U},\\
\xi_V: \underset{\nu}{V} \rto \underset{\nu'}{V}$\\
$\mcA = \xi_v \mcA \xi_u$\\
$A' = T_{\nu'\rto \nu}AT_{\xi \rto \xi'}$\\
\textbf{Следствие}\\
$\mcA \in \nm{End}(V)$\\
$\mcA: \underset{e}{V}\rto\underset{e}{V} \lrto A$\\
$\mcA: \underset{e'}{V}\rto\underset{e'}{V} \lrto A'$\\
$A'=T_{e'\rto e}AT_{e\rto e'}$\\
\textbf{Определение}\\
Матрицы $A_{n\times n},B_{n \times n}$ \textit{подобны}, если $\ex C$ невырожденная$: A=C^{-1}BC$\\
$A$ и $A'$ -- матрицы одного и того же оператора в разных базисах -- подобны\\
\textbf{Утверждение}\\
$\mcA \in L(U, V) \lrto A$\\
Тогда $\ker \mcA \lrto \ker A$\\
$\im \mcA \lrto \im A$\\
\textbf{Доказательство}\\
$\im \mcA = \span(\mcA_{\xi_1},\ldots, \mcA_{\xi_n}) \lrto \span(A_1, \ldots, A_n) = \im A$\\
$\ker \mcA = \{ u\in U: \mcA = 0\}$\\
$\mcA u = 0 \lrto Au = 0$\\
Тогда $\ker \mcA = \ker A$
\subsection{Инвариантность линейного отображения}
\textbf{Определение}\\
Инвариантностью/инвариантном называется свойство, которое не меняется при определенного рода преобразованиях\\
\textbf{Теорема 1}\\
$\mcA \in L(U, V)$\\
$\rg A$ и $\Def A$, где $A \lrto \mcA$, не зависят от выбора базиса, т.е. являются инвариантами относительно выбора базиса\\
\textbf{Доказательство}\\
$\mcA: \us\xi U \rto \us\nu V \lrto A$\\
$\im \mcA = \span(\mcA_{\xi_1},\ldots,\mcA_{\xi_n}) \lrto \span(A_1, \ldots, A_n), \mcA_{\xi_i} \lrto A_i$\\\\
$\rg \mcA = \dim \im \mcA = \dim \span(A_1, \ldots, A_n) = \rg A$\\
$\rg \mcA + \Def \mcA = n = \rg A + \Def A \Rto \Def \mcA = \Def A$\\
\textbf{Следствие}\\
$\mcA$ изоморфизм $\LRto \ex A^{-1}$, где $A \lrto \mcA$\\\\
\textbf{Определение}\\
$\mcA \in \nm{End}(V)$\\
$e_1,\ldots, e_n$ -- базис $V$\\
Тогда $\det \mcA := \det(\mcA e_1, \ldots, \mcA e_n)$ -- определитель системы векторов в базисе $e_1, \ldots, e_n$\\
\textbf{Теорема 2}\\
Значение $\det \mcA$ не зависит от выбора базиса $e_1, \ldots, e_n$ (т.е. является инвариантом), причем $\det \mcA = \det A$, где $A$ -- матрица оператора в некотором базисе\\
\textbf{Доказательство}\\
Выберем базис $e_1, \ldots, e_n$\\
Тогда $\mcA \us{e}\lrto A_{n\times n}$\\
$\det \mcA = \det (\mcA e_1, \ldots, \mcA e_n) = \det(\sum_{i_1=1}^n a_{i_11}e_{i_1}, \ldots, \sum_{i_n=1}^n a_{i_nn}e_{i_n}) =\\ \sum_{i_1=1}^n\ldots\sum_{i_n=1}^n a_{i_11}\ldots a_{i_nn}\det(e_{i_1}, \ldots, e_{i_n}) = \sum_{\sigma \in S_n}(-1)^{\inv(\sigma)}a_{i_11}\ldots a_{i_nn}\det(e_1,\ldots, e_n) = \sum_{\sigma \in S_n}(-1)^{\inv(\sigma)}a_{i_11}\ldots a_{i_nn} = \det A$\\
Т.о. в нашем базисе это верно\\
Теперь докажем, что в $e_1', \ldots e_n'$ -- базисе $V$ -- это тоже верно\\
$\mcA \us{e'}\lrto A'$\\
$\det \mcA = \det A'$\\
$T=T_{e\rto e'}$\\
$A' = T^{-1}AT$\\
Тогда $\det A' = \det(T^{-1}AT) = \det T^{-1}\det A\det T = \det A$\\
\textbf{Следствие}\\
$\fall f$ -- n-форма на $V$\\
$\fall \xi_1, \ldots, \xi_n \in V\ f(\mcA \xi_1, \ldots, \mcA \xi_n) = \det \mcA f(\xi_1, \ldots, \xi_n)$\\
\textbf{Доказательство}\\
$g(\xi_1, \ldots, \xi_n):=f(\mcA \xi_1, \ldots, \mcA \xi_n)$\\
$g$ -- n-форма, т.к. f -- n-форма\\
$g(\xi_1, \ldots, \xi_n) = g(e_1, \ldots, e_n)\det(\xi_1, \ldots, \xi_n)$\\
$g(\xi_1, \ldots, \xi_n)=f(\mcA \xi_1, \ldots, \mcA \xi_n) = \det A f(e_1, \ldots, e_n)$ (см. доказательство теоремы)\\
$g(\xi_1, \ldots, \xi_n) = g(e_1, \ldots, e_n)\det(\xi_1, \ldots, \xi_n) = \det \mcA f(e_1, \ldots, e_n)\det(\xi_1,\ldots,\xi_n) = \det \mcA f(\xi_1, \ldots, \xi_n)$\\
\textbf{Следствие 2}\\
$\mcA, \mcB \in \nm{End}(V) \Rto \det(\mcA\mcB) = \det\mcA\det\mcB$\\
\textbf{Следствие 3}\\
$\mcA \in \nm{Aut}(V) \lrto \det \mcA \neq 0$\\
Причем $\det \mcA^{-1} = \frac{1}{\det \mcA}$\\
$\det \mcA^{-1} = \det A^{-1}$\\
\textbf{Доказательство}\\
$\mcA \in \nm{Aut}(V) \LRto \ex \mcA^{-1} \in \nm{Aut}(V)$\\
$\mcA\mcA^{-1} = \epsilon$\\
$\det \mcA\mcA^{-1} = \det\mcA\det \mcA^{-1} = \det \epsilon = 1$\\\\
\textbf{Примеры}
\begin{enumerate}
    \item В $V_3$\\
    $f(a,b,c) = (a, b, c) =$ ориентированный объем $= \det(a,b,c)$\\
    $\mcA: V_3 \rto V_3$\\
    $(\mcA a, \mcA b, \mcA c) = \det \mcA \det (a,b,c)$\\
    $\lambda = \det \mcA$ -- коэффициент пропорциональности объемов
    \begin{enumerate}
        \item $\mcA v = \mu v$ -- оператор подобия\\
        Тогда $\lambda = \mu^3$
        \item Поворот\\
        Пусть $i,j,k$ перешли в $e_1, e_2, e_3$ поворотом\\
        Тогда $e_i = \begin{pmatrix}
            \cos \alpha_i\\
            \cos \beta_i\\
            \cos \gamma_i
        \end{pmatrix}$\\
        Тогда $\mcA \us{ijk}\lrto\begin{pmatrix}
            \cos \alpha_1 & \cos \alpha_2 & \cos \alpha_3\\
            \cos \beta_1 & \cos \beta_2 & \cos \beta_3\\
            \cos \gamma_1 & \cos \gamma_2 & \cos \gamma_3
        \end{pmatrix}$ -- матрица поворота\\
        $f(\mcA a, \mcA b, \mcA c) = \det A \det (a,b,c)$\\
        $\det A = (e_1, e_2, e_3) = 1$ -- смешанное произведение\\
        Отсюда при повороте объем сохраняется
    \end{enumerate}
\end{enumerate}
\textbf{Определение}\\
$A_{n\times n}$\\
$\tr A := \sum_{i=1}^n a_{ii}$ -- след матрицы\\
\textbf{Теорема 3}\\
Если матрицы подобные, то $\tr A = \tr B$\\
\textbf{Доказательство}\\
$A, B$ -- подобные $\Rto \ex$ невырожденная $C: A=C^{-1}BC=SBC$\\
$\tr A = \sum_{i=1}^na_{ii}=\sum_{i=1}^n\sum_{k=1}^n S_{ik}(BC)_{ki} = \sum_{i=1}^n\sum_{k=1}^n S_{ik}\sum_{m=1}^nB_{km}C_{ki} = \sum_{m=1}^n\sum_{k=1}^n B_{km}\sum_{i=1}^nC_{mi}S_{ik} = \sum_{m=1}^n\sum_{k=1}^n B_{km} E_{mk} = \sum_{k=1}^n B_{kk} = \tr B$\\
\textbf{Следствие}\\
$A$ и $A'$ матрицы $\mcA \in \nm{End}(V)$ в разных базисах\\
Тогда $\tr A = \tr A'$(из формулы перехода)\\
\textbf{Определение}\\
$\tr \mcA:=\tr A$, где $A$ -- матрица $\mcA$ в некотором базисе (не зависит от выбора базиса)\\\\
\textbf{Определение}\\
$L \subset V, \mcA \in \nm{End}(V)$\\
$L$ называется инвариантным относительно $\mcA$, если $\fall x\in L\ \mcA x \in L$\\
Если $L$ -- линейное подпространство, то говорим об инвариантном линейном подпространстве\\
\textbf{Примеры}
\begin{enumerate}
    \item $\0, V$
    \item $\ker \mcA, \im \mcA$
    \item $\mcA$ -- вращение пространства вокруг оси $l$ на фиксированный угол\\
    Тогда $l, L \perp l$ -- инвариантное пространство ($L$ -- плоскость)\\
    Линейные многообразия $P = x_0 + L$ -- линейные многообразия -- инвариантные пространства (хоть и не линейные пространства)
\end{enumerate}
\textbf{Теорема 4}\\
$L \subset V$ -- инвариантное линейное подпространство относительно $\mcA \in \nm{End}(V)$\\
Тогда $\ex$ базис $V$ такой, что матрица оператора будет иметь в нем ступенчатый вид $A = \begin{pmatrix}
    A^1 & A^2\\
    \0 & A^3
\end{pmatrix}$, где $A^1_{k\times k}, k = \dim L$\\
\textbf{Доказательство}\\
Пусть $L$ -- инвариантное линейное подпространство относительно $\mcA$\\
$\fall x\in L\ \mcA x \in L$\\
Пусть $e_1, \ldots, e_k$ -- базис $L$\\
Дополним его до базиса $V$:\\
$V = \span (e_1, \ldots, e_k, e_{k+1}, \ldots, e_n)$\\
$\mcA e_{j\in 1\ldots k} \in L \Rto \mcA e_j = \sum_{i=1}^k a_{ij}e_i \lrto A_j = \begin{pmatrix}
    a_{1j}\\
    \vdots\\
    a_{k_j}\\
    0\\
    \ldots\\
    0
\end{pmatrix}$\\
Отсюда Видим, что $A$ имеет ожидаемый вид\\
\textbf{Следствие 1}\\
$L_1, L_2 \subset V: L_1\oplus L_2 = V$ -- инвариантные линейные пространства относительно $\mcA \in \nm{End}(V)$\\
Тогда существует базис $V$ такой, что матрица оператора $\mcA$ имеет блочно-диагональный вид\\
$A = \begin{pmatrix}
    A^1 & \0\\
    \0 & A^2
\end{pmatrix}$, где $A^i_{\dim L_i\times \dim L_i}$\\
\textbf{Доказательство}\\
Пусть $e_1, \ldots, e_k$ -- базис $L_1$\\
$e_{k+1}, \ldots, e_n$ -- базис $L_2$\\
Тогда $\mcA e_{j \in 1\ldots k} \in L_1 \lrto \begin{pmatrix}
    A^1_j\\\0
\end{pmatrix}$\\
Тогда $\mcA e_{j \in k+1\ldots n} \in L_2 \lrto \begin{pmatrix}
    \0\\A^2_{j-k}
\end{pmatrix}$\\
\textbf{Следствие 2}\\
$V = \bigoplus_{i=1}^m L_i$\\
$L_i \subset V$ -- инвариантные линейные пространства относительно $\mcA \in \nm{End}(V)$\\
Тогда существует базис $V$ такой, что матрица оператора $\mcA$ имеет блочно-диагональный вид(аналогично предыдущему следствию)\\
Пусть $A|_{L_j}: L_j \rto L_j$ (эндоморфизм)\\
Тогда $\mcA|_{L_j} \lrto A_i$\\
\textbf{Следствие 3}\\
$V = \bigoplus_{i=1}^m L_i$\\
$L_i \subset V$ -- инвариантные линейные пространства относительно $\mcA \in \nm{End}(V)$\\
Тогда $\im \mcA = \bigoplus_{i=1}^m \im (A|_{L_j})$\\
\textbf{Доказательство}\\
$V = \bigoplus_{i=1}^m L_i$\\
$\fall x\in V\ \ex! x_1 \in L_1,\ldots,x_m \in L_m:\ x=\sum_{i=1}^m x_i$\\
$\mcA x = \sum_{i=1}^m \mcA x_i$\\
$\mcA x_i \in \im \mcA_i$\\
Отсюда $\im \mcA = \sum_{i=1}^m \im \mcA_i$\\
Докажем дизъюнктность\\
Пусть $y_i \in \im \mcA_i$\\
Тогда $\ex x_i \in L_i: y_i = \mcA x_i = \mcA_i x_i$\\
$y_1+\ldots+y_m = \0 \LRto \mcA x_1 + \ldots + \mcA x_m = \0$\\
$\mcA x_i \in L_i$, т.к. $L_i$ -- инвариант\\
Т.к. $L_1\ldots L_m$ -- дизъюнктны, то $\mcA x_i = \0$\\
Отсюда $y_i = \0$\\
Отсюда $\im \mcA_i$ дизъюнктны
\subsection{Собственные числа и собственные векторы линейного оператора. Характеристический многочлен. Алгеброическое и геометрическое кратности собственного числа}
$V$ -- линейное пространство над полем $K(\Rset, \Cset)$\\
\textbf{Определение}\\
$\lambda \in K$ -- \textit{собственное число} $\mcA \in \nm{End}(V)$, если $\ex v \neq \0 \in V: \mcA v = \lambda v$\\
$v$ -- собственный вектор $\mcA$, отвечающий собственному числу $\lambda$\\\\
Отсюда  $v$ -- СВ $\LRto$ $(\mcA - \lambda \epsilon)v = \0$\\
$V_\lambda = \ker (\mcA - \lambda\epsilon) = $ (множество всех СВ $\mcA$, отвечающих $\lambda$) $ \cup \{\0\}$ -- собственное подпространство $\mcA$, отвечающее $\lambda$\\
$\gamma(\lambda) := \dim V_\lambda$ -- геометрическая кратность числа $\lambda$\\
$V_\lambda, \gamma_\lambda$ -- инвариантны относительно оператора $\mcA$ и выбора базиса\\
\textbf{Примеры}
\begin{enumerate}
    \item Оператор подобия:\\
    $\fall v\in V\ \mcA v:= \lambda v$\\
    У него $\lambda$ -- собственное число, $V = V_x$\\
    $\mcA \us{e}\lrto \lambda E$
    \item $\mcA$ -- поворот на плоскости относительно начала координат на угол $\alpha \in (-\frac\pi2, \frac\pi2)$
    \item $\lambda = 0$ -- собственное число $\mcA$\\
    $\LRto \ker \mcA \neq \{\0\}$\\
    $\LRto \mcA$ -- не изоморфизм\\
    $\LRto \det \mcA = \0$
    \item $v_1,\ldots,v_n$ -- базис $V$, где $v_j$ -- СВ $\mcA$ для стационарного числа $\lambda_j$\\
\end{enumerate}
Научимся находить СЧ и СВ\\
$\chi_\mcA(t) = \det (A-tE) = (-1)^nt^n+(-1)^{n-1}t^{n-1}\tr A + \ldots + \det A$ -- характеристический могочлен $\mcA(A)$
$\lambda$ -- СЧ $\LRto \chi_\mcA(\lambda) = 0 \land \lambda \in K$\\
Из основной теоремы алгебры $\chi_\mcA(\lambda)$ имеет ровно $n$ корней с учетом кратности (некоторые из которых могут быть комплексными)\\
Если $\lambda_{i \in 1\ldots n}$ -- корни, то $\det A = \lambda_1\lambda_2\ldots\lambda_n$ (т.к. свободный член $\chi$)\\
Т.о. $\det A = 0 \lrto \ex \lambda_i = 0$\\
Также из теоремы Виета $\tr A = \lambda_1 + \ldots + \lambda_n$\\\\
$\chi_\mcA(t) = (-1)^n \prod_\text{$\lambda$ -- корень} (t - \lambda)^{\alpha(\lambda)}$, где $\alpha(\lambda)$ -- алгебраическая кратность СЧ $\lambda$ (кратность корня)\\\\
Рассмотрим пример с поворотом в $\Rset^2$ на $\alpha \in (-\pi, \pi)$\\
Найдем характеристический многочлен:\\
$\chi_\mcA(t) = (\cos \alpha - t)^2 + \sin^2 \alpha = \cos^2 \alpha - 2t\cos \alpha + t^2  + \sin^2 \alpha = t^2 - 2t \cos \alpha + 1$\\
Очевидно, что у данного многочлена нет вещественных корней, а значит нет СЧ и СВ\\
$\det A = 1, \tr A = 2\cos \alpha$\\\\
\textbf{Теорема 1}\\
$\fall \mcA \in \nm{End}(V), \lambda$ -- СЧ $1 \leq \gamma(\lambda) \leq \alpha(\lambda)$\\
\textbf{Доказательство}\\
$1 \leq \gamma(\lambda)$ очевидно, т.к. $\gamma(\lambda) = \dim V_\lambda = \gamma$\\
Пусть $v_1,\ldots,v_\gamma$ -- базис $V_\lambda$\\
$V_\lambda$ -- инвариант относительно $\mcA$\\
Тогда существует базис $V_\lambda$ такой, что $A$ имеет ступенчатый вид $A = \begin{pmatrix}
    A^1 & A^3\\
    \0 & A^2
\end{pmatrix}$\\
Отсюда $\chi_\mcA(t) = \det(A-tE) = |A^1-tE||A^2-tE|=\chi_{A^1}(t)\chi_{A^2}(t)$\\
Пусть $v_1,\ldots,v_\gamma, e_{\gamma+1},\ldots,e_n$ -- наш базис\\
Т.к. $\mcA v_{j\in 1\ldots\gamma} = \lambda v_j$, то $A^1 = \lambda E_{\gamma\times \gamma}$\\
$\chi_{A_1}(t) = (\lambda - t)^\gamma$\\
$\chi_A(t) = (\lambda - t)^\gamma\chi_{A_2}(t) \Rto \alpha(\lambda) \geq \gamma$, т.к. возможо $\lambda$ -- корень $\chi_{A_2}(t)$\\
\textbf{Определение}\\
Набор СЧ $\mcA$ с учетом кратности является спектном оператора $\mcA$\\
Спектр называется простым, если все СЧ попарно различны, т.е. $\fall \lambda$ -- СЧ $\alpha(\lambda) = 1$\\
\textbf{Теорема 2}\\
$\lambda_1, \ldots, \lambda_m$ попарно различные СЧ $\mcA$\\
$v_1, \ldots, v_m$ -- соответствующие СВ\\
Тогда $v_1, \ldots, v_n$ -- линейно независимые\\
\textbf{Доказательство}\\
Методом математической индукции:
\begin{enumerate}
    \item $m = 1$ -- очевидно (т.к. $v_1 \neq \0)$
    \item Пусть верно для $m$\\
    Докажем для $m+1$ от противного\\
    Пусть $\lambda_{m+1} \neq \lambda_{j \in 1\ldots m}, v_{m+1}$ -- соответсвует $\lambda_{m+1}$\\
    Пусть $v_1,\ldots,v_{m+1}$ линейно зависимые\\
    Тогда $v_{m+1} = \sum_{i=1}^m \alpha_i v_i$\\
    //todo
\end{enumerate}
\textbf{Следствие 1}\\
$\lambda_1, \ldots, \lambda_m$ попарно различные СЧ $\mcA$\\
Тогда $V_{\lambda_1}, \ldots, V_{\lambda_m}$ -- дизъюнктные\\
\textbf{Доказательство}\\
$v_1 + \ldots + v_m = \0, v_i \in V_{\lambda_i}$\\
Пусть $v_i \neq \0$. Тогда $v_i$ - СВ для $\lambda_i$ (т.к. $v_i \in V_{\lambda_i}$)\\
Тогда линейная комбинация СВ $=\0$, чего не может быть из теоремы\\
Тогда $v_i = \0$, откуда дизъюнктность\\
\textbf{Следствие 2}\\
Пусть $V = \bigoplus_{\lambda  \text{ -- СЧ}} V_\lambda$\\
$\mcA_\lambda = \mcA|_{V_\lambda} \in \nm{End}(V_\lambda)$\\
Тогда $\chi_\mcA(t) = \prod_{\lambda \text{ -- СЧ}}\chi_{\mcA_\lambda}(t)$\\
\textbf{Доказательство}\\
$V = \bigoplus_{\lambda \text{ -- СЧ}} V_\lambda$\\
$V_\lambda$ -- инвариант относительно $\mcA$\\
Тогда существует базис такой, что $A = \begin{pmatrix}
    A^{\lambda_1} & \ldots & \0\\
    \vdots & \ddots & \vdots\\
    \0 & \ldots & A^{\lambda_m}
\end{pmatrix}$\\
$A^{\lambda_k} \lrto \mcA_{\lambda_k}$\\
$A^{\lambda_k} = \lambda_k E$\\
Тогда $V = \span(\ldots, v_1^{\lambda_k}, \ldots, v_{\gamma(\lambda_k)}^{\lambda_k},\ldots)$, где $v_1^{\lambda_k}, \ldots, v_{\gamma(\lambda_k)}^{\lambda_k}$ -- базис $V_{\lambda_k}$\\
Тогда базис $V$ -- объединение базисов\\
Отсюда $\chi_A(t) = \det (A-tE) = \det (A^1-tE) \ldots \det (A^m-tE)$
\subsection{Операторы простой структуры(ОПС). Диагонализируемая матрица. Проекторы. Спектральное разложение ОПС. Функция от матрицы}
\textbf{Определение}\\
$\mcA \in \nm{End}(V)$ называется оператором простой структуры, если существует базис $V$ такой, что матрица оператора в этом базисе имеет диагональный вид\\
$\Lambda = \nm{diag}(\lambda_1, \ldots, \lambda_n)$\\
\textbf{Замечание}\\
$\mcA$ -- ОПС $\LRto$ в $V$ существует базис из СВ\\
\textbf{Теорема}\\
Если все корни $\chi_\mcA(t) \in K$, т.е. являются СЧ (т.е. $\sum_{\lambda \text{ -- СЧ}} \alpha(\lambda) = n = \deg \chi_\mcA(t)$)\\
$\mcA$ -- ОПС $\LRto \fall \lambda$ -- СЧ $\alpha(\lambda) = \gamma(\lambda)$\\
\textbf{Доказательство}\\
$\gamma(\lambda) \leq \alpha(\lambda)$\\
$\mcA$ -- ОПС $\LRto \ex$ базис из СВ $\LRto М = \bigoplus_{\lambda \text{ -- СЧ}} V_{\lambda} \LRto n = \sum_{\lambda \text{ -- СЧ}} \gamma(\lambda)$\\
Отсюда $n = \sum_{\lambda \text{ -- СЧ}} \alpha(\lambda), \alpha = \gamma$\\
\textbf{Следствие}\\
Если $\lambda_1, \ldots, \lambda_n$ попарно различные СЧ $\mcA$, то $\mcA$ - ОПС\\
\textbf{Определение}\\
Матрица называется \textit{диагонализируемой}, если она подобна диагональной\\
$\ex T$ невырожденная $: T^{-1}AT = \nm{diag}(\lambda_1, \ldots, \lambda_n), \lambda_i$ -- СВ\\
\textbf{Теорема о приведении матрицы к диагональному виду}\\
Матрица $A$ диагонализируема $\LRto$ $A$ -- матрица ОПС $\mcA$ в некотором базисе\\
Причем $T=T_{e\rto v}$, где $e_1,\ldots,e_n$ -- базис, в котором была записана $A, v_1, \ldots, v_n$ -- базис из СВ $\mcA$, соответствующих $\lambda_1, \ldots, \lambda_n$\\
\textbf{Доказательство $\Lto$}\\
$\mcA$ -- ОПС\\
$e_1, \ldots, e_n$ -- базис $V$
$v_1, \ldots, v_n$ -- СВ, соответствующие $\lambda_1, \ldots, \lambda_n$ -- СЧ, базис $V$\\
$\mcA \us e\lrto A$
$\mcA \us v\lrto A'=\nm{diag}(\lambda_1, \ldots, \lambda_n)$\\
$T = T_{e\rto v}$\\
$A' = T^{-1}AT$\\
Отсюда $A$ подобна диагональной\\
\textbf{Доказательство $\Rto$}\\
//todo\\
\textbf{Определение}\\
Пусть $V = \bigoplus_{i=1}^m L_i, L_i$ -- линейное подпространство\\
Тогда $\fall v\in V \ex! v_1, \ldots v_m: v_i \in L_i, v=\sum_{i=1}^m v_i$\\
Зададим $\rho_i \in \nm{End}(V): \rho_i v = v_i \in L_i$\\
$\rho_i$ -- \textit{оператор проектирования(проектор)} на $L_i$\\
Свойства:
\begin{enumerate}
    \item $\fall i \neq j\ \rho_i \rho_j = \0$
    \item $\sum_{i=1}^m \rho_i = \epsilon$
    \item $\rho_i^k = \rho_i, k \in \Nset$ -- идемпотентность
    \item $\im \rho_i = L_i$\\
    $\ker \rho_i = \sum_{j \neq i} L_j$
\end{enumerate}
\textbf{Утверждение}\\
Пусть $\rho_1, \ldots, \rho_m \in \nm{End}(V)$, удовлетворяющие свойствам 1 и 2\\
Тогда $V = \bigoplus_{i=1}^m \im \rho_i$ (т.е. $\rho$ -- проектор на $L_i = \im \rho_i$)\\
\textbf{Доказательство}\\
Докажем $1, 2 \Rto 3$\\
$\rho_i = \rho_i \epsilon = \rho_i \sum_{i=1}^m \rho_j = \rho_i^2$\\
Докажем, что $V = \bigoplus_{i=1}^m \im \rho_i$\\
$\fall v \in V\ v = \epsilon v = \sum_{i=1}^m \rho_i v \Rto V = \sum_{i=1}^m \im \rho_i$\\
Докажем дизъюнктность\\
$\0 = v_1 (\in \im \rho_1) + \ldots + v_m (\in \im \rho_m)$\\
$\fall i = 1\ldots m\ v_i = \rho_i \omega_i (\ex \omega_i \in V)$\\
$v_i = \rho_i \omega_i = $ из свойства 3 $ = \rho_i (\sum_{j=1}^m \rho_j \omega_j) = \rho_i (\sum_{j=1}^m v_j) = \rho_i \0 = \0$, ч.т.д.\\
\textbf{Теорема о спектральном разложении о.п.с.}\\
$\fall \mcA \in \nm{End}(V)$ -- о.п.с.\\
Тогда $\mcA = \sum_{\lambda \text{ -- С.Ч.}} \lambda \rho_\lambda$, где $\rho_\lambda$ -- проектор на $V_\lambda$\\
\textbf{Доказательство}\\
Обозначение: Пусть все $\lambda$ -- С.Ч.
$\mcA$ -- о.п.с $\LRto V = \bigoplus_{\lambda} V_\lambda$\\
$v = \sum_{\lambda} v_\lambda, v_\lambda \in V_\lambda$\\
$\fall v\in V\ \mcA v = \mcA(\sum_\lambda v_\lambda) = \sum_\lambda (\mcA v) = \sum_\lambda \lambda v_\lambda = \sum_\lambda \lambda\rho_\lambda(v) = (\sum_\lambda \lambda\rho_\lambda) v$\\
Отсюда $\mcA = \sum_\lambda \lambda \rho_\lambda$ -- \textit{спектральное разложение}\\
\textbf{Следствие}\\
$A$ -- диагонализируема $\Rto\ex \rho_\lambda, \lambda$ -- С.Ч. $A: A = \sum_\lambda \lambda \rho_\lambda$\\
\textbf{Определение}\\
$(A_m)_{m=1}^\infty$ -- последовательность матриц $A_{n\times n} = (a_{ij}^m)_{n\times n}, m$ -- индекс, а не степень\\
$\lim_{m \rto \infty} A_m = A = (a_{ij})_{n\times n} \LRto \fall i,j = 1\ldots n\ a_{ij}=\lim_{m\rto \infty} a_{ij}^m$\\
\textbf{Немного про ряды}\\
$\sum_{m=1}^\infty a_m$ -- числовой ряд ($a_m \in \Rset(\Cset)$)\\
$S_m = \sum_{i=1}^m a_k$ -- частичная сумма ряда\\
Если $S_m$ сходится, то ряд называется сходящимся\\
\textbf{Определение}\\
$\sum_{m=1}^\infty A_m$ -- ряд из матриц\\
$\sum_{m=1}^\infty A_m$ -- сходится $\LRto \fall i,j = 1\ldots n\ \sum_{m=1}^\infty a_{ij}^m$ -- сходится\\
\textbf{Далее про ряды}\\
$\sum_{n=1}^\infty u_n(x), u_n: \Rset \rto \Rset$ -- функциональный ряд\\
При фиксированном $x$ -- числовой ряд\\
Множество $x$ таких, что числовой ряд сходится -- множество поточечной сходимости ряда $= E$\\
$\sum_{m=1}^\infty C_m (x-x_0)^m$ -- степенные ряды\\
Утверждается, что ряд сходится при $|x-x_0| < R$, где $R$ -- радиус сходимости\\
В $\Cset$ -- круг сходимости\\
В $\Rset$ -- интервал сходимости\\
Для $\Rset:\ \frac1R = \overline{\lim_{m\rto \infty}} \sqrt[m]{|C_m|}$\\
Примеры сходящихся рядов -- ряды Тейлора-Маклорена\\
$e^x = \sum_{m=1}^\infty \frac{x^m}{m!}$, сходится при $|x-x_0| \leq \infty$\\
$\sin x = \sum_{m=0}^\infty \frac{(-1)^m x^{2m+1}}{(2m+1)!}$, сходится при $|x| \leq \infty$\\
На окружности (при $|x-x_0| = R$) ряд может как сходиться, так и расходиться\\
\textbf{Определение}\\
Пусть $f(x) = \sum_{m=0}^\infty C_m x^m, |x| \leq R$\\
Тогда $f(A):= \sum_{m=0}^\infty C_m A^m$ (если ряд сходится)\\
\textbf{Теорема 1 (первый способ вычисления $f(A)$ для диагонализируемой матрицы)}\\
Пусть $A_{n\times n}$ диагонализируема\\
$f(x) = \sum_{m=1}^\infty C_m x^m, |x| \leq R$\\
Тогда если $\fall \lambda$ -- СЧ $|\lambda| < R$, то ряд $\sum_{m=1}^\infty C_m A^m$ сходится\\
$f(A) = T\nm{diag}(f(\lambda_1), \ldots, f(\lambda_n))T^{-1}$, где $\Lambda = T^{-1}AT = \nm{diag}(\lambda_1, \ldots, \lambda_n)$\\
\textbf{Доказательство}\\
$A_{n\times n}$ диагонализируема, а значит $\ex T: \Lambda = T^{-1}AT = \nm{diag}(\lambda_1, \ldots, \lambda_n)$\\
$S_m = \sum_{k = 0}^m C_k A^k, R = \infty$\\
$A^k = (T \Lambda T^{-1})^k = T \Lambda^k T^{-1} = T\nm{diag}(\lambda_1^k, \ldots, \lambda_n^k)T^{-1}$\\
Отсюда $S_m = T\nm{diag}(\sum_{k=0}^m C_k\lambda_1^k, \ldots, \sum_{k=0}^m C_k\lambda_n^k)T^{-1}$ (т.к. $R = \infty$, то все ряды сойдутся)\\
$S = \lim_{m\rto \infty} S_m = T\nm{diag}(f(\lambda_1), \ldots, f(\lambda_n))T^{-1}$\\
\textbf{Теорема 2 (второй способ вычисления $f(A)$ для диагонализируемой матрицы)}\\
Пусть $A_{n\times n}$ диагонализируема\\
$f(x) = \sum_{m=0}^\infty C_m x^m, |x| \leq R$\\
Тогда если $\fall \lambda$ -- СЧ $|\lambda| < R$, то ряд $\sum_{m=1}^\infty C_m A^m$ сходится\\
$f(A) = \sum_{\lambda \text{-- СЧ}} f(\lambda) \rho_\lambda$, где $A = \sum_{\lambda \text{ -- СЧ}} \lambda\rho_\lambda$ -- спектральное разложение\\
\textbf{Доказательство}\\
$A$ -- диагонализируема $\Rto A = \sum_{\lambda \text{ -- СЧ}} \lambda \rho_\lambda$\\
Тогда $A^k = (\sum_{\lambda \text{ -- СЧ}} \lambda \rho_\lambda)^k = \sum_{\lambda \text{ -- СЧ}} \lambda^k \rho_\lambda$\\
Отсюда $S_m = \sum_{k=0}^m C_k A^k = \sum_{k=0}^m C_k\sum_{\lambda \text{ -- СЧ}} \lambda^k \rho_\lambda =  \sum_{\lambda \text{ -- СЧ}} (\sum_{k=0}^mC_k\lambda^k) \rho_\lambda \xrto[m \rto \infty]{} \sum_{\lambda \text{ -- СЧ}} f(\lambda) \rho_\lambda$\\
\textbf{Следствие}\\
$A$ -- диагонализируема, $f(x) = \sum_{m=0}^\infty C_m x^m, |x| < R$\\
$\fall \lambda$ -- СЧ $|\lambda| < R$\\
$t \in \Rset(\Cset): \fall \lambda$ -- СЧ $|t\lambda| < R$\\
Тогда $f(At) = T\nm{diag}(f(\lambda_1 t), \ldots, f(\lambda_nt))T^{-1}$\\
или $f(At) = \sum_{\lambda \text{-- СЧ}} f(\lambda t) \rho_\lambda$\\
\textbf{Пример}\\
$\exp At = e^{At} = \sum_\lambda e^{t\lambda}\rho_\lambda = T \nm{diag}(e^{\lambda_1t}, \ldots, e^{\lambda_nt})T^{-1}$\\
\textbf{Свойства}
\begin{enumerate}
    \item $e^{A(t_1 + t_2)} = e^{At_1}e^{At_2}$
    \item $e^{A0} = E$
    \item $(e^{At})'=Ae^{At} = e^{At}A$\\
    \textbf{Доказательство}\\
    $(e^{At})' = (\sum_\lambda f(\lambda t)\rho_\lambda)'=\sum_\lambda \lambda e^{\lambda t}\rho_\lambda = (\sum_{\lambda} \lambda \rho_\lambda)(\sum_{\lambda} e^{t\lambda} \rho_\lambda) = Ae^{At} = e^{At}A$
\end{enumerate}
\textbf{Поиск обратной матрицы}\\
Пусть $A$ диагонализируема\\
$\fall \lambda\ \lambda \neq 0 \LRto \ex A^{-1}$\\
$A^{-1} = T\nm{diag}(\frac1{\lambda_1}, \ldots, \frac1{\lambda_n})T^{-1}$\\
$A^{-1} = \sum_\lambda \frac1\lambda \rho_\lambda$\\
\textbf{Определение}\\
$\sqrt[m]A$ -- арифметический корень\\
Если $\fall \lambda\ \lambda \geq 0$, то результат определен однозначно\\
$A^{-1} = T\nm{diag}(\sqrt[m]{\lambda_1}, \ldots, \sqrt[m]{\lambda_n})T^{-1}$\\
\subsection{Комплексификация вещественного линейного пространства. Продолжение вещественного линейного оператора}
$V$ -- линейное пространство над полем $K = \Rset (\Cset)$\\
Рассмотрим все ситуации
\begin{enumerate}
    \item Все корни $\chi_\mcA(t) \in K$\\
    Т.е. все корни являются С.Ч. $\mcA$\\
    $\fall \lambda\ \alpha(\lambda) = \gamma(\lambda)$, т.е. $\mcA$ -- о.п.с. (тогда матрица диагонализируема)
    \item Все корни $\chi_\mcA(t) \in K$\\
    Т.е. все корни являются С.Ч. $\mcA$\\
    $\ex \lambda: \gamma(\lambda) < \alpha(\lambda)$, т.е. $\mcA$ -- не о.п.с. (тогда матрица приводится к жордановой форме)
    \item При $K = \Rset$ не все корни $\chi_\mcA(t) \in \Rset$\\
    Тогда применяется комплексификация пространства
\end{enumerate}
Займемся комплексификацией\\
\textbf{Определение}\\
$V$ -- вещественное линейное пространство над $\Rset$\\
$\fall x,y \in V (x,y) \sim z:= x+iy$\\
$V_\Cset = \{ z = x+iy: x,y \in V \}$\\
$x+iy = x'+iy' \LRto x=x' \land y=y'$ в $V$\\
$\0 = \0 + i\0$ -- нулевой в $V_\Cset$\\
$\fall x \in V\ V_\Cset \ni x+\0i = x$\\
$z_1 + z_2 := (x_1+x_2)+i(y_1+y_2)$\\
$\fall \lambda = \alpha + i\beta\ \lambda z = (\alpha x - \beta y) + i (\alpha y + \beta x)$\\
\textbf{Утверждение}\\
$V_\Cset$ -- линейное пространство\\
\textbf{Теорема (о вещественном базисе $V_\Cset$)}\\
Пусть $\dim V = n, e_1, \ldots, e_n$ -- базис $V, e_j \in V(V_\Cset)$\\
Тогда $e_1, \ldots, e_n$ -- базис $V_\Cset (\dim V = \dim V_\Cset)$\\
\textbf{Доказательство}\\
$\fall z \in V_\Cset: z = x+iy, x,y \in V$\\
$x = \sum_{j=1}^n x_je^j$\\
$y = \sum_{j=1}^n y_je^j$\\
Отсюда $z = \sum_{j=1}^n(x_j + iy_j) e_j$, т.е. $e_1, \ldots, e_n$ -- порождающая\\
//todo
Отсюда $e_1, \ldots, e_n$ -- линейно независимые\\
\textbf{Определение}\\
$z=x+iy$\\
Тогда $\overline z = x-iy$ -- сопряженный вектор\\
\textbf{Утверждение}\\
$z_1, \ldots, z_m$ -- линейно независимые в $V_\Cset \LRto \ol z_1, \ldots, \ol z_m$ -- линейно независимые\\
($\Rto \rg (z_1, \ldots, z_m) = \rg (\ol z_1, \ldots, \ol z_m)$)\\
\textbf{Доказательство}\\
$c_1 \ol z_1 + \ldots c_m \ol z_m = \0$\\
$\ol{c_1 \ol z_1 + \ldots c_m \ol z_m} = \ol \0 = \0 = \ol c_1 z_1 + \ldots + \ol c_m z_m$ -- линейно независимые\\
Отсюда $\ol c_i = 0 \LRto c_i = 0$\\
\textbf{Определение}\\
$\mcA \in \nm{End}(V)$\\
Продолжением $\mcA$ на $V_\Cset$ называется $\mcA_\Cset \in \nm{End}(V_\Cset)$ такой, что\\
$\fall z=x+iy\in V_\Cset\ \mcA_\Cset z = \mcA x + i\mcA y \in V_\Cset$\\
\textbf{Свойства}
\begin{enumerate}
    \item $e_1, \ldots, e_n$ -- базис $V$\\
    $\mcA \us{e}\lrto A = (a_{ij})_{n\times n}, a_{ij} \in \Rset$\\
    Тогда $\mcA_\Cset \us e\lrto A_\Cset = A = (a_{ij})_{n\times n}$\\
    \textbf{Доказательство}\\
    $\mcA_\Cset e_j = \ldots = \mcA e_j = \sum_{k=1}^n a_{kj}e_k$\\
    Отсюда $A_\Cset = A$
    \item $\chi_\mcA(t) = \chi_{\mcA_\Cset}(t)$ (т.к. матрицы равны)
    \item $\fall z \in V_\Cset\ \ol{\mcA_\Cset z} = \mcA_\Cset(\ol z)$
    \item $\alpha\pm  i\beta$ -- пара сопряженных корней $\chi_\mcA(t)$ -- СЧ для $\mcA_\Cset$\\
    Тогда $z$ -- СВ, отвечающий СЧ $\alpha + i \beta \LRto \ol z$ -- СВ, отвечающий СЧ $\alpha - i \beta$\\
    \textbf{Доказательство}\\
    $\mcA_\Cset \ol z = \ol{\mcA_\Cset z} = \ol {(\alpha+i\beta)z} = (\alpha - i\beta)\ol{z}$
\end{enumerate}
Тогда:\\
Т.о. если $\chi_\mcA(t)$ имеет комплексные корни, то после комплексификации будет реализовываться случай 1 или 2
\subsection{Минимальный многочлен линейного оператора. Теорема Кэли-Гамильтона}
\textbf{Определение}\\
$\mcA \in \nm{End}(V)$\\
\textit{Нормализованный многочлен} -- многочлен, старший коэффициент которого 1\\
Нормализованный многочлен $\psi(t)$ называется \textit{аннулятором} элемента $x \in V$, если $\psi(\mcA)x = \0$\\
$\psi(t) = t^m + a_{m-1}t^{m-1} + \ldots + a_0 = \prod_{\lambda \text{ -- корень многочлена}} (t-\lambda)^{m(\lambda)}$, где $m(\lambda)$ -- кратность корня\\
$\psi(\mcA) = \mcA^m + a_{m-1} \mcA^{m-1} + \ldots + a_0\epsilon = \prod_{\lambda \text{ -- корень}} (A-\lambda\epsilon)^{m(\lambda)}$\\
\textbf{Определение}\\
Минимальный аннулятор $x$ -- аннулятор минимальной степени\\
\textbf{Теорема о минимальном аннуляторе элемента}\\
$\mcA \in \nm{End}(V)$
\begin{enumerate}
    \item $\fall x \in V\ \ex!$ минимальный аннулятор $x$
    \item Любой аннулятор $x$ делится на минимальный
\end{enumerate}
\textbf{Доказательство 1}\\
(алгоритм)
\begin{enumerate}
    \item $x = \0, \psi \equiv 1$\\
    $\epsilon = \psi(\mcA)$
    \item $x \neq \0$\\
    Пусть $x, \mcA x, \ldots, \mcA^{m-1}x$ -- линейно независимые и $m$ максимальное\\
    $\ex! \alpha_1, \ldots, \alpha_{m-1}: \mcA^m x = \sum_{i=0}^{m-1} \alpha_i \mcA^i x$\\
    $(\mcA^m - \sum_{i=0}^{m-1} \alpha_i \mcA^i) x = \0$\\
    $\psi(t) = t^m - \sum_{i=0}^{m-1} \alpha_i t^i$ -- минимальный и определен единственным образом
\end{enumerate}
\textbf{Доказательство 2}\\
Пусть $\psi'(t) = a(t)\psi(t)+r(t), \deg r < \deg \phi$ -- аннулятор\\
$\0 = \psi'(\mcA)x = a(\mcA)\ub\0{\psi(\mcA)x} + r(\mcA)x$\\
Отсюда $r(\mcA) = \0$\\
Но т.к. $\psi$ -- минимальный, то $r \equiv \0$\\
\textbf{Определение}\\
Нормализованный многочлен $\phi(t)$ называется аннулятором $\mcA$, если $\fall v \in V\ \phi(\mcA)v = \0$ (т.е. $\phi(\mcA) = \0$)\\
Аннулятор $\mcA$ минимальной степени -- \textit{минимальный многочлен}\\
\textbf{Теорема о минимальном многочлене}\\
$\mcA \in \nm{End}(V)$
\begin{enumerate}
    \item $\fall \mcA \ex!$ минимальный многочлен
    \item Любой аннулятор $\mcA$ делится на минимальный многочлен
\end{enumerate}
\textbf{Доказательство}\\
(алгоритм)
\begin{enumerate}
    \item $e_1, \ldots, e_n$ -- базис $V$\\
    По теореме 1 $\fall e_i \ex! \psi_i(t)$ -- минимальный аннулятор $e_i$\\
    $\phi(t) := \nm{lcm} (\psi_1, \ldots, \psi_n)$\\
    Тогда $\fall j \phi(t) = a_j(t)\psi_j(t)$\\
    Докажем, что $\phi(t)$ -- аннулятор\\
    $\fall v \in V \phi(\mcA)v = \phi(\mcA) \sum_{j=1}^m v_j e_j = \sum_{j=1}^m \phi(\mcA) v_j e_j = \sum_{j=1}^m a_j(t)\psi_j(t) v_j e_j = \0$\\
    Т.о. $\phi$ -- аннулятор
    \item Докажем, что любой другой аннулятор делится на $\phi$\\
    Пусть $\phi_1(t)$ -- аннулятор $\mcA$\\
    $\fall v \in V \phi_1(\mcA)v = \0 \Rto \fall j=1\ldots n\ \phi_1(\mcA)e_j=\0$ - тогда $\phi_1(\mcA)$ -- аннулятор $e_j$\\
    Т.к. $\psi_j(t)$ -- минимальный аннулятор $e_j$, то $\phi_1(t)$ делится на $\psi_i(t)$\\
    Отсюда $\phi_1(t)$ делится на $\nm{lcm}(\psi_1, \ldots, \psi_n) = \phi(t)$\\
    Отсюда $\deg \phi$ -- минимальная из возможных, а значит $\phi$ -- минимальный многочлен
    \item Докажем, что минимальный многочлен единственный\\
    Пусть $\phi_2(t)$ -- аннулятор $\mcA$ такой, что $\deg \phi = \deg \phi_2 = m$\\
    Тогда $\delta = \phi_2(t) - \phi(t) = a_{m-1}t^{m-1} + \ldots + a_0$ -- степень меньше $m$\\
    Но тогда $\delta$ -- аннулятор, $\deg \delta < m$ -- противоречие\\
    Отсюда $\phi_2 = \phi$\\
\end{enumerate}
\textbf{Теорема Кэли-Камильтона}\\
$\fall \mcA \in \nm{V}$\\
$\chi_\mcA$ -- аннулятор $\mcA$ (т.е. $\chi_\mcA(\mcA) \equiv 0$)\\
\textbf{Доказательство}\\
Пусть $\mcA \us{e_1, \ldots, e_n}\lrto A$\\
$\chi_\mcA(t) = \chi(t) = \det (\mcA - t\epsilon) = \det (A-tE)$\\
Пусть $\mu$ не корень $\chi$\\
Тогда $\det(A-\mu E) \neq 0$\\
$(A-\mu E)^{-1} = \frac1{\det(A - \mu E)}(b_{ij} := A_{ji})$\\
$b_{ij}$ - многочлен $n-1$ степени от $\mu$\\
Отсюда $(A-\mu E)^{-1} = \frac1{\det(A-\mu E)}(\mu^{n-1} B_{n-1} + \ldots + B_0)$, где $B_i$ -- матрица $n \times n$\\
Отсюда $\det (A-\mu E)E = (A-\mu E)(\mu^{n-1} B_{n-1} + \ldots + B_0) = -\mu^n B_{n-1} + \mu^{n-1}(AB_{n-1}-B_{n-2}) + \ldots + \mu (AB_1 - B_0) + AB_0$\\
$\det(A-\mu E)E = \chi(\mu) E = \sum_{k=0}^n \alpha_k \mu^k E$\\
$\sum_{k=0}^n \alpha_k \mu^k E = -\mu^n B_{n-1} + \mu^{n-1}(AB_{n-1}-B_{n-2}) + \ldots + \mu (AB_1 - B_0) + AB_0$\\
Отсюда $\alpha_0 E = AB_0$\\
$\alpha_1 E = AB_1 - B_0$\\
$\vdots$\\
$\alpha_{n-1} E = AB_{n-1} - B_{n-2}$\\
$\alpha_n E = -B_{n-1}$\\
$\chi (A) = \sum_{k=0}^n \alpha_k A^k = AB_0 + A(AB_1 - B_0) + A^2 (AB_2 - B_1) + \ldots + A^{n-1} (AB_{n-1}-B_{n-2}) = \0$\\
\textbf{Следствие}\\
$\fall \mcA \in \nm{End}(V)\ \chi_\mcA$ делится на $\phi_\mcA$\\
\textbf{Следствие 2}\\
$\deg \phi_\mcA = n = \dim V \Rto \phi_\mcA \equiv (-1)^n\chi_\mcA$\\
\textbf{Теорема (о корнях минимального многочлена)}\\
Множество корней характеристического многочлена и минимального многочлена совпадают (без учета кратности)\\
\textbf{Доказательство $\Rto$}\\
Пусть $\lambda$ -- корень $\chi(t)$
\begin{enumerate}
    \item Пусть $\lambda \in K \Rto \lambda$ -- С.Ч. $\mcA \Rto \ex v \neq 0: (\mcA - \lambda \epsilon)v = \0$\\
    Отсюда $\psi(t) = (t-\lambda)$ -- минимальный аннулятор элемента $v$\\
    Т.к. $\phi$ -- минимальный многочлен, то $\phi(\mcA) v = \0 \Rto \phi(\mcA)$ аннулятор $v$\\
    Тогда по теореме 1 $\phi$ делится на $\psi \Rto \lambda$ -- корень $\phi$
    \item Пусть $\lambda \not\in K$, т.е. $K = \Rset, \lambda \in \Cset$\\
    $V \rto V_\Cset$\\
    $\mcA \rto \mcA_\Cset$\\
    $e_1, \ldots, e_n$ -- базис $V \rto$ базис $V_\Cset$\\
    $\mcA \us{V, e}\lrto A \us{V_\Cset, v} \lrto \mcA_\Cset$\\
    $\chi_\mcA(t) = \chi_{\mcA_\Cset}(t) \Rto \lambda$ -- корень $\chi_{\mcA_\Cset} \Rto \lambda$ -- корень $\phi_{\mcA_\Cset}$\\
    Заметим, что из алгоритма построения минимального многочлена $\phi_\mcA = \phi_{\mcA_\Cset}$\\
    Отсюда $\lambda$ -- корень $\phi_{\mcA_\Cset}$
\end{enumerate}
\textbf{Доказательство $\Lto$}\\
Пусть $\lambda$ -- корень $\phi_\mcA(t)$\\
$\chi_\mcA$ делится на $\phi_\mcA(t) \Rto \lambda$ -- корень $\chi_\mcA(t)$\\
\textbf{Замечание}\\
Получаем второй способ получения С.Ч. $\mcA$\\
$m(\lambda) \leq \alpha(\lambda)$
\subsection{Операторное разложение единицы. Корневое подпространство}
$\phi(t) = \prod_\lambda (t-\lambda)^{m(\lambda)} = (t-\lambda)^{m(\lambda)} \prod_{\mu \neq \lambda} (t-\mu)^{m(\mu)} = (t-\lambda)^{m(\lambda)}\phi_\lambda(t), \phi_\lambda(t) := \prod_{\mu \neq \lambda} (t-\mu)^{m(\mu)}$\\
$\deg \phi = m = \sum_{\lambda} m(\lambda)$\\
\textbf{Определение}\\
$I_\lambda := \{ p \in P_{m-1}: p$ делится на $\phi_\lambda\}$ -- главный идеал, порождающий многочлен $\phi_\lambda$\\
$I_\lambda$ -- линейное подпространство $P_{m-1}$\\\\
$I_\lambda \ni p(t) = a_\lambda(t)\phi_\lambda(t)$\\
$m - 1 \geq \deg p = \deg a_\lambda + \deg \phi_\lambda = \deg a_\lambda + m - m_\lambda$\\
$\deg a_\lambda \leq m(\lambda) - 1$\\
$I_\lambda \cong P_{m(\lambda) - 1}$\\
$p \lrto a_\lambda$\\
$\dim I_\lambda = m(\lambda)$\\
\textbf{Теорема}\\
$P_{m-1} = \bigoplus_\lambda I_\lambda$\\
\textbf{Доказательство}
\begin{enumerate}
    \item Проверим, что $I_\lambda$ дизъюнктны\\
    $\0 = \sum_\lambda p_\lambda(t) = \sum_\lambda a_\lambda(t)\phi_\lambda(t) = \ub{\text{делится на $(t-\lambda)^{m(\lambda)}$}}{a_\lambda(t)\ub{\text{не делится на $(t-\lambda)^{m(\lambda)}$}}{\phi_\lambda(t)}} + \ub{\text{делится на $(t-\lambda)^{m(\lambda)}$}}{\sum_{\mu \neq \lambda} a_\mu(t)\phi_\mu(t)}$\\
    Отсюда $a_\lambda(t)$ делится на $(t-\lambda)^{m(\lambda)}$, но $\deg a_\lambda \leq m(\lambda) - 1$\\
    Тогда $a_\lambda(t) = 0 \LRto p_\lambda(t) \equiv 0 \Rto$ дизъюнктные\\
    \item $\bigoplus_\lambda I_\lambda \subset P_{m-1}, \dim P_{m-1} = m$\\
    $\dim \bigoplus_\lambda I_\lambda = \sum_\lambda m(\lambda) = m$\\
    Отсюда $P_{m-1} = \bigoplus_\lambda I_\lambda$
\end{enumerate}
\textbf{Следствие}\\
$\fall p \in P_{m-1} \ex ! (p_\lambda): p_i \in I_i, p=\sum_\lambda p_\lambda$\\
В частности, для $p\equiv 1\ \ex! (p_\lambda): p_i \in I_i, 1=\sum_\lambda p_\lambda$ -- полиноминальное разложение единицы (порожденное многочленом $\phi$)\\
$p_\lambda(t) = a_\lambda(t)\phi_\lambda(t)$\\
\textbf{Замечание}
\begin{enumerate}
    \item $\lambda \neq \mu \Rto p_\lambda p_\mu$ делится на $\phi$\\
    \textbf{Доказательство}\\
    $p_\lambda(t) = a_\lambda \phi_\lambda(t)$\\
    $p_\mu(t) = a_\mu \phi_\mu(t)$\\
    $p_\lambda(t)p_\mu(t) = a_\lambda(t)a_\mu(t)\phi_\lambda(t)\phi_\mu(t) = b(t)\phi(t)$
    \item Пусть все корни $\phi$ взаимно-простые, т.е. $\fall \lambda\ m(\lambda) = 1$\\
    $\phi(t) = \prod_\lambda (t-\lambda)$\\
    $\deg a_\lambda(t) \leq m(\lambda) - 1 = 0$\\
    Отсюда $a_\lambda(t) = \const$
\end{enumerate}
\textbf{Теорема Лагранжа}\\
Пусть все корни $\phi(t)$ взаимно прострые\\
Т.е. $\fall \lambda: m(\lambda) = 1\ \phi(t) = \prod_\lambda (t-\lambda)$\\
Тогда $\fall p \in P_{m-1}\ p(t) = \sum_\lambda \frac{p(\lambda)}{\phi'(\lambda)}\phi_\lambda(t)$\\
($a_\lambda = \frac{p(\lambda)}{\phi'(\lambda)}$)\\
\textbf{Доказательство}\\
$\ex! (p_\lambda): p_i \in I_i, p(t) = \sum_\lambda \ub{\phi_\lambda(t)\in I_\lambda}{a_\lambda \phi_\lambda(t)}$\\
$p(\lambda) = \sum_\mu a_\mu \phi_\mu(\lambda) = a_\lambda \phi_\lambda(\lambda) \Rto a_\lambda = \frac{p(\lambda)}{\phi_\lambda(\lambda)}$\\
$\phi(t) = \prod_\mu (t-\mu) = (t-\lambda) \ub{\phi_\lambda(t)}{\prod_{\mu \neq \lambda} (t-\mu)}$\\
$\phi'(t) = \sum_\mu \prod_{\xi \neq \mu}(t-\xi)$\\
$\phi'(\lambda) = \prod_{\xi \neq \lambda} (\lambda - \xi) = \phi_\lambda(\lambda)$\\
Отсюда $a_\lambda = \frac{p(\lambda)}{\phi'(\lambda)}$\\
\textbf{Следствие}\\
Пусть $\fall \lambda: m(\lambda) = 1$\\
Тогда $1 = \sum_\lambda p_\lambda \Rto p(t) = t = \sum_\lambda \lambda p_\lambda$\\
\textbf{Доказательство}\\
$1 = \sum_\lambda a_\lambda \phi_\lambda(t) = \sum_\lambda \frac1{\phi'(\lambda)}\phi_\lambda(t)$\\
$t = \sum_\lambda \frac\lambda{\phi'(\lambda)}\phi_\lambda(t) = \sum_\lambda \lambda p_\lambda(t)$\\\\
Пусть $\phi(t) = \prod_\lambda (t-\lambda)^{m(\lambda)}$ -- минимальный многочлен $\mcA \in \nm{End}(V)$\\
Построим полиноминальное разложение $1$, порождающее многочлен $\phi$\\
$1 = \sum_\lambda p_\lambda(t) = \sum_\lambda a_\lambda(t)\phi_\lambda(t)$\\
$\epsilon = \sum_\lambda \ub{\rho \text{-- спектр. проектор оператора $\mcA$}}{p_\lambda(\mcA)} = \sum_\lambda a_\lambda(\mcA) \phi_\lambda(\mcA)$\\
$\epsilon = \sum_\lambda \rho_\lambda$ -- операторное разложение единицы (порожденное оператором)\\
\underline{\textbf{Спектральный оператор действует не на собственное подпространство}}\\\\
\textbf{Свойства}\\
Пусть $\lambda \neq \mu$\\
Проверим, что $\rho_\lambda \rho_\mu = \0$\\
$\rho_\lambda = p_\lambda(\mcA) = a_\lambda(\mcA)\phi_\lambda(\mcA)$\\
$\rho_\mu = p_\mu(\mcA) = a_\mu(\mcA)\phi_\mu(\mcA)$\\
$\rho_\lambda\rho_\mu = (\rho_\lambda\rho_\mu)(\mcA) = b(\mcA)\phi(\mcA) = \0$\\\\
Если $\lambda$ единственный корень $\phi(t) = (t-\lambda)^{m(\lambda)} \cdot \ub{\phi_\lambda(t)}1$\\
$1 = 1 \LRto p_\lambda = \epsilon$\\
Если все корни взаимно прострые:\\
$\fall \lambda\ m(\lambda) = 1$\\
По следствию из т. Лагранжа:\\
$\epsilon = \sum_\lambda p_\lambda$\\
$\mcA = \sum_\lambda \lambda p_\lambda$\\
Далее покажем, что $p_\lambda$ -- проекторы на $V_\lambda$, т.е. совпадает со спектральным разложением о.п.с\\
Т.е. $\mcA$ -- о.п.с.\\
\textbf{Определение}\\
$K_\lambda = \ker (\mcA - \lambda \epsilon)^{m(\lambda)}$ называется корневым подпространством $\mcA$\\
$\lambda$ -- СЧ $\mcA$\\
Очевидно, что $V_\lambda \subset K_\lambda$\\
$V_\lambda = \ker (\mcA - \lambda \epsilon) \subset \ker (\mcA - \lambda \epsilon)^{m(\lambda)} = K_\lambda$\\
\textbf{Теорема о корневом подпространстве}
\begin{enumerate}
    \item $K_\lambda$ -- инвариантно относительно $\mcA$
    \item $\im \rho_\lambda = K_\lambda (\Rto \bigoplus_\lambda K_\lambda = V)$
    \item $(t-\lambda)^{m(\lambda)}$ минимальный многочлен для $A\vl_{K_\lambda} \in \nm{End}(K_\lambda)$
\end{enumerate}
\textbf{Доказательство}
\begin{enumerate}
    \item $x \in \ker (\mcA - \lambda\epsilon)^{m(\lambda)} = K_\lambda$\\
    $\ub{\text{перестановочные, т.к. многочлены}}{(\mcA - \lambda \epsilon)^{m(\lambda)} \mcA x} = \mcA (\mcA - \lambda \epsilon)^{m(\lambda)} x = \0$\\
    Отсюда $\mcA x \in \ker (\mcA - \lambda \epsilon)^{m(\lambda)} = K_\lambda$\\
    $\mcA^k = \mcA^{k-1}\mcA = \mcA \mcA^{k-1}$
    \item $\fall x \in V \rho_\lambda x = a_\lambda(\mcA) \phi_\lambda(\mcA)x$\\
    $(\mcA - \lambda \epsilon)^{m(\lambda)} \ub{\im \rho_\lambda}{\rho_\lambda x} = (\mcA - \lambda \epsilon)^{m(\lambda)} a_\lambda (\mcA) \phi_\lambda(\mcA) x = a_\lambda(\mcA)\ub{\phi(\mcA) = 0}{(\mcA - \lambda \epsilon)^{m(\lambda)}\phi_\lambda(\mcA)}x = \0$\\
    Отсюда $\rho_\lambda \ni \rho_\lambda x \in \ker (\mcA - \lambda \epsilon)^{m(\lambda)} = K_\lambda$\\
    Отсюда $\im \rho_\lambda \subset K_\lambda$\\
    \textbf{Обратно}\\
    $x \in K_\lambda = \ker (\mcA - \lambda \epsilon)^{m(\lambda)}$\\
    Пусть $\mu \neq \lambda$\\
    $\rho_\mu x = a_\mu(\mcA)\ub{b(\mcA)(\mcA - \lambda \epsilon)^{m(\lambda)}}{\phi_\mu(\mcA)}x = \0$\\
    $x = \epsilon x = \sum_\mu \rho_\mu x = \rho_\lambda x \in \im \rho_\lambda$\\
    Отсюда $K_\lambda \subset \im \rho_\lambda$
    \item $\mcB = \mcA\vl_{K_\lambda} \in \nm{End}(K_\lambda)$\\
    Проверим, что $(t-\lambda)^{m(\lambda)}$ -- минимальный многочлен\\
    $(t-\lambda)^{m(\lambda)}$ -- аннулятор $\mcB$\\
    Докажем от противного, что он минимальный\\
    Пусть $(t-\lambda)^k$ -- минимальный многочлен, $k < m(\lambda)$\\
    $\phi_1 (t) := (t-\lambda)^k \phi_\lambda(t), \deg \phi_1 \leq \deg \phi$\\
    Покажем, что $\phi_1$ -- аннулятор $\mcA$\\
    $\fall v \in V=\bigoplus_\mu K_\mu\ v = \sum_\mu \ub{\in K_\mu}{v_\mu}$ -- раскладывается единственным образом\\
    $\phi_1(\mcA) v = \sum_\mu (\mcA - \lambda \epsilon)^k \ub{\text{содержит множитель $(\mcA - \lambda \epsilon)^{m(\lambda)}$}}{\phi_\lambda(\mcA)}\ub{\in \ker (\mcA - \lambda \epsilon)^{m(\lambda)}}{v_\mu} = \sum_{\mu \neq \lambda} (\mcA - \lambda \epsilon)^k b_\mu(\mcA)(\mcA - \lambda \epsilon)^{m(\lambda)}v_\mu + (\mcA - \lambda \epsilon)^k \phi_\lambda(\mcA)v_\lambda = \0$\\
    Отсюда $\phi_1$ аннулятор $\mcA$, причем степени меньшей, чем $\phi$, что противоречит минимальности $\phi$\\
    Отсюда $(t-\lambda)^{m(\lambda)}$ минимальный многочлен $\mcB$
\end{enumerate}
\textbf{Следствие 1}\\
$\fall \lambda\ m(\lambda) \leq \dim K_\lambda$ (очевидно из п.3 теоремы)\\
\textbf{Следствие 2}\\
$\mcA$ -- о.п.с $\LRto \fall \lambda\ m(\lambda) = 1$\\
\textbf{Доказательство $\Rto$}\\
$V = \bigoplus_\lambda V_\lambda$\\
Пусть $\phi(t):= \prod_{\lambda \text{ -- СЧ}} (t-\lambda)$\\
Очевидно аннулятор $\mcA$, причем минимальный\\
$\fall v \in V\ v = \sum_\lambda \ub{\in V_\lambda}{v_\lambda}$ -- раскладывается единственным образом\\
$\phi(\mcA) = \prod_{\mu} \prod_\lambda (\mcA - \lambda \epsilon)\ub{\in V_\mu = \ker (\mcA - \mu \epsilon)}{v_\mu} = \prod_\mu \prod_{\lambda \neq \mu} (\mcA - \lambda \epsilon)(\mcA - \mu \epsilon) v_\mu = \0$\\
\textbf{Доказательство $\Lto$}\\
$\fall \lambda\ m(\lambda) = 1$\\
$\phi(t) = \prod_\lambda (t-\lambda)$\\
$\fall \lambda\ K_\lambda = \ker (\mcA - \lambda \epsilon)^1 = V_\lambda$\\
Отсюда $\bigoplus_\lambda K_\lambda = V = \bigoplus_{\lambda}V_\lambda \LRto \mcA$ -- о.п.с.\\
\subsection{Нильпотентные операторы. Разложение Жордана}
\textbf{Определение}\\
$\mcB \in \nm{End}(V)$ называется \textit{нильпотентным}, если $\chi_\mcB = t^\nu, \nu \geq 1$\\
$\nu$ -- индекс нильпотентности ($\nu \leq n$)\\
(Т.е. $\mcB^\nu = \0$)\\
\textbf{Теорема (разложение Жордана)}\\
$\fall \mcA \in \nm{End}(V)$\\
$\ex \mc{D}$ -- оператор простой структуры $\in \nm{End}(V), \mcB$ нильпотентный $\in \nm{End}(V): \mcA = \mc D + \mcB$, причем $\mcB \mc D = \mc D \mcB$\\
\textbf{Доказательство}\\
$\phi(t)$ -- минимальный многочлен $\mcA$(все корни $\in K$)\\
$\epsilon = \sum_\lambda \rho_\lambda$\\
$\mcD:= \sum_\lambda \lambda \rho_\lambda$\\
Проверим, что $\mcD$ -- о.п.с.\\
Достаточно убедиться, что $\lambda$ -- СЧ $\mcD, \im \rho_\lambda = V_\lambda^D$ -- собственное подпространство для $\mcD$\\
Пусть $v_\lambda \in \im \rho_\lambda$\\
$\mcD v_\lambda = \sum_\mu \mu \ub{\mu \neq \lambda \Rto \ldots = 0}{\rho_\mu \ub{\in \im \rho_\lambda}{v_\lambda}} = \lambda \rho_\lambda v_\lambda = \lambda v_\lambda \Rto \lambda$ -- СЧ $\mcD$\\
$V = \bigoplus_\mu \im \rho_\mu$ -- дизъюнктны\\
Отсюда $\im \rho_\lambda \subset V_\lambda^\mcD$\\
$V = \bigoplus_\lambda \im p_\lambda \subset \bigoplus_\lambda V_\lambda^\mcD \subset V$\\
Отсюда $\im p_\lambda = V_\lambda^\mcD$\\
$\mcD$ -- о.п.с\\
$V = \bigoplus_\lambda V_\lambda^\mcD$\\
$D = \sum_\lambda \rho_\lambda$ -- спектральное разложение $\mcD$\\
$\mcB := \mcA - \mcD$\\
$\nu := \max_\lambda m(\lambda)$\\
Покажем, что $\mcB^\nu = \0$\\
$(\mcA - \mcD)^\nu = (\mcA - \sum_\lambda \lambda \rho_\lambda)^\nu = (\mcA\sum_\lambda \rho_\lambda - \sum_\lambda \lambda\rho_\lambda)^\nu = (\sum_\lambda (\mcA - \lambda \epsilon)\rho_\lambda)^\lambda = \sum_\lambda (\mcA - \lambda \epsilon)^\nu\rho_\lambda = \sum_\lambda b_\lambda(\mcA) (\mcA - \lambda \epsilon)^{m(\lambda)} \phi_\lambda(\mcA) = \0$\\
$\mcB\mcD = (\mcA - \sum_\lambda \lambda \rho_\lambda)(\sum_\mu \mu \rho_\mu) = (\sum_\mu \mu \rho_\mu)(\mcA - \sum_\lambda \lambda \rho_\lambda) = \mcD\mcB$\\
\textbf{Теорема (единственность разложения Жордана)}\\
Разложение Жордана $\mcA = \us{\text{о.п.с}}\mcD + \us{\text{нильпот.}}\mcB$ возможно единственным образом\\
\textbf{Доказательство}\\
Пусть $\mcA = \us{\text{о.п.с}}\mcD' + \us{\text{нильпот.}}\mcC$\\
$\mcD' = \sum_\mu \mu Q_\mu$ -- спектральное разложение\\
Достаточно доказать, что
\begin{enumerate}
    \item множество $\mu$ с.ч. $\mcD'$ совпадает с множеством с.ч. $\mcA$
    \item $\im Q_\lambda = K_\lambda(D = \sum_\lambda \lambda \rho_\lambda, \im \rho_\lambda = K_\lambda)$\\
    $\Rto \mcD = \mcD'$
    \item $\mcC = \mcA - \mcD' = \mcA - \mcD = \mcB$
\end{enumerate}
$(\mcA - \mu\epsilon)Q_\mu = (\sum_\xi \xi Q_\xi + \mcC - \mu\epsilon)Q_\mu = \mcC Q_\mu$\\
Покажем, что $\mcC Q_\mu = Q_\mu \mcC$\\
$\letus \lambda \neq \mu\ (\lambda - \mu) Q_\lambda C Q_\mu = \lambda Q_\lambda C Q_\mu - Q_\lambda C \mu Q_\mu = Q_\lambda D' C Q_\mu - Q_\lambda CD' Q_\mu = Q_\lambda(D'C-CD')Q_\mu = \0$\\
Отсюда $Q_\lambda C Q_\mu = \0 = Q_\mu C Q_\lambda, \lambda \neq \mu$\\
$\sum_\lambda Q_\lambda C Q_\mu = \sum_\mu Q_\lambda C Q_\mu$\\
При $\lambda = \mu: CQ_\mu = Q_\mu C$\\
$(\mcA - \mu \mcC)^k Q_\mu = \mcC^kQ_\mu$\\
Пусть $m(\mu)$ -- минимальное $k: (\mcA - \mu \epsilon)^{m(\mu)} = \0$\\
Такой $k$ найдется, т.к. $\mcC$ нильпотентный и при каком-то $k$ дает $= \0$\\
$\psi_\mu (t) = (t-\mu)^{m(\mu)}$\\
$\fall x \in \im Q_\mu\ \psi_\mu(\mcA)x = \0$\\
Тогда $\psi_\mu(\mcA)$ -- минимальный аннулятор элементов $\im Q_\mu$\\
$\phi$ -- минимальный многочлен, т.е. аннулятор любых элементов, в частности и $\im Q_\mu$\\
Тогда $\phi$ делится на $\psi_\mu$\\
Тогда $\fall \mu\ \mu$ -- корень $\phi$\\
Рассмотрим $\psi = \prod_\mu \psi_\mu (t)$. Покажем, что это аннулятор $\mcA$\\
$\fall v \in V\ v = \sum_\mu \ub{\in \im Q_\mu}{v_\mu}$\\
$\psi(\mcA)v = \sum_\xi \psi(\mcA)v_\xi = \sum_\xi b_\xi(\mcA)\psi_\xi(\mcA)v_\xi = \0$\\
Отсюда $\psi$ -- аннулятор $\mcA$\\
Тогда $\psi$ делится на $\phi$\\
Т.о. $\psi \equiv \phi$\\
Докажем пункт 2\\
$(\mcA - \lambda \epsilon)^{m(\lambda)}Q_\lambda = \0$\\
$\im Q_\lambda \subset \ker (\mcA - \lambda\epsilon)^{m(\lambda)} = K_\lambda$\\
$V = \bigoplus_\lambda \im Q_\lambda \subset \bigoplus_\lambda K_\lambda = V$\\
$\im Q_\lambda = K_\lambda = \im p_\lambda$\\
\textbf{Теорема 3}\\
$\mcA = \mcD + \mcB$ -- разложение Жордана\\
$\chi_\mcA \equiv \chi_\mcD$\\
\textbf{Доказательство}\\
$\mcD = \sum_\lambda \lambda p_\lambda$\\
$\mcB = \mcA - \mcD$\\
$\mcB^\nu = \0, \nu = \max m(\lambda)$\\
$\mcA,\mcB,\mcD$ -- попарно перестановочные\\
$\epsilon = \sum_\lambda \rho_\lambda$\\
$\im p_\lambda = K_\lambda = \ker (\mcA - \lambda \epsilon)^{m(\lambda)}$\\
$(\chi_\mcA(\mu))^\nu = (\det \mcA - \mu \epsilon)^\nu = \det (\mcA - \mu \epsilon)^\nu$\\
$t \in K, (\mcA - \mu \epsilon)^\nu - t^\nu \mcB^\nu = (\mcA - \mu\epsilon - t\mcB)((\mcA - \mu\epsilon)^{\nu - 1} + (\mcA - \mu\epsilon)^{\nu - 2}t\mcB + \ldots + t^{\nu-1}\mcB^{\nu - 1})$\\
$\ub{\text{не зависит от $t$}}{\det (\chi_\mcA(\mu))^\nu} = \ub{\text{многочлен от $t$}}{\det (\mcA - \mu\epsilon - t\mcB)}\ub{\text{многочлен от $t$}}{\det((\mcA - \mu\epsilon)^{\nu - 1} + (\mcA - \mu\epsilon)^{\nu - 2}t\mcB + \ldots + t^{\nu-1}\mcB^{\nu - 1})}$\\
Отсюда $\det (\mcA - \mu\epsilon - t\mcB)$ и $\det((\mcA - \mu\epsilon)^{\nu - 1} + (\mcA - \mu\epsilon)^{\nu - 2}t\mcB + \ldots + t^{\nu-1}\mcB^{\nu - 1})$ не зависит от $t$\\
Тогда $\det (\mcA - \mu\epsilon - t\mcB) \us{t = 1}= \det (\mcA - \mu\epsilon - \mcB) = \det (\mcD-\mu\epsilon)$\\
$\det((\mcA - \mu\epsilon)^{\nu - 1} + (\mcA - \mu\epsilon)^{\nu - 2}t\mcB + \ldots + t^{\nu-1}\mcB^{\nu - 1}) \us{t=0}= \det((\mcA - \mu\epsilon)^{\nu - 1})$\\
$(\chi_\mcA(\mu))^\nu = \ub{\chi_\mcD(\mu)}{\det (\mcD - \mu \epsilon)}\ub{\chi_\mcA(\mu)}{\det (\mcA - \mu \epsilon)^{\nu-1}}$\\
Отсюда $\chi_\mcA(\mu) = \chi_\mcD(\mu)$\\
$\chi_\mcA(\lambda) = \chi_\mcD(\lambda) = 0$\\
\textbf{Следствие 1}\\
$\det \mcA = \chi_\mcA(0) = \chi_\mcD(0) = \det \mcD$\\
\textbf{Следствие 2}\\
$\dim K_\lambda = \alpha(\lambda)$\\
\textbf{Доказательство}\\
$\alpha(\lambda)$ -- кратность корня в $\chi_\mcA \Rto $ в $\chi_\mcD$. А т.к. $\mcD$ -- о.п.с., то $\dim K_\lambda^\mcD = \dim V_\lambda^\mcD = \alpha(\lambda)$
\subsection{Жорданова форма матрицы. Жорданов базис. Функция от матрицы}
Пусть все корни $\chi(t)\in K$\\
$V = \bigoplus_\lambda K_\lambda$\\
$K_\lambda = \ker (\mcA - \lambda \epsilon)^{m(\lambda)}$\\
Построим в каждом $K_\lambda$ такой базис, что матрица оператора в нем будет иметь определенный вид. Этот вид и базис будут называться жордановыми\\
Пусть $K_\lambda =: K, m(\lambda) =: m, \mcB = (\mcA - \lambda \epsilon)\vl_{K_\lambda = K}$\\
Пусть $K_j = \ker (\mcA - \lambda \epsilon)^j, j = 1\ldots m$\\
$V_\lambda = K_1 \subset K_2 \subset \ldots \subset K_m = K_\lambda = K$\\
$K_r \neq K_{r+1}$\\
Пусть это не так\\
Тогда $\ker \mcB^r = \ker \mcB^{r+1}$\\
$\dim K = \rg \mcB^r + \dim K_r = \rg \mcB^{r+1} + \dim K_{r+1}$\\
Отсюда $\rg \mcB^r = \rg \mcB^{r+1}$\\
$\im \mcB^{r+1} \subset \im \mcB^r$\\
Т.о. $\im \mcB^{r+1} = \im \mcB^r$\\
Тогда $\im \mcB^r = \im \mcB^{r+1} = \ldots = \im \mcB^m = \0$, что противоречит минимальности $m$\\\\
Рассмотрим $K_1 \ldots K_m$\\
Найдем $j_m$ -- компоненту, которая лежит в $K_m$, но не лежит в $K_{m-1}$\\
$j_m \in K_m \setminus K_{m-1}$
$j_r := \mcB j_{r+1}, r = m-1\ldots 1$\\
Заметим, что $j_r \in K_r$\\
$j_r \in K_r = \ker \mcB^r$\\
$j_{r-1} = \mcB j_r$\\
$\mcB ^ {r-1} j_{r-1} = \mcB^r j_r = \0$\\
Отсюда $j_{r-1} \in K_{r-1} = \ker \mcB^{r-1}$\\
$Bj_1 = \0$\\
$\ub{\text{присоединенные вектора}}{j_1, \ldots, j_{m-1}}, j_m$ -- циклический базис, порожденный вектором $j_m$\\
Далее повторяем это для всех векторов $K_m, K_{m-1}, \ldots$\\
Максимальная длина циклического базиса, порожденного $j_r = r$\\
$j_1 \in V_\lambda$ -- собственном подпространстве\\
Линейное подпространство, порожденное $\span$ циклических базисов -- \textit{башня} высоты, равной длине циклического базиса\\
Башни образуют \textit{замок Жордана}\\
Ширина башни -- число циклических базисов в ней\\
Высота башни -- размер циклического базиса\\
Опорные вектора(фундамент башни) -- вектора $j_m$\\
Крыша башни -- вектора $j_1$\\
Крыша башна -- собственное подпространство\\
Башню рисуют опорными подпространствами как сверху, так и снизу\\
Если $\gamma(\lambda) = \alpha(\lambda)$, то $V_\lambda = K_\lambda$, то замок будет состоять из одной башни высоты 1\\
$K = K_\lambda = \span (\ldots, j_1, j_2, \ldots, j_m, \ldots)$ -- линейная оболочка всех векторов всех башен\\
$j_r = \mcB j_{r+1}$\\
$j_r = (\mcA - \lambda \epsilon)j_{r+1}$\\
$\mcA j_{r+1} = j_r + \lambda j_{r+1}$\\
$\begin{array}{l}
     \mcA j_1 = \lambda j_1\\
     \mcA j_2 = j_1 + \lambda j_2\\
     \vdots\\
     \mcA j_m = j_{m-1} + \lambda j_m
\end{array} \lrto J_m = \begin{pmatrix}
    \lambda & 1 & 0 & \ldots & 0\\
    0 & \lambda & 1 & \ldots & 0\\
    \vdots & \ddots & \ddots & \ddots & \vdots\\
    0 & \ddots & 0 & \lambda & 1\\
    0 & 0 & \ldots & 0 & \lambda
\end{pmatrix}$ -- клетка Жордана $m$-ого порядка (блок нижнего уровня)\\
Каждая клетка соответствует одному циклическому базису размера $m$\\
Рассмотрим теперь блочную матрицу $\nm{diag}(\ub{\text{блок среднего уровня}}{J_1, \ldots J_1}, \ldots, \ub{\text{блок среднего уровня}}{J_m, \ldots, J_m})$ -- блок верхнего уровня, отвечающий корневому подпространству $K_\lambda$\\
Каждый блок среднего уровня соответствует башне соответствующей высоты\\
Объединим все блоки вернего уровня всех корневых пространств в блочно-диагональную матрицу\\
Получим жорданов базис пространства $V$\\
Матрица $\mcA$ в этом базисе будет иметь блочно-диагональный вид, где на диагонали будут находиться клетки Жордана, отвечающие циклическим базисам -- Жорданова форма матрицы\\
$T_{e\rto j} = T = (\ldots, j_1, \ldots j_m, \ldots)\\$
$T^{-1}AT = J$\\
$J = \nm{diag}($блоки верхнего уровня всех корневых пространств$)$\\
\textbf{Обоснование алгоритма}\\
Пусть $\mcB K = \im \mcB$\\
$Z_0 = \mcB K$\\
$Z_r = \mcB K + K_r, r = 1\ldots m$\\
$Z_m = \mcB K + K_m = K$\\
$Z_0 \subseteq Z_1 \subseteq \ldots \subseteq Z_m$\\
$\ol K_1\subset K_1: Z_1 = Z_0 \oplus \ol K_1$\\
$\ol K_2\subset K_2: Z_2 = Z_1 \oplus \ol K_2$\\
$\ol K_r \subset K_r: Z_r = Z_{r-1}\oplus \ol K_r = K$\\
$K = \ol K_1 \oplus \ldots \oplus \ol K_m \oplus \mcB K$ (1)\\
$\ol K_j$ -- опорные подпространства\\
\textbf{Теорема}\\
$1 \leq r \leq m$\\
$\mcB^r K = \mcB^r \ol K_{r+1}\oplus \mcB^r \ol K_{r+2} \oplus \ldots \oplus \mcB^r \ol K_m \oplus \mcB^{r+1}K$\\
\textbf{Доказательство}\\
$K = \ol K_1 \oplus \ldots \oplus \ol K_m \oplus \mcB K$ (1)\\
$\fall x \in K:\ \ex! (x_i \in \ol K_j): x = x_1 + \ldots + x_m + \mcB x', x' \in K $\\
$\mcB^r x = \sum_{j=1}^m \mcB^r \ub{\in K_j = \ker \mcB^j}{x_j} + \mcB^{r+1}x' = \sum_{j=r+1}^m \mcB^r x_j +\mcB^{r+1}x' \in \sum_{j=r+1}^m \mcB^r \ol K_j + \mcB^{r+1}K$\\
Докажем дизъюнктность\\
$\sum_{j=r+1}^m \mcB^r x_j +\mcB^{r+1}x' = \0$\\
$\mcB^r\ub{\in K_r \subset Z_r \ol K_1 \oplus \ol K_r  \oplus \mcB K}{(\sum_{j=r+1}^m \ub{\in \ol K_j}{x_j} + \mcB x')}=\0$\\
$\sum_{j=r+1}^m \ub{\in \ol K_j}{x_j} + \mcB x' = \sum_{j=1}^m x_j + \mcB y'$\\
В силу единственности разложения и дизъюнктности $\ol K_j$ и $\mcB K$ $\fall j\ x_j = \0$\\
$\0 + \mcB^{r+1} = \0$ -- дизъюнктность\\\\
$K = \ol K_1 \oplus \ldots \oplus \ol K_m \oplus \mcB K$\\
$\mcB K = \mcB \ol K_2 \oplus \mcB \ol K_3 \oplus \ldots \oplus \mcB \ol K_m \oplus \mcB^2 K$\\
$\vdots$\\
$\mcB^{m-1}K = \mcB^{m-1}\ol K_m \oplus \ub{=\0}{\mcB^m K}$\\
Отсюда следствие\\
\textbf{Следствие}\\
$K = \ol K_1 \oplus \ldots \oplus \ol K_m \oplus \mcB \ol K_2 \oplus \ldots \oplus \mcB\ol K_m \oplus \mcB^3 \ol K_3 \oplus \ldots \oplus \mcB^3 \ol K_m \oplus \ldots \oplus \mcB^{m-1}\ol K_m$\\
Сумма представляется в виде пирамиды\\
\begin{tabular}{ccccc}
     & & & & $\ol K_m$\\
     & & & $\ol K_{m-1}$ & $\ol \mcB K_m$\\
     & & $\iddots$ & $\iddots$ & $\vdots$\\
     & $\ol K_2$ & \ldots & $\mcB^{m-3}\ol K_{m-1}$ & $\ol \mcB^{m-2} K_m$\\
     $\ol K_1$ & $\mcB \ol K_2$ & \ldots & $\mcB^{m-2}\ol K_{m-1}$ & $\ol \mcB^{m-1} K_m$\\
\end{tabular}\\
Данная таблица соответствует башням\\
$\mcB^{r-1}\ol K_r \subset V_\lambda$\\
$\mcB (\mcB^{r-1}\ol K_r) = \mcB^r \ol K^r = \-$\\
Отсюда $\mcB^{r-1}\ol K_r \subset \ker \mcB = V_\lambda$\\
Если $\ol K_r \neq \0$, то $J_r = \ol K_r \oplus \ldots \oplus \mcB^{r-1} \ol K_r$\\
$\ol K_r$ -- основание башни (опорное пространство, поорожденное $J_r$)\\
$V_\lambda = \ol K_1 \oplus \mcB \ol K_2 \oplus \ldots \oplus \mcB^{m-1} \ol K_m$ -- основание (1 этаж -- крыша)\\
Верхние клетки каждого этажа -- основание\\\\
$l$-ый этаж: $\ol K_l \oplus \mcB \ol K_{l+1} \oplus \ldots \oplus \mcB^{m-l}\ol K_m \subset K_l$\\
$\mcB^l (\mcB^j \ol K_{l+j}) = \mcB^{l+j}\ol K_{l-j} = \0, j = 0\ldots m-l$\\
Отсюда $\mcB^j\ol K_{l+j} \subset K_l$\\
Первые $j$ этажей соответствуют $K_j$\\
Отсюда каждый следующий этаж -- прямое дополнение предыдущих\\
\textbf{Теорема (о размерности башни)}\\
Все этажи башни имеют однинаковую размерность $d_r = \dim \ol K_r = \dim \mcB^j \ol K_r, j = 1 \ldots r-1$\\
\textbf{Доказательство}\\
Рассмотрим $\mcB^j$ (очевидно, что $\mcB^j$ -- эндоморфизм)\\
Докажем, что $\mcB^j$ -- изоморфизм, т.е.  сохраняет размерность, т.е. $\dim \ol K_r = \dim \mcB^j \ol K_r$\\
Для этого докажем тривиальность ядра\\
Пусть $x \in \ol K_r, \mcB^j (x) = \0$\\
Тогда $x \in \ker B^j = K^j$\\
$x \in \ol K_r \cap K^i, i = 1\ldots r-1$\\
$K_1, \ldots, K_{r-1}$ дизъюнктны с $\ol K_r$\\
Т.о. $x = \0$\\
Тогда ядро тривиально, ч.т.д.\\
\textbf{Следствие}\\
$\dim V_\lambda = \gamma(\lambda) = \sum_{r=1}^m d_r$\\
$\dim K_\lambda = \alpha(\lambda) = \sum_{r=1}^m r d_r$\\
\textbf{Следствие 2 (теорема Фробениуса)}\\
$\fall r = 1\ldots m\ d_r = \rg \mcB^{r-1} - 2\rg \mcB^r + \rg \mcB^{r+1}$\\
(при $r = m\ d_m = \rg \mcB^{m-1}$)\\
\textbf{Доказательство}\\
$\rho_j = \rg \mcB^j$\\
$\ub{\im \mcB^j}{\mcB^j K} = \ub{d_{j+1}}{\mcB^j \ol K_{j+1}} \oplus \ldots \oplus \ub{d_m}{\mcB^j \ol K_{m}} \oplus \ub{\im \mcB^{j+1}}{\mcB^{j+1}K}$\\
$\rho_j = d_{j+1} + \ldots + d_m + \rho_{j+1}$\\
$\rho_j-\rho_{j+1} = d_{j+1}+\ldots+d_m$\\
$\rho_0 = \rg \mcB^0 = \rg \epsilon = \dim K_\lambda = \alpha(\lambda)$\\
$d_1 + \ldots + d_m = \rho_0 - \rho_1$\\
$\vdots$\\
$d_{n-1}+d_m = \rho_{m-2}-\rho_{m-1}$\\
$d_m =\rho_{m-1}-\rho_m$\\
Отсюда $d_r = \rho_{r-1}-2\rho_r + \rho_{r+1}$\\
$d_m = \rho_{m-1}+0+0$\\
\textbf{Замечание}\\
На практике удобнее\\
$\rho \mcB^j = \dim K_\lambda - \dim K_j$\\\\
Рассмотрим башню\\
$\dim \ol K_r = d_r = d$\\
$\ol K_r = \span (g_1, \ldots, g_d)$\\
\begin{tabular}{c|cccc}
    $\ol K_r$ & $g_1$ & $g_2$ & $\ldots$ & $g_d$ \\
    $\mcB \ol K_r$ & $\mcB g_1$ & $\mcB g_2$ & $\ldots$ & $\mcB g_d$ \\
    $\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ & $\vdots$\\
    $\mcB^{r-1}\ol K_r$ & $\mcB^{r-1} g_1$ & $\mcB^{r-1} g_2$ & $\ldots$ & $\mcB^{r-1} g_d$\\
\end{tabular}
$\mcB^j$ -- изоморфизм, т.е. базис переходит в базис\\
$\mcB^j g_1 \ldots \mcB^j g_d$ -- базис $\mcB^j \ol K^r$ -- циклический базис\\
Тогда $J_r = \bigoplus_{i=1}^d \span (\mcB^{r-1} g_i, \ldots, \mcB g_i, g_i)$\\
$\mcA(\mcB^j g_i) = (\mcB + \lambda\epsilon)\mcB^j g_i = \mcB^{j+1}g_i + \lambda \mcB^j g_i$\\
$\mcA\vl_{\span (\mcB^{r-1} g_i, \ldots, \mcB g_i, g_i)} \us{\text{в цикл.базисе}}\lrto J_r$ -- клетка Жордана размерности $r\times r$ -- блок нижнего уровн\\
$\mcA\vl_{J_i} \lrto \nm{diag}(\ub{\text{$d_r$ штук}}{J_r(\lambda), \ldots, J_r(\lambda)}) = \mc T_{J_r}(\lambda)$\\
$\mcA\vl_{K = \bigoplus_{r=1}^m J_r} \lrto \nm{diag}(\mc T_{J_1}(\lambda), \ldots, \mc T_{J_m}(\lambda)) = \mc J(\lambda)$\\
$\mcA \lrto \nm{diag}(\mc J(\lambda_1), \mc J(\lambda_2), \ldots) = \mc J_A = \mc J$\\
//todo 13:11 16.03
\subsection{Функция от матрицы, приводимой к жордановой форме}
Пусть $f(x) = \sum_{k=0}^\infty c_k x^k, |x| < R$\\
$f(A) = \sum_{k=0}^\infty c_k A^k$\\
$\letus T(j_1, \ldots, j_n), A=T\mcJ T^{-1}$\\
Пусть $\mcJ = \nm{diag}(\mcJ_1, \ldots, \mcJ_n)$
Тогда $\mcJ^k = \nm{diag}(\mcJ(\lambda_1)^k, \ldots, \mcJ(\lambda_n)^k)$\\
$A^k = T\nm{diag}(\mcJ(\lambda_1)^k, \ldots, \mcJ(\lambda_n)^k)T^{-1}$\\
$f(A) = T\nm{diag}(f(\mcJ(\lambda_1)), \ldots, f(\mcJ(\lambda_n)))T^{-1}$\\
$J_r = \begin{pmatrix}
    \lambda & 1 & 0 & \ldots & 0\\
    0 & \lambda & 1 & \ldots & 0\\
    \vdots & \ddots & \ddots & \ddots & \vdots\\
    0 & \ddots & 0 & \lambda & 1\\
    0 & 0 & \ldots & 0 & \lambda
\end{pmatrix} = \lambda E_{r\times r} + I_r, I_r = \begin{pmatrix}
    0 & 1 & 0 & \ldots & 0\\
    0 & 0 & 1 & \ldots & 0\\
    \vdots & \ddots & \ddots & \ddots & \vdots\\
    0 & \ddots & 0 & 0 & 1\\
    0 & 0 & \ldots & 0 & 0
\end{pmatrix}$\\
$I_r^2 = \begin{pmatrix}
    0 & 0 & 1 & 0 & \ldots & 0\\
    0 & 0 & 0 & 1 & \ldots & 0\\
    \vdots & \ddots & \ddots & \ddots & \ddots & \vdots\\
    0 & \ddots & 0 & 0 & 0 & 1\\
    0 & 0 & \ldots & 0 & 0 & 0\\
    0 & 0 & \ldots & 0 & 0 & 0
\end{pmatrix}$\\
Т.е. ряд единиц "уезжает вверх"\\
Отсюда $J_r^k = (\lambda E_{r\times r} + I_r)^k = \sum_{m=0}^k C_k^m \lambda ^{k-m} I_r^m = C_k^0\begin{pmatrix}
    \lambda^k & 0 & 0 & \ldots & 0\\
    0 & \lambda^k & 0 & \ldots & 0\\
    \vdots & \ddots & \ddots & \ddots & \vdots\\
    0 & \ddots & 0 & \lambda^k & 0\\
    0 & 0 & \ldots & 0 & \lambda^k
\end{pmatrix} + C_k^1 \begin{pmatrix}
    0 & \lambda^{k-1} & 0 & \ldots & 0\\
    0 & 0 & \lambda^{k-1} & \ldots & 0\\
    \vdots & \ddots & \ddots & \ddots & \vdots\\
    0 & \ddots & 0 & 0 & \lambda^{k-1}\\
    0 & 0 & \ldots & 0 & 0
\end{pmatrix} + \ldots\\ = \begin{pmatrix}
    C_k^0\lambda^k & C_k^1\lambda^{k-1} & C_k^2\lambda^{k-2} & \ldots & C_k^{k-r+1}\lambda^{k-r+1} & 0 & 0 & \ldots 0\\
    0 & C_k^0\lambda^k & C_k^1\lambda^{k-1} & C_k^2\lambda^{k-2} & \ldots & C_k^{k-r+1}\lambda^{k-r+1} & 0 & \ldots & 0\\
    0 & 0 & \ddots & \ddots & \ddots & \ddots & \ddots & \ddots & \ddots\\
\end{pmatrix}$\\
//todo 23.03 10:27
\section{Черная магия}
$(\ln |x|)' = \frac1x$\\
Отсюда $(\ln |y|)' = \frac{y'}{y}$\\
$y' = y (\ln |y|)'$ (удобно)
\section{Тензоры}
\subsection{Линейные формы. Сопряженное пространство. Ковариантные и контрвариантные преобразования}
$V$ -- линейное пространство над $K(\Rset, \Cset)$\\
\textbf{Определение}\\
Линейная функция $f:V\rto K$ называется \textit{линейной формой(линейным функционалом)}\\
Т.е. $f(x_1 + \lambda x_2) = f(x_1) + \lambda f(x_2)$\\
\textbf{Пример}
\begin{enumerate}
    \item Скалярное умножение на фиксированный вектор
    \item $A_{n\times n}, f:M_{n\times n} \rto \Rset(\Cset)$\\
    $f(A) = \tr A$
    \item $P_n, t_0 \in \Rset$\\
    Пусть $f^j = P_n \rto \Rset, f^j(p) = \frac{p^{(j)}(t)}{j!}(t_0)$\\
    Тогда $f^0, f^1, \ldots$ -- линейная форма
    \item $f: \ub{\text{функции, непрерывные на }\Rset}C(\Rset) \rto \Rset$\\
    $\delta(f) := f(0)$ -- $\delta$-функция Дирака\\
    $\delta(f)$ -- линейная форма на бесконечномерном пространстве
\end{enumerate}
$n:=\dim V$\\
$V^* = \{ f: V \rto K\, f \text{ -- линейнаяя форма}\}$\\
$\0(x) := 0, \0 \in V^*$\\
$\fall f\in V^*\ (-f)\in V^*$\\
Тогда $V^*$ -- линейное пространство над полем $K$\\
$V^*$ -- \textit{сопряженное(дуальное)} к $V$\\\\
Вспоминаем правило Эйнштейна\\
Выражение $\alpha^i\beta_i := \sum_{i}\alpha_i\beta_i$\\
иначе: $\alpha^i := \alpha_i$\\\\
$f\in V^*\\ \fall x \in V\ f(x) = f(x^i e_i) = x^i \ub{a_i \in K}{f(e_i)}$\\
$a:= f(e_i)$ называется \textit{коэффициентами линейной формы} $f$\\
Тогда $f(x) = x^i a_i$ -- $f$ полностью описывается значениями на базисных элементах\\
Тогда $f \lrto a = \begin{pmatrix}
    a_1 & a_2 & \ldots & a_n
\end{pmatrix}$ -- зависит от выбора базиса\\
Сопоставление -- изоморфизм\\
\textbf{Фанфакт}\\
\textit{Естественный изоморфизм} -- изоморфизм, который не зависит от выбора базиса. Но это не наш случай\\
$V^* \cong K_n (K^n)$ -- пространство $n$-мерных строк\\
\textbf{Определение}\\
$\omega^i \in V^*, x = x^i e_i$\\
$\fall x\in V \omega^i (x)=x_i$ -- координатные функции\\
(очевидно, что $\omega^i \in V^*, w^i(x_1+\lambda x_2) = x_1^i + \lambda x_2^i$)\\
$w^i (e_j) = \delta_j^i = +(i == j) \lrto \begin{pmatrix}
    0 & 0 & \ldots & \ub{i}1 & \ldots & 0
\end{pmatrix}$\\
\textbf{Теорема}\\
$\omega^1, \ldots, \omega^n$ -- базис $V^*$\\
\textbf{Доказательство}\\
$\omega^1, \ldots, \omega^n$ -- линейно независимые\\
$\alpha_i \omega^i = \0$\\
$\alpha_i \in K$\\
$j=1\ldots n\ \alpha_i\omega^i(e_j)=\alpha_i \delta_j^i = \alpha_j \Rto \alpha_j = 0 \Rto $ линейно независимые\\
$\dim V^* = n \Rto $ базис\\
\textbf{Следствие}\\
$a_i$ -- координаты $f$ в базисе $\omega^1\dots\omega^n$\\
\textbf{Доказательство}\\
$f(x)=x^ia_i = \omega^i(x)a_i \LRto f=a_i\omega^i$\\
\textbf{Определение}\\
$\omega=\begin{pmatrix}
    \omega^1 & \ldots & \omega^n
\end{pmatrix}$ называется \textit{сопряженным(дуальным)} базисом к базису $e$ пространства $V$\\\\
Вопрос: есть другой базис в $V^*$. Будет ли он сопряженным к некоторому базису $V$\\
\textbf{Теорема}\\
$\omega'^1, \ldots, \omega'^n$ -- базис $V^*$\\
Тогда $\ex e'_1, \ldots, e'_n$ -- базис в $V$ такой, что $\omega'$ сопряжен с $e'$\\
\textbf{Доказательство}\\
Пусть $e'_1, \ldots, e'_n$ -- базис в $V$\\
Базис $V\ \omega^1, \ldots, \omega^n$ сопряжен с $e$\\
$\omega'^1, \ldots, \omega'^n$ -- базис $V^* \Rto \begin{pmatrix}
    \omega'^1 & \ldots & \omega'^n
\end{pmatrix} = \begin{pmatrix}
    \omega^1 & \ldots & \omega^n
\end{pmatrix}T_{\omega \rto \omega'}$\\
$\begin{pmatrix}
    \omega'^1\\\vdots\\\omega'^n
\end{pmatrix} = \ub{=:S_{\omega \rto \omega'}}{T_{\omega \rto \omega'}^T}\begin{pmatrix}
    \omega^1\\\vdots\\\omega^n
\end{pmatrix}$\\
Построим новый базис $e'$\\
$T_{e\rto e'} = S^{-1} = T$\\
$\begin{pmatrix}
    e_1' & \ldots & e_n'
\end{pmatrix}:= \begin{pmatrix}
    e_1 & \ldots & e_n
\end{pmatrix}T$ -- тоже базис по определению\\
Покажем, что $\omega'$ сопряжен к $e'$, т.е. $\omega'^i$ -- координатные функции по отношению к $e'$\\
Пусть $s^i_j = s_{ij}, t^i_j = t_{ij}$\\
$\fall x\in V\ \omega'^i(x) = s^i_k\omega^k(x) = s^i_k x^k = \ub{\ub{E}{(ST)_j^i} = \delta_j^i}{s^i_k t_j^k} x'^i = \delta^i_j x'^j = x'^i$\\
Отсюда $\omega'^i$ -- координатная функция $\Rto$ базис сопряженный\\
\textbf{Замечание}\\
Вообще говоря, базис $e'$ существует и единственный (очевидно из доказательства)\\
\textbf{Следствие}\\
$\begin{pmatrix}
    \omega'^1\\\vdots\\\omega'^n
\end{pmatrix} = S\begin{pmatrix}
    \omega^1\\\vdots\\\omega^n
\end{pmatrix}, S = T_{\omega \rto \omega'}^T$\\
Тогда $a'=aT$\\
$T = S^{-1} = T_{e\rto e'}$\\
$x'=Sx$\\
\textbf{Доказательство}\\
$X' = SX$ очевидно($X=TX'=S^{-1}X'$)\\
$\begin{pmatrix}
    \omega'^1 & \ldots & \omega'^n
\end{pmatrix} = \begin{pmatrix}
    \omega^1 & \ldots & \omega^n
\end{pmatrix} T_{\omega \rto \omega'}$\\
$a^T = T_{\omega\rto \omega'}(a')^T$
$a=a'T^T_{\omega\rto\omega'} = a'S \LRto a'=aS^{-1}aT$\\\\
\textbf{Определение}\\
Если координаты вектора при смене базиса изменяются по тому же закону(т.е. с той же матрицей), что и сам базис, то такой закон называется \textit{ковариантным(согласованным)}, координаты вектора называются \textit{ковариантными} координатами, а сам вектор называется \textit{ковариантным} или \textit{ковектором}\\
Элементы $V^*$ -- это ковекторы (линейная форма $\equiv$ ковектор)\\
В противном случае, если координаты вектора при смене базиса изменяются по закону, провоположному(т.е. с обратной матрицей) тому, по которому сам базис, то такой вектор называется \textit{контрвариантным}, координаты -- \textit{контрвариантными}, вектор -- \textit{контровариантным} или просто вектором\\
Элементы $V$ -- контрвариантные векторы\\
Принято писать индекс координаты контрвектора сверзу, а ковариантного -- снизу\\\\
$\fall f \in V^*, x\in V\ f(x) = x'ia'_i = s^i_k x^k a_m t^m_i = \ub{\delta^m_k}{t^m_i s^i_k} x^k a_m = x^ka_k$\\
Т.о. форма записи $f$ -- инвариант относительно замены базиса\\
\textbf{Определение}\\
$V^{**} = (V^*)^*$\\
$\dim V^{**} = \dim V^* = \dim V$ -- можем построить изоморфизм между $V$ и $V^{**}$\\
\textbf{Теорема 3 (естественный изоморфизм $V$ и $V^{**}$)}\\
\textit{Вместо обозначения "x" буду использовать <x>}\\
$\fall x \in V \rto <x>\in V^{**}$\\
$\fall f \in V^* <x>(f)=f(x)$\\
Отсюда $x \lrto <x>$\\
$V\cong V^{**}$\\
\textbf{Доказательство}\\
$\fall f_1, f_2 \in V^*, \lambda \in K\ <x>(f_1+\lambda f_2) = (f_1 + \lambda f_2)(x) = f_1(x) + \lambda f_2(x) = <x>(f_1) + \lambda <x>(f_2)$\\
Отсюда $<x> \in (V^*)^*$\\
Покажем, что $V$ линейно вложено в $V^{**}$, т.е. $x \in V \rto <x> \in V^{**}$\\
//todo 12:00 23.03\\
Покажем, что базис $V\ e_1, \ldots e_n$ перейдет в базис $V^{**}$\\
$e_j \rto <e_j>$\\
$\fall f\in V^* <e_j>(f) = f(e_j) = a_j$ -- координата $f$ в базисе $\omega^1, \ldots \omega_n$, сопр. с $e$\\
Т.о. $<e_j>$ -- координатная функция в пространстве $V^*$ относительно $\omega^1, \ldots \omega_n$\\
Т.о. по теореме 1 координатные функции -- базис сопряженного пространства\\
Т.о. $<e_j>$ -- базис $V^{**}$\\
Базис $V\ e_1,\ldots, e_n \rto$ базис $V^{**} <e_1>, \ldots, <e_n>$\\
Т.о. отображение линейно, то изоморфизм\\
\textbf{Замечание}
\begin{enumerate}
    \item принято отождествлять элементы $V$ и $V^{**}$ с помощью изоморфизма, описанного в теореме 3\\
    Поэтому $<>$ не пишут\\
    $\fall f\in V^*, x\in V\ f(x)=a_ix^i = f(e_i)x^i = e_i(f)x^i = x(f)$\\
    $a_i = f(e_i)$\\
    $x^i = x(\omega^i)$
    \item $\omega^i(e_j) = \delta_j^i = e_j(\omega^i)$\\
    Как найти на практике?\\
    $e_1, \ldots, e_n \lrto \begin{pmatrix}\vdots\end{pmatrix}\ldots\begin{pmatrix}\vdots\end{pmatrix}$ -- столбцы\\
    $w^i(e_j)=\ub a{\begin{pmatrix}\ldots\end{pmatrix}}\ub x{\begin{pmatrix}\vdots\end{pmatrix}} = \delta_j^i$\\
    Отсюда $\ub{S=T^{-1}}{\begin{pmatrix}
        \omega^1\\\vdots\\\omega^n
    \end{pmatrix}}\ub{T}{\begin{pmatrix}e_1 & \ldots & e_n\end{pmatrix}} = E$
    \item Т.о. понятие сопряженного пространства и сопряженного базиса дуальны\\
    $\omega$ сопряженный базис к $e$\\
    $e$ сопряженный базис к $\omega$\\
    (здесь подразумевается элементы $V^{**}$)
    \item Задача о построении проекторов (разложение элемента на проекции)\\
    $V = \bigoplus_\lambda V_\lambda$\\
    $\fall x \in V\ \ex! x = \sum_\lambda x_\lambda, x_\lambda \in V_\lambda$\\
    $\rho_\lambda: V\rto V, \im \rho_\lambda = V_\lambda, \sum_\lambda \rho_\lambda = \epsilon$\\
    $\fall x \in V\ \rho x := x_\lambda, \ub{\lambda\neq \mu}{\rho_\lambda\rho\mu} = 0$\\
    $v_1,\ldots, v_n$ -- базис $V$ = объединение базисов $V_\lambda$\\
    $x = x^i v_i = \sum_\lambda \ub{x_\lambda}{\sum_{m_\lambda} x^{m_\lambda}v_{m_\lambda}} = \omega^1, \ldots, \omega^n$ -- сопряженный базис $= \sum_\lambda \sum_{m_\lambda}\omega^{m_\lambda}(x)v_{m_\lambda}$\\
    $\omega^{m_\lambda} \lrto (a^{m_\lambda}_i)_i$ -- строка\\
    $x \lrto X$\\
    $\omega^{m_\lambda} (x) = a^{m_\lambda}X$\\
    $v_{m_\lambda} \lrto (V_{m_\lambda, i})_i$ -- столбец\\
    $x = \sum_\lambda \sum_{m_\lambda}V_{m_\lambda}a^{m_\lambda}X = \sum_\lambda \ub{\rho_\lambda}{(\sum_{m_\lambda} V_{m_\lambda}a^{m_\lambda})}X = \sum_\lambda (\sum_{m_\lambda} \ub{\omega^{m_\lambda}(x)}{(a^{m_\lambda}x)} V_{m_\lambda})$\\
\end{enumerate}
\subsection{Два определения тензора. Линейное пространство тензоров. Многомерная матрица}
\textbf{Определение}\\
$V, V^*$ -- сопряженные линейные пространства над полем $K(\Rset, \Cset)$\\
$f: V^p\times (V^*)^q \rto K, p, q \geq 0$ -- линейная по каждому аргументу\\
$f$ -- тензор порядка $(p,q)$ или $p$ раз ковариантом, $q$ раз контрвариантным\\
Множество таких функций обозначим $T_{(p,q)}$\\
$p,q$ -- \textit{валентности}\\
$r = p+q$ -- полная валентность/ранг тензора (не наш $\rg$)\\
$f \in T_{p,0}$ -- ковариантный тензор валентности $p$\\
$f \in T_{0,q}$ -- контрвариантный тензор валентности $q$\\
$r = 0$ -- тензор нулевого ранга. $f = \const \in K$\\
\textbf{Пример}\\
$\ub{V}{x \in \Rset^n}$ -- столбец\\
$\ub{V^*}{a \in \Rset_n}$ -- строка\\
$f(x,a) = ax \in \Rset, f \in T_{(1,1)}$\\\\
$\0$ -- нулевой тензор\\
$\fall \xi_1, \ldots, \xi_p \in V, \nu^1, \ldots, \nu^p \in V^*\ 0(\xi_1, \ldots, \xi_p, \nu^1,\ldots,\nu^q) = 0$\\
$\fall f \in T_{(p,q)}\ -f \in T_{(p,q)}$\\
$T_{(p,q)}$ -- линейное пространство\\\\
$e_1, \ldots, e_n$ -- базис $V$\\
$\omega^1, \ldots, \omega^n$ -- базис $V^*$\\
$e, \omega$ -- сопряженные\\
Для $\xi \in V\ \xi = \xi^i e_j$\\
Для $\nu \in V^*\ \nu = \nu_i \omega^j$\\
Тогда $f(\xi_1, \ldots, \xi_p, \nu^1, \ldots, \nu^q) = f(\xi_1^{j_1} e_{j_1}, \ldots, \xi_p^{j_p}e_{j_p}, \nu^1_{i_1}\omega^{i_1}, \ldots, \nu^q_{i_q}\omega^{i_p})\\ = \xi_1^{j_1}\ldots\xi_p^{j_p}\nu^1_{i_1}\ldots\nu^q_{i_q}f(e_{j_1},\ldots,e_{j_p},\omega^1,\ldots,\omega^{i_q})$ -- любой тензор определяется значениями на всевозможных наборах $e_j, \omega^i$\\
$\alpha_{j_1, \ldots, j_p}^{i_1, \ldots, i_q} := f(e_{j_1}, \ldots, e_{j_p},\omega^{i_1}, \ldots, \omega^{i_q})$ -- коэффициенты тензона $f$ относительно базисов $e, \omega$\\
$f(\xi_1, \ldots, \xi_p, \nu^1, \ldots, \nu^q)=\xi_1^{j_1}\ldots\xi_p^{j_p}\nu^1_{i_1}\ldots\nu^q_{i_q}\alpha_{j_1, \ldots, j_p}^{i_1, \ldots, i_q}$\\
\textbf{Определение}\\
$S$ -- множество элементов, записанных с помощью двух типов индексов $s_{j_1, \ldots, j_p}^{i_1, \ldots, i_q}$, где $i_k, j_m \in (1,\ldots n)$ называется $p+q$-мерной матрицей порядка $n$\\
\textbf{Пример}\\
$n = 3$, трехмерная матрица
\begin{enumerate}
    \item $S^{ijk}$
    \item $S^{ij}_k$
    \item $S^i_{jk}$
    \item $S_{ijk}$
\end{enumerate}
$f \lrto \alpha = (\alpha_{j_1, \ldots, j_p}^{i_1, \ldots, i_q})$ -- изоморфизм\\
$T_{(p,q)} \cong S_(p+q)$\\
\textbf{Правило записи элементов тензора в многомерной записи}\\
В $\alpha_{j_1, \ldots, j_p}^{i_1, \ldots, i_q}$ сначала читаются верхние индексы, потом нижние индексы\\
Для двумерных матриц:
\begin{enumerate}
    \item строка
    \item столбец
\end{enumerate}
Для трехмерных матриц:
\begin{enumerate}
    \item строка
    \item столбец
    \item слой
\end{enumerate}
Запись: $\left(\begin{array}{cc|cc|cc}
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot\\
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot
\end{array}\right)$\\
Для четырехмерных матриц:
\begin{enumerate}
    \item строка
    \item столбец
    \item слой
    \item срез
\end{enumerate}
Запись: $\left(\begin{array}{cc|cc|cc}
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot\\
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot\\
    \hline\\
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot\\
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot\\
    \hline\\
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot\\
    \cdot & \cdot & \cdot & \cdot & \cdot & \cdot
\end{array}\right)$\\
//todo 11:59 30.03\\
$\fall \xi \in V\ \xi = \xi^i e_i = \xi^{ij}e^i_j$\\
$\xi^i = t^i_j \xi'^j$\\
$\fall \eta \in V^*\ \eta=\eta_i \omega^i =n'_j \omega'^j$\\
$\eta_i = s_i^j \eta'_j$\\
$\fall \xi_1, \ldots, \xi_p \in V, \eta^1,\ldots,\eta^q \in V^* f(\xi_1, \ldots, \xi_p, \eta^1, \ldotp, \eta^q) = \alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} \xi_1^{j_1}\cdot \ldots \cdot \xi_p^{j_p} \eta_{i_1}^1\cdot\ldots\cdot \eta_{i_q}^q = \alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} t_{u_1}^{j_1}\xi_1'^{u_1} \cdot \ldots \cdot t_{u_p}^{j_p}\xi_p'^{u_p} \cdot s_{i_1}^{r_1}\eta'^1_{r_1} \cdot \ldots\cdot s_{i_q}^{r_q}\eta'^1_{r_q}$\\
$\alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} t_{u_1}^{j_1}\cdot\ldots\cdot t_{u_p}^{j_p} s_{i_1}^{r_1} \cdot \ldots \cdot s_{i_q}^{r_q} = \alpha'^{r_1, \ldots, r_q}_{u_1, \ldotp, u_p}$\\
$f('e_{u_1}, \ldots, e'_{u_p}, \omega'^{r_1},\ldots, \omega'^{r_q}) = \alpha'^{r_1, \ldots, r_q}_{u_1, \ldotp, u_p}$\\
Нижние индексы -- ковариантные, т.к. при смене базиса соответствующая координата пересчитывается по ковариантному закону (т.е. через $T$)\\
Верхние индексы -- контрвариантные\\
\textbf{Пример}\\
$\fall x \in V \cong V^{**}, x$ -- линейное отображение\\
$x \lrto \begin{pmatrix}
    \alpha^1\\\vdots\\\alpha^n
\end{pmatrix} = \alpha, x \in T_{(0,1)}$\\
$\alpha'^r = \alpha^i s^r_i$\\
$\alpha' = S\alpha \Rto \alpha=T\alpha'$\\
$\fall f \in V^*, f$ -- линейное отображение\\
$f \lrto a=\begin{pmatrix}
    a_1 & \ldots & a_n
\end{pmatrix}, f \in T_{(0,1)}$\\
$a'_u = a_j t_u^j$\\
$a' = aT \Rto a=a'S$\\
\textbf{Определение 2}\\
Геометрический объект на линейном пространстве $V$ над полем $K$, описываемый $p+q$-мерной матрицей размерности $n(т = \dim V)$ с элементами из поля $K$, которая при смене пространства $V$ пересчитывается по формуле $\alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} t_{u_1}^{j_1}\cdot\ldots\cdot t_{u_p}^{j_p} s_{i_1}^{r_1} \cdot \ldots \cdot s_{i_q}^{r_q} = \alpha'^{r_1, \ldots, r_q}_{u_1, \ldotp, u_p}$, где $(t_j^i) = T_{e\rto e'}, S = T^{-1}$, называется тензором типа $(p,q)$ или $p$ раз ковариантным и $q$ раз контрвариантным\\\\
Пусть $\0$ -- нулевая матрица, $-\alpha$ -- противоположная матрица, задано умножение на скаляр и сложение\\
Докажем, что $+$ и $\lambda \cdot$ сохраняют свойство тензоров\\
$\alpha, \beta \in T_{(p,q)}, \fall \lambda \in K$\\
$(\alpha + \lambda \beta)_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} = \alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} + \lambda\beta_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} $\\
$(\alpha + \lambda\beta)'^{r_1, \ldots, r_q}_{u_1, \ldotp, u_p} = (\alpha + \lambda \beta)_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} t_{u_1}^{j_1}\ldots t_{u_p}^{j_p}s_{i_1}^{r_1}\ldots s_{u_q}^{r_q} = \alpha'^{r_1, \ldots, r_q}_{u_1, \ldotp, u_p} + \lambda\beta'^{r_1, \ldots, r_q}_{u_1, \ldotp, u_p}$ -- верно
\subsection{Произведение тензоров. Базис пространства тензоров. Свойства тензоров}
\textbf{Определение}\\
$\alpha \in T_{(p_1, q_1)}$\\
$\beta \in T_{(p_2, q_2)}$\\
$\gamma = \alpha \otimes \beta \in T_{(p_1+q_1, p_2+q_2)}$\\
$\gamma_{j_1,\ldots,j_{p_1},m_1, \ldots, m_{p_2}}^{i_1,\ldots, i_{q_1},k_1,\ldots,k_{q_2}} = \alpha_{j_1, \ldotp, j_{p_1}}^{i_1, \ldots, i_{q_1}}\beta_{m_1, \ldotp, m_{p_2}}^{k_1, \ldots, k_{q_2}}$\\
\textbf{Доказательство корректности произведения}\\
$\gamma'^{r_1 \ldots r_{q_1} \sigma_1 \ldots \sigma_{q_2}}_{u_1\ldots u_{p_1}v_1\ldots v_{p_2}} = \gamma_{j_1,\ldots,j_{p_1},m_1, \ldots, m_{p_2}}^{i_1,\ldots, i_{q_1},k_1,\ldots,k_{q_2}} t_{u_1}^{j_1}\ldots t_{v_{p_2}}^{m_{p_2}} s_{i_1}^{r_1}\ldots s_{k_{q_2}}^{\sigma_{q_2}}$\\
$ = \alpha_{j_1, \ldotp, j_{p_1}}^{i_1, \ldots, i_{q_1}}t_{u_1}^{j_1}\ldots t_{u_{p_1}}^{j_{p_1}}s_{i_1}^{r_1}\ldots s_{r_{q_1}}^{r_{q_1}}\beta_{m_1, \ldotp, m_{p_2}}^{k_1, \ldots, k_{q_2}}t_{v_1}^{m_1}\ldots t_{v_{p_2}}^{m_{p_2}}s_{k_1}^{\sigma_1}\ldots s_{k_{q_2}}^{\sigma_{q_2}}$\\
$ = \alpha'^{r_1, \ldots, r_{q_1}}_{u_1, \ldotp, u_{p_1}}\beta'^{\sigma_1, \ldots, \sigma_{q_2}}_{v_1, \ldotp, v_{p_2}}$\\
\textbf{Замечание}
\begin{enumerate}
    \item $\lambda \in K \lrto \lambda \in T_{(0,0)}$\\
    $\fall \alpha \in T_{(p,q)}\ \lambda \otimes \alpha = \lambda\alpha$
    \item $\oplus$ ассоциативно, не коммутативно, дистрибутивно по сложению
\end{enumerate}
$\alpha \in T_{(p_1, q_1)} \us{e_1, \ldots, e_n}\lrto f: V^{p_1}\times (V^*)^{q_1} \rto K$ -- полилинейная\\
$\beta \in T_{(p_2, q_2)} \us{e_1, \ldots, e_n}\lrto f: V^{p_2}\times (V^*)^{q_2} \rto K$ -- полилинейная\\
Тогда $\gamma = \alpha \otimes \beta \in T_{(p_1 + p_2, q_1 + q_2)} \lrto t: V^{p_1+p_2}\times (V^*)^{q_1+q_2} \rto R$\\
$\fall \xi_1, \ldots, \xi_{p_1}, \zeta_1,\ldots, \zeta_{p_2} \in V$\\
$\fall \eta^1,\ldots, \eta^{q_1}, \theta^1,\ldots, \theta^{q_2} \in V^*$\\
$t(\xi_1, \ldots, \xi_{p_1}, \zeta_1,\ldots, \zeta_{p_2}, \eta^1,\ldots, \eta^{q_1}, \theta^1,\ldots, \theta^{q_2})$\\
$ = \gamma_{j_1,\ldots,j_{p_1},m_1, \ldots, m_{p_2}}^{i_1,\ldots, i_{q_1},k_1,\ldots,k_{q_2}} \xi_1^{j_1}\ldots \xi_{p_1}^{j_{p_1}}\zeta_1^{m_1}\ldots \zeta_{p_2}^{m_p}\eta_{i_1}\ldots \eta_{i_{q_1}}^{q_1}\theta_{k_1}^1\ldots k_{q_2}^{q_2}$\\
$=\alpha_{j_1, \ldotp, j_{p_1}}^{i_1, \ldots, i_{q_1}}\xi_1^{j_1}\ldots \xi_{p_1}^{j_{p_1}}\eta_{i_1}\ldots \eta_{i_{q_1}}^{q_1}\beta_{m_1, \ldotp, m_{p_2}}^{k_1, \ldots, k_{q_2}}\zeta_1^{m_1}\ldots \zeta_{p_2}^{m_p}\theta_{k_1}^1\ldots k_{q_2}^{q_2}$\\
$= f(\xi_1, \ldots, \xi_{p_1},\eta^1,\ldots, \eta^{q_1})g(\zeta_1,\ldots, \zeta_{p_2}, \theta^1,\ldots, \theta^{q_2})$\\
Отсюда $\gamma = \alpha \otimes \beta \lrto t=fg$\\
В частности:\\
$\fall f^1,\ldots,f^p \in V^*, g_1, \ldots, g_q \in V\ f^1 \otimes \ldots \otimes f^p \otimes g_1 \otimes \ldots \otimes g_q(\xi_1,\ldots,\xi_p, \eta^1,\ldots,\eta^q) = f^1(\eta_1)\ldots f^p(\eta_p)g_1(\eta^n)\ldots g_q(\eta^q)$\\\\
Пусть $e_1, \ldots, e_n$ -- базис $V$\\
$\omega^1, \ldots, \omega^n$ -- базис $V^*$\\
$\omega^{j_1}\otimes \ldots \otimes \omega^{j_p} \otimes e_{i_1}\otimes\ldots \otimes e_{i_q} (\xi_1,\ldots, \xi_p, \eta^1,\ldots, \eta^q) = \xi_1{j_1},\ldots, \xi_p^{j_p}, \eta^1_{i_1},\ldots, \eta^q_{i_q}$\\
\textbf{Теорема о базисе пространства тензоров}\\
Набор тензоров $\omega^{j_1}\otimes \ldots \otimes \omega^{j_p} \otimes e_{i_1} \otimes \ldots \otimes e_{i_q}$ по всем возможным $i, j$ -- базис $T_{(p,q)}$\\
\textbf{Доказательство}\\
$\omega^j \in T_{(1,0)}, e_i \in T_{(0,1)}$\\
$\{\omega^{j_1}\otimes \ldots \otimes \omega^{j_p} \otimes e_{i_1} \otimes \ldots \otimes e_{i_q}\}$ -- набор из $n^{p+q}$\\
Система порождающая:\\
$\fall \xi_1, \ldots, \xi_p \in V$\\
$\fall \eta^1,\ldots,\eta^q \in V^*$\\
$\fall f \in T_{(p,q)}\ f(\xi_1,\ldots,\xi_p,\eta^1,\ldots,\eta^q) = \alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} \ub{\omega^{j_1}\otimes \ldots \otimes \omega^{j_p} \otimes e_{i_1} \otimes \ldots \otimes e_{i_q}(\xi_1,\ldots,\xi_p,\eta^1,\ldots,\eta^q)}{\xi_1^{j_1}\ldots \xi_p^{j_p} \eta_{i_1}^1\ldots\eta_{i_q}^q}$\\ 
Отсюда $f = \ub{\text{в будущем: координата}}{\alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q}} \omega^{j_1}\otimes \ldots \otimes \omega^{j_p} \otimes e_{i_1} \otimes \ldots \otimes e_{i_q}$\\
Система линейно независимая\\
Рассмотрим $\alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q}\omega^{j_1}\otimes \ldots \otimes \omega^{j_p} \otimes e_{i_1} \otimes \ldots \otimes e_{i_q}$\\
Применим к $e_{u_1},\ldots, e_{u_p} \in V, \omega^{r_1},\ldots, \omega^{r_q} \in V^*$\\
$\alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q}\ub{\delta_{u_1}^{j_1}\ldots\delta_{u_p}^{j_p}\delta_{i_1}^{r_1}\ldots\delta_{i_q}^{r_q}}{\omega^{j_1}\otimes \ldots \otimes \omega^{j_p} \otimes e_{i_1} \otimes \ldots \otimes e_{i_q} (e_{u_1},\ldots, e_{u_p},\omega^{r_1},\ldots, \omega^{r_q})} = \0$\\
Отсюда $\alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q} = 0$\\
Тогда все $\alpha_{j_1, \ldotp, j_p}^{i_1, \ldots, i_q}$ нули $\Rto$ линейно независимые\\
\textbf{Следствие}\\
$\dim T_{(p,q)} = n^{p+q}$\\
\textbf{Замечание}\\
//todo 14:20 30.03\\
\textbf{Определение}\\
Пусть $\alpha \in T(p,q), p,q \neq 0$\\
Тензор $\beta \in T_{p-1, q-1}$ называется сверткой тензора $\alpha$, если\\
$\beta^{i_1, \ldots, \hat{i_k},\ldots, i_q}_{j_1, \ldots \hat{j_m} \ldots j_p} := \sum_{\kappa}\alpha^{i_1, \ldots, \us{\text{k-ая позиция}}\kappa \ldots i_q}_{j_1, \ldots \us{\text{m-ая позиция}}\kappa \ldots j_p}$, где $\hat{i_k}$ -- отсутствие $i_k$\\
\textbf{Доказательство корректности определения}\\
$\beta'^{i_1, \ldots, \hat{i_k},\ldots, i_q}_{j_1, \ldots \hat{j_m} \ldots j_p} = \alpha'^{r_1,\ldots,\kappa,\ldots,r_q}_{u_1,\ldots,\kappa,\ldots u_p} = \alpha'^{r_1,\ldots,i_k,\ldots,r_q}_{u_1,\ldots,j_m,\ldots u_p}t_{u_1}^{j_1}\ldots t_\kappa^{j_m} \ldots t_{u_p}^{j_m} s_{i_1}^{r_1}\ldots s_{i_k}^\kappa\ldots s_{i_q}^{r_q}$\\
$t_\kappa^{j_m}s_{i_k}^\kappa = \delta_{i_k}^{j_m}$\\
$\beta'^{i_1, \ldots, \hat{i_k},\ldots, i_q}_{j_1, \ldots \hat{j_m} \ldots j_p} = \ub{\beta^{i_1, \ldots, \hat{i_k},\ldots, i_q}_{j_1, \ldots \hat{j_m} \ldots j_p}}{\alpha'^{r_1,\ldots,\omega,\ldots,r_q}_{u_1,\ldots,\omega,\ldots u_p}}t_{u_1}^{j_1}\ldots \hat{t_\kappa^{j_m}} \ldots t_{u_p}^{j_m} s_{i_1}^{r_1}\ldots \hat{s_{i_k}^\kappa}\ldots s_{i_q}^{r_q}$\\
Свертка может быть по нескольким парам индексов\\
Если в результате свертки получится тензор (0,0), т.е. число, то свертка \textit{полная}\\
\subsection{Транспонирование тензоров. Кососимметричные и симметричные тензоры}
$\alpha=(\alpha_{ij}) \leadsto A^T = B = (\beta_{ij}), \beta_{ij}=\alpha_{ji}$\\
Обобщим операцию транспонирования\\
Пусть $\alpha \in T_{(p,q)}, p \geq 2$\\
$\alpha^{i_1,\ldots,i_q}_{j_1,\ldots,*,\ldots,\delta,\ldots,j_p}$ -- зафиксируем все, кроме $*, \delta$\\
Т.о. мы извлекли из матрицы тензора слой -- двумерную матрицу\\
Получили матрицу $\ot \alpha_{*\delta}$\\
Протранспонируем ее\\
Т.о. $\beta^{i_1,\ldots,i_q}_{j_1,\ldots,\delta,\ldots,*,\ldots,j_p} = \alpha^{i_1,\ldots,i_q}_{j_1,\ldots,*,\ldots,\delta,\ldots,j_p}$\\
\textbf{Определение}\\
$\alpha \in T_{(p,q)}, p \geq 2$\\
$\beta = \sigma(\alpha)$ называется тензором, полученным транспонированием тензора $\alpha$ по перестановке $\sigma$, если $\beta^{i_1,\ldots,i_q}_{j_1,\ldots,j_p} = \alpha^{i_1,\ldots,i_q}_{j_{\sigma_1},\ldots,j_{\sigma_p}}$\\
\textbf{Замечание}\\
Любая перестановка $\sigma$ -- конечное число транспозиций 2-х элементов\\\\
Заметим, что не любая многомерная матрица -- тензор\\
Проверим, что $\beta$ -- тензор\\
\textbf{Корректность}\\
Достаточно проверить для $\sigma$ -- транспозиции двух элементов\\
Возьмем $\beta'^{k_1,\ldots,k_q}_{m_1,\ldots,\ub{\text{r-ая}}*,\ldots,\ub{\text{l-ая}}\delta,\ldots,m_p}$\\
$\beta'^{k_1,\ldots,k_q}_{m_1,\ldots,*,\ldots,\delta,\ldots,m_p}=\alpha^{k_1,\ldots,k_q}_{m_1,\ldots,\delta,\ldots,*,\ldots,m_p}$\
Т.к. $\alpha$ -- тензор:\\
$\alpha^{k_1,\ldots,k_q}_{m_1,\ldots,\delta,\ldots,*,\ldots,m_p} = \ub{\beta^{i_1,\ldots,i_q}_{j_1,\ldots, j_l, \ldots, j_r,\ldots,j_p}}{\alpha^{i_1,\ldots,i_q}_{j_1,\ldots,j_r,\ldots,j_l,\ldots,j_p}} t_{m_1}^{i_1}\ldots t_\delta^{j_r}\ldots t_*^{j_l}\ldots t_{m_p}^{j_p}s_{i_1}^{k_1}\ldots s_{i_q}^{k_q}$\\\\
Теперь посмотрим на операцию транспонирования с точки зрения полилинейной функции\\
$\fall \xi_1, \ldots, \xi_p \in V\ \fall \eta^1,\ldots,\eta^q \in V^*$\\
$\beta=\sigma(\alpha)$\\
$\beta(\xi_1,\ldots,\xi_p,\eta^1,\ldots,\eta^q) = \beta^{i_1,\ldots,i_q}_{j_1,\ldots,j_p}\xi_1^{j_1}\ldots\xi_p^{j_p}\eta_{i_1}^1\ldots \eta_{i_q}^q$\\
$=\alpha^{i_1,\ldots,i_q}_{j_{\sigma_1},\ldots,j_{\sigma_p}}\xi_{\sigma_1}^{j_{\sigma_1}}\ldots\xi_{\sigma_p}^{j_{\sigma_p}}\eta_{i_1}^1\ldots \eta_{i_q}^q= \alpha(\xi_{\sigma_1},\ldots,\xi_{\sigma_p},\eta^1,\ldots,\eta^q)$\\
\textbf{Замечание}
\begin{enumerate}
    \item Транспониование тензора можно определить по аналогии по верхним индексам, если $q\geq 2$
    \item Тензоры можно транспонировать только по одному типу индексов: либо по верхним, либо по нижним, в отличие от произвольной многомерной матрицы
    \item Мы будем работать только с нижними индексами, но все свойства и теоремы работают и для верхних индексов
\end{enumerate}
\textbf{Свойства}
\begin{enumerate}
    \item Из определения очевидно, что $\sigma$ -- линейная операция\\
    $\sigma(\alpha_1 + \lambda\alpha_2) = \sigma(\alpha_1)+\lambda\sigma(\alpha_2)$
    \item $\alpha=f^1 \otimes \ldots \otimes f^p \otimes \ot \alpha \in T_{(p,q)}, f^i \in V^*, \ot\alpha \in T_{(0,q)}$\\
    Тогда $\fall \sigma: \beta=\sigma(\alpha) \fall \xi_i \in V \fall \eta^j \in V^* \beta(\xi_1,\ldots, \xi_p,\eta^1,\ldots,\eta^q)=\alpha(\xi_{\sigma_1},\ldots,\xi_{\sigma_p},\eta^1,\ldots,\eta^q)$\\
    $= f^1(\xi_{\sigma_1})\cdot \ldots \cdot f^p(\xi_{\sigma_p}) \cdot \ot \alpha(\eta^1,\ldots,\eta^q) = f^{\sigma^{-1}_1}(\xi_1)\ldots f^{\sigma^{-1}_p}(\xi_p) \alpha(\eta^1,\ldots,\eta_q)$\\
    Отсюда $\beta = f^{\sigma^{-1}_1} \otimes\ldots \otimes f^{\sigma^{-1}_p} \otimes \ot \alpha$
\end{enumerate}
$\alpha$ -- называется симметричным тензором, если $\fall \sigma\ \sigma(\alpha)=\alpha$\\
$\alpha$ -- кососимметричная(антрисимметричная/альтернированная), если $\fall \sigma\ \sigma(\alpha)=(-1)^{\inv(\sigma)}\alpha$\\
Заметим, что симметричность $\LRto$ симметричность при транспозиции(свапе) $\LRto \fall (n,k): \alpha(\xi_1,\ldots, \ub{\text{k-ая}}\mu, \ldots, \ub{\text{m-ая}}\nu, \ldots, \xi_p, \eta^1,\ldots) = \alpha(\xi_1,\ldots, \ub{\text{m-ая}}\nu, \ldots, \ub{\text{k-ая}}\mu, \ldots, \xi_p, \eta^1,\ldots)$\\
Заметим, что кососимметричность $\LRto$ кососимметричность при транспозиции(свапе)\\
$\LRto \fall (n,k): \alpha(\xi_1,\ldots, \ub{\text{k-ая}}\mu, \ldots, \ub{\text{m-ая}}\nu, \ldots, \xi_p, \eta^1,\ldots) = -\alpha(\xi_1,\ldots, \ub{\text{m-ая}}\nu, \ldots, \ub{\text{k-ая}}\mu, \ldots, \xi_p, \eta^1,\ldots)$\\
\textbf{Теорема}\\
$\alpha$ кососимметричная $\LRto \fall (k,m)\ \alpha(\ldots, \mu, \ldots, \mu, \ldots, \nu^1, \ldots) = 0 \LRto \fall (k,m) \alpha^{\ldots}_{\ldots, i, \ldots, i, \ldots} = 0$\\
\textbf{Доказательство}\\
Смотри доказательство для полилинейной ассиметричной формы\\
\textbf{Примеры}
\begin{enumerate}
    \item $f(\vec a, \vec b, \vec c) := \vec a, \vec b, \vec c = (\vec a \times \vec b, \vec c): V^3_3 \rto \Rset$\\
    $f \in T_{(3,0)}$\\
    $f$ -- кососимметричный тензор
    \item $\beta \in T_{(3,0)}, n=3, \beta$ -- кососимметричная\\
    Тогда тензор имеет следующий вид\\
    $\left(\begin{array}{ccc|ccc|ccc}
        0 & 0 & 0 & 0 & 0 & -b & 0 & b & 0\\
        0 & 0 & b & 0 & 0 & 0 & -b & 0 & 0\\
        0 & -b & 0 & b & 0 & 0 & 0 & 0 & 0
    \end{array}\right), b = \beta(e_1, e_2, e_3)$
    \item $A = (\alpha_{ij}) \in T_{(2, 0)}$. Тогда симметричность и антисимметричность согласуется с свойствами матриц
    \item $(\alpha_{ijk}) \in T_{(3,0)}, n = 3$\\
    $\left(\begin{array}{ccc|ccc|ccc}
        c & a & d   & a & x & b   & d & b & y\\
        a & x & b   & x & e & z   & b & z & g\\
        d & b & y   & b & z & g   & y & g & f
    \end{array}\right)$
\end{enumerate}
\subsection{Операция $\Sim$ и $\alt$ для тензоров}
\textbf{Определение}\\
$\fall \alpha\in T_{(p \geq 2, q)}\ \Sim \alpha = \frac1{p!}\sum_{\sigma\in S_p} \sigma(\alpha)$ -- симметрирование для тензора $\alpha$ по нижним индексам\\
$\fall \alpha\in T_{(p \geq 2, q)}\ \Sim \alpha = \frac1{p!}\sum_{\sigma\in S_p} (-1)^{\inv \sigma}\sigma(\alpha)$ -- альтернирование для тензора $\alpha$ по нижним индексам\\
\textbf{Замечание}
\begin{enumerate}
    \item Т.к. $\sigma$ -- линейный оператор, то $\Sim, \alt$ -- линейные
    \item Для $\alpha$ -- симметричной $\Sim \alpha = \alpha$\\
    Для $\alpha$ -- кососимметричной $\alt \alpha = \alpha$
    \item Операции $\Sim, \alt$ можно проводить не по всем индексам. Тогда набор индексов, по которым проводится операция, заключается в круглые(для симметрирования) или квадратные(для альтернирования) скобки
    Если какие-то индексы внутри скобок не участвуют, их выделяют вертикальными чертами
    \item Очевидно, что можно определить аналогичные операции по верхним индексам
    \item Пусть $\gamma = \Sim \alpha$\\
    Тогда $\fall \sigma\ \gamma_{i_1,\ldots, i_p} = \gamma_{i_{\sigma_1},\ldots,i_{\sigma_p}}$\\
    Пусть $\gamma = \alt \alpha$\\
    Тогда $\fall \sigma\ \gamma_{i_1,\ldots, i_p} = (-1)^{\inv \sigma}\gamma_{i_{\sigma_1},\ldots,i_{\sigma_p}}$
\end{enumerate}
\textbf{Теорема о перестановочности $\sigma$ и $\Sim, \alt$}\\
$\fall \alpha \in T_{(p \geq 2,q)} \fall \sigma\ \Sim(\sigma(\alpha)) = \sigma(\Sim(\alpha)) = \Sim \alpha$
$\fall \alpha \in T_{(p \geq 2,q)} \fall \sigma\ \alt(\sigma(\alpha)) = \sigma(\alt(\alpha)) = (-1)^{\inv \sigma}\alt \alpha$\\
\textbf{Доказательство}\\
Доказать проще, чем затехать\\
\textbf{Следствие 1}\\
$\fall \alpha \Sim \alpha$ -- симметричный, $\alt \alpha$ -- кососимметричный\\
\textbf{Доказательство}\\
$\fall \alpha\ \sigma(\Sim \alpha) = \Sim \alpha$ -- симметричный\\
$\fall \alpha\ \sigma(\alt \alpha) = (-1)^{\inv \sigma} \alt \alpha$ -- кососимметричный\\
\textbf{Следствие 2}\\
$\alpha$ -- симметричный $\LRto \alpha = \Sim \alpha$
$\alpha$ -- кососимметричный $\LRto \alpha = \alt \alpha$\\
\textbf{Следствие 3}\\
$\Sim (\Sim \alpha) = \Sim \alpha$\\
$\alt (\alt \alpha) = \alt \alpha$\\
$\Sim (\alt \alpha) = 0$\\
$\alt (\Sim \alpha) = 0$\\
\textbf{Доказательство}\\
$\Sim (\alt \alpha) = \Sim (\frac1{p!}\sum_{\sigma} (-1)^{\inv \sigma} \sigma(\alpha)) = \frac1{p!} \sum_\sigma (-1)^{\inv \sigma} \Sim (\sigma(\alpha)) = \Sim \alpha \frac1{p!} \ub{\begin{vmatrix}
    1 & \ldots & 1\\
    \vdots & \ddots & \vdots\\
    1 & \ldots & 1
\end{vmatrix}}{\sum_\sigma (-1)^{\inv \sigma}} = 0$\\
$\alt (\Sim (\alpha))$ -- аналогично\\\\
$T^{\text{сим}}_{(p,q)}$ -- симметрирование $T$ по фиксированному набору\\
$T^{\text{сим}}_{(p,q)}, T^{\text{кососим}}_{(p,q)}$ -- линейные подпространства $T_{(p,q)}$\\
Для перестановки $(k,m)$(транспозиция):\\
$T^{\text{сим}}_{(p,q)} \oplus T^{\text{кососим}}_{(p,q)} = T_{(p,q)}$\\
\ul{Свойства $\Sim, \alt$ сохраняются, если они производятся не по всем индексам}
\subsection{p-формы. Внешнее произведение p-формы}
\textbf{Определение}\\
$f$ -- p-форма, если $f\in T_{(p,0)}, f$ -- кососимметричный(или $p == 1$)\\
$f: V^p \rto K$\\
$f \in V^*$ -- 1-форма\\
$\ub{\Lambda^p V^* \text{-- пространство p-форм}}{T^{\text{кососим}}_{(p,0)}}$ -- линейное подпространство $T_{(p,0)}$\\
\textbf{Определение}\\
$f$ -- $p_1$ -- форма ($f \in \Lambda^{p_1}V^*$)\\
$g$ -- $p_2$ -- форма ($f \in \Lambda^{p_2}V^*$)\\
$f\land g := \frac{(p_1+p_2)!}{p_1!p_2!}\alt(\ub{\in T_{(p_1+p_2,0)}}{f \otimes g}) \in \Lambda^{p_1+p_2}V^*$ -- внешнее произведение\\
\textbf{Свойства}
\begin{enumerate}
    \item $f\land g = (-1)^{p_1p_2}g\land f$\\
    В частности $f, g \in \Lambda^1 V^* (V^*)$\\
    $f\land g = -g\land f$\\
    $f \land f = 0$\\
    \textbf{Доказательство}\\
    $f \in \Lambda^{p_1}V^* \lrto \alpha = (\alpha_{j_1,\ldots,j_{p_1}})$\\
    $g \in \Lambda^{p_2}V^* \lrto \alpha = (\alpha_{j_2,\ldots,j_{p_2}})$\\
    $f \otimes g \lrto \gamma = \alpha\otimes \beta \lrto \gamma_{j_1,\ldots,j_{p_1},m_1,\ldots,m_{p_2}} = \alpha_{j_1,\ldots,j_{p_1}}\beta_{m_1,\ldots,m_{p_2}}$\\
    $g \otimes f \lrto \theta = \beta\otimes \alpha \lrto \theta_{m_1,\ldots,m_{p_2},j_1,\ldots,j_{p_1}} = \beta_{m_1,\ldots,m_{p_2}}\alpha_{j_1,\ldots,j_{p_1}}$\\
    $\alt f \otimes g = \frac1{(p_1+p_2)!}\sum_\sigma \sigma(\gamma)$\\
    $\alt g\otimes f = \frac1{(p_1+p_2)!}\sum_\tau \tau(\theta)$\\
    //todo 13.04 13:12
    \item $(f + g) \land h = f\land h + g\land h$\\
    $f\land (g + h) = f \land g + f \land h$
    \item $(\lambda f) \land g = \lambda(f \land h) = f \land (\lambda g)$
    \item $f \land \ub{p_1\text{-форма}}\0 = \0 \land f = \ub{(p_1+p_2)\text{-форма}}\0$
    \item $(f\land g)\land h = f \land (g\land h) = f \land g \land h$\\
    \textbf{Доказательство}\\
    % $g \land h = \frac{(p_2+p_3)!}{p_2!p_3!}\ub{\frac1{(p_2+p_3)!\sum_{\sigma\in S_{p_2+p_3}}(-1)^{\inv \sigma}\sigma(g\otimes h)}}{\alt(g\otimes h)} = \frac1{p_2!p_3!}\sum_{\sigma\in S_{p_2+p_3}}(-1)^{\inv \sigma}\sigma(g\otimes h)$\\
    % $f\land (g\land h) = \frac{(p_1+p_2+p_3)!}{p_1!(p_2+p_3)!}\frac1{p_2!p_3!}\alt(f\otimes \sum_{\sigma\in S_{p_2+p_3}}(-1)^{\inv \sigma} \sigma(g\otimes h))$\\
    $f \land g = \frac1{p_1!p_2!}\sum_{\sigma \in S_{p_1+p_2}}(-1)^{\inv \sigma} \sigma(f\otimes g)$\\
    $(f\land g) \land h = \frac{(p_1+p_2+p_3)!}{(p_1+p_2)!p_1!p_2!p_3!}\alt(\sum_{\sigma \in S_{p_1+p_2}} (-1)^{\inv\sigma}\sigma(f\otimes g)\otimes h)$\\
    Рассмотрим $\alt(\sum_{\sigma \in S_{p_1+p_2}} (-1)^{\inv\sigma}\sigma(f\otimes g)\otimes h) = \sum_{\sigma \in S_{p_1+p_2}} (-1)^{\inv\sigma}\alt(\ub{\tau(f\otimes g\otimes h)}{\sigma(f\otimes g)\otimes h}) = \ldots$\\
    Возьмем $\tau$ -- перестановку такую, что первые $p_1+p_2$ индексов переставляются, а последние $p_3$ индекса не меняются\\
    $(-1)^{\inv \sigma} = (-1)^{\inv \tau}$\\
    $\ldots = \sum_{\sigma \in S_{p_1+p_2}} (-1)^{\inv \sigma}(-1)^{\inv \sigma} \alt(f\otimes g \otimes h) = \alt(f\otimes g\otimes h)\sum_{\sigma \in S_{p_1+p_2}} 1 = (p_1+p_2)!\alt(f\otimes g \otimes h)$\\
    $(f\land g) \land h = \frac{(p_1+p_2+p_3)!}{p_1!p_2!p_3!}\alt(f\otimes g \otimes h)$\\
    Аналогично $f \land (g\land h) = \frac{(p_1+p_2+p_3)!}{p_1!p_2!p_3!}\alt(f\otimes g \otimes h)$
\end{enumerate}
Пусть $f^i \in V^* = \Lambda^1V^*$ -- 1-форма, $j = 1\ldots p$\\
$f^1\land \ldots \land f^p = \frac{p!}{1!\ldots1!} \alt(f^1\otimes \ldots \otimes f^p) \in \Lambda^p V^*$\\
$\omega^{j_1}\land \ldots \land \omega^{j_p} = p! \alt(\omega^{j_1}\otimes \ldots \otimes \omega^{j_p}) \in \Lambda^p V^*$\\
$\omega^i \land \omega^j = 2\alt(\omega^i \otimes \omega^j) = \omega^i\otimes \omega^j - \omega^j\otimes \omega^i$\\
$\omega^i\land \omega^j = -\omega^j\land \omega^i$\\
$\omega^i\land \omega_i = 0$\\
$\omega^{j_1}\land \ldots \land \omega^\kappa \land \ldots \land \omega^m \land \ldots \land \omega^{j_p} = -\omega^{j_1}\land \ldots \land \omega^m \land \ldots \land \omega^\kappa \land \ldots \land \omega^{j_p}$\\
$\omega^{j_1}\land \ldots \land \omega^\kappa \land \ldots \land \omega^\kappa \land \ldots \land \omega^{j_p} = 0$\\
\textbf{Теорема (о базисе пространства внешних форм)}\\
$\{ \omega^{j_1}\land \ldots \land \omega^{j_p}: j_1 < \ldots < j_p \}$ -- базис пространства $\Lambda^pV^*$\\
\textbf{Доказательство}\\
$\fall f \in \Lambda^p V^* \LRto \left\{\begin{array}{cc}
    f\in T_{p,0}\\
    \alt f = f
\end{array}\right.$\\
$f = \alpha_{j_1,\ldots,j_p}\omega^{j_1}\otimes \ldots \otimes \omega^{j_p}$\\
$\alt f = \alpha_{j_1,\ldots,j_p}\omega^{j_1} \alt(\omega^{j_1}\otimes \ldots \otimes \omega^{j_p})$\\
$ = \frac{\alpha_{j_1,\ldots,j_p}\omega^{j_1}}{p!}\omega^{j_1}\land \ldots \land \omega^{j_p} = \frac1{p!}\sum_{j_1<\ldots<j_p} \sum_{\sigma \in S_p} \alpha_{j_{\sigma_1}\ldots j_{\sigma_p}}\omega^{j_{\sigma_1}}\land \ldots \land \omega^{j_{\sigma_p}}$\\
$ = \frac1{p!}\sum_{j_1<\ldots<j_p} \sum_{\sigma \in S_p} \alpha_{j_{\sigma_1}\ldots j_{\sigma_p}}(-1)^{\inv\sigma}\omega^{j_1}\land \ldots \land \omega^{j_p}$\\
$ = \sum_{j_1<\ldots<j_p} \ub{\beta_{j_1,\ldots,j_p}}{(\frac1{p!}\sum_{\sigma \in S_p} \alpha_{j_{\sigma_1}\ldots j_{\sigma_p}}(-1)^{\inv\sigma})}\omega^{j_1}\land \ldots \land \omega^{j_p}$ -- порождающая\\
Существуют координаты p-формы $f$ относительно базиса $\omega^{j_1}\land \ldots \land \omega^{j_p}, j_1<\ldots<j_p$\\
Проверим линейную независимость\\
$\0 = \sum_{j_1<\ldots<j_p}\beta_{j_1,\ldots,j_p}\ub{p!\ub{\frac1{p!}\sum_{\sigma\in S_p}(-1)^{\inv \sigma}\sigma(\omega^{j_1}\otimes\ldots\otimes\omega^{j_p})}{\alt(\omega^{j_1}\otimes \ldots\otimes\omega^{j_p})}}{\omega^{j_1}\land\ldots\land\omega^{j_p}} = \sum_{j_1<\ldots<j_p} \sigma_{\sigma\in S_p}(-1)^{\inv \sigma} \omega^{j_{\sigma_1}} \otimes \ldots \otimes \omega^{j_{\sigma_p}}$\\
Т.к. базис $T_{(p,0)}$, $\fall \alpha_{j_1,\ldots,j_p} = 0$\\
$\beta_{j_1,\ldots,j_p} = 0$\\
Тогда линейно независимые\\
\textbf{Следствие 1}\\
$\dim \Lambda^pV^* = C_n^p = \frac{n!}{p!(n-p)!}$\\
\textbf{Следствие 2}\\
$\fall f \in \Lambda^P V^*$\\
$f = \sum_{j_1<\ldots<j_p} \beta_{j_1,\ldots,j_p} \omega^{j_1}\land \ldots\land \omega^{j_p}$\\
$\beta_{j_1,\ldots,j_p} = \alpha_{j_1,\ldots,j_p} = f(e_{j_1}, \ldots, e_{j_p}), j_1 < \ldots < j_p$\\
\textbf{Доказательство}\\
Из доказательства теоремы:\\
$\beta_{j_1,\ldots,j_p} = \frac1{p!}\sum_{\sigma \in S_p} \alpha_{j_{\sigma_1},\ldots,j_{\sigma_p}}(-1)^{\inv \sigma} = \alpha_{[j_1,\ldots,j_p]}, j_1<\ldots<j_p$\\
$f = \alt f \Rto \alpha_{[j_1, \ldots,j_p]} = \alpha_{j_1,\ldots,j_p}$, т.к. $j_1<\ldots<j_p$\\
\textbf{Теорема}\\
$f^i \in \Lambda^1 V^*, j = 1\ldots p$ -- 1-формы\\
$\fall \xi_1,\ldots,\xi_p \in V$\\
$(f^1 \land \ldots \land f^p)(\xi_1,\ldots,\xi_p) = \begin{vmatrix}
    f^1(\xi_1) & \ldots & f^1(\xi_p)\\
    \vdots & \ddots & \vdots\\
    f^p(\xi_1) & \ldots & f^p(\xi_p)
\end{vmatrix}$\\
$f^j \lrto a^j = \begin{pmatrix}
    a_1^j & \ldots & a_p^j
\end{pmatrix}$ -- координатные строки в $V^*$ относительно $\omega^i$\\
$\xi_i \lrto \begin{pmatrix}
    \xi_i^1\\
    \vdots\\
    \xi_i^n
\end{pmatrix}$ -- координаты в $V$ относительно $e_j$\\
$f^j(\xi_i) = a_k^j \xi_i^k = a^j\xi_i$\\
$f^1 \land \ldots \land f^p(\xi_1,\ldots,\xi_p) = \det(\begin{pmatrix}
    a^1\\
    \vdots\\
    a^p
\end{pmatrix} \cdot \begin{pmatrix}
    \xi_1 & \ldots & \xi_p
\end{pmatrix})$\\
\textbf{Замечание}\\
Если $p=n$: $f^1 \land \ldots \land f^p(\xi_1,\ldots,\xi_p)=\det A \det \xi$\\
\textbf{Доказательство}\\
$f^1 \land \ldots \land f^p(\xi_1,\ldots,\xi_p) = p!\frac1{p!}\sum_{\sigma \in S_p} (-1)^{\inv \sigma} \sigma(f^1 \otimes \ldots\otimes f^p)(\xi_1,\ldots,\xi_p) = \sum_{\sigma\in S_p} (-1)^{\inv \sigma} f^{\sigma_1}\otimes\ldots\otimes f^{\sigma_p}(\xi_1,\ldots,\xi_p) = \sum_{\sigma \in S_p} (-1)^{\inv \sigma} f^{\sigma_1}(\xi_1)\ldots f^{\sigma_p}(\xi_p) = \det (f^i(\xi_j))$\\
\textbf{Следствие 1}\\
$\fall \xi_1,\ldots,\xi_p \in V\ \omega^{j_1}\land\ldots\land\omega^{j_p}(\xi_1,\ldots,\xi_p) = \begin{vmatrix}
    \xi_1^{j_1} & \ldots & \xi_p^{j_1}\\
    \vdots & \ddots & \ldots\\
    \xi_1^{j_p} & \ldots & \xi_p^{j_p}
\end{vmatrix}$\\
\textbf{Следствие 2}\\
$f^1 \land \ldots \land f^p = \sum_{j_1<\ldots < j_p} \ub{\beta_{j_1,\ldots, j_p} \text{ для } f^1\land \ldots \land f^p}{\begin{vmatrix}
    a^1_{j_1} & \ldots & a^1_{j_p}\\
    \vdots & \ddots & \vdots\\
    a^p_{j_1} & \ldots & a^p_{j_p}
\end{vmatrix}} \omega^{j_1} \land \ldots \land \omega^{j_p}$\\
\textbf{Доказательство}\\
$\beta_{j_1 < \ldots < j_p} = \alpha_{j_1,\ldots, j_p} = (f^1\land\ldots \land f^p)(e_{j_1},\ldots,e_{j_p}) = \begin{vmatrix}
    f^1(e_{j_1}) & \ldots & f^1(e_{j_p})\\
    \vdots & \ddots & \vdots\\
    f^p(e_{j_1}) & \ldots & f^p(e_{j_p})
\end{vmatrix} = \begin{vmatrix}
    a^1_{j_1} & \ldots & a^1_{j_p}\\
    \vdots & \ddots & \vdots\\
    a^p_{j_1} & \ldots & a^p_{j_p}
\end{vmatrix}$, т.к. $a_j^i = f^i(e_j)$ по определению коэффициентов формы $f$\\
В частности, при $p=n$: $f^1\land\ldots\land f^n = \det A \omega^1 \land \ldots \land \omega^n$\\
\textbf{Следствие 3}\\
$\det(\begin{pmatrix}
    a^1\\\vdots\\a^p
\end{pmatrix}\cdot \begin{pmatrix}
    \xi_1 & \ldots & \xi_p
\end{pmatrix}) = \sum_{j_1<\ldots < j_p} \begin{vmatrix}
    a^1_{j_1} & \ldots & a^1_{j_p}\\
    \vdots & \ddots & \vdots\\
    a^p_{j_1} & \ldots & a^p_{j_p}
\end{vmatrix}\cdot \begin{vmatrix}
    \xi_1^{j_1} & \ldots & \xi_p^{j_1}\\
    \vdots & \ddots & \vdots\\
    \xi_1^{j_p} & \ldots & \xi_p^{j_p}
\end{vmatrix}$\\
В частности, при $p=n$: $\det(A\xi) = \det A \det \xi$\\
\textbf{Определение}\\
Пусть $g \in T_{0,q}, \alt g = g$:\\
$g$ называется \textit{поливектор}(q-вектор)\\
Если $q \in T_{(0,1)}$ -- $g$ -- 1-вектор\\
Линейное пространство $q$-векторов $\mc V^qV$\\
Аналог внешнего произведения: $g_1 \in \mc V^{q_1}V, g_2 \in \mc V^{q_2} V, g_1\lor g_2 = \frac{(p_1+p_2)!}{p_1!p_2!}\alt(g_1 \otimes g_2)$ -- по верхним индексам\\
$\{e_{i_1}\lor \ldots \lor e_{i_q}, i_1 < \ldots < i_q\}$ -- базис $\mc V^qV$\\
Пусть $p=q$\\
$\fall f^1, \ldots, f^p \in V^*$\\
$V \cong V^{**}\ \fall \xi \in V\ \xi(f) = f(\xi)$\\
$\xi \in \mc V^1 V$\\
$\xi_1\lor \ldots\lor\xi_p(f^1, \ldots, f^p) = \begin{vmatrix}
    \xi_1(f^1) & \ldots & \xi_p(f^1)\\
    \vdots & \ddots & \vdots\\
    \xi_1(f^p) & \ldots & \xi_p(f^p)
\end{vmatrix} = \begin{vmatrix}
    f^1(\xi_1) & \ldots & f^1(\xi_p)\\
    \vdots & \ddots & \vdots\\
    f^p(\xi_1) & \ldots & f^p(\xi_p)
\end{vmatrix} = f^1\land \ldots \land f^p(\xi_1,\ldots,\xi_p)$
\subsection{Евклидовы и унитарные пространства}
\subsubsection{Скалярное и псевдоскалярное произведение. Евклидово и унитарное пространство. Норма в евклидовом и унитарном пространстве}
\textbf{Определение}\\
Пусть $V$ -- линейное пространство над $\Rset$ (вещественное линейное пространство)\\
$(\cdot,\cdot): V^2 \rto \Rset$ называется скалярным произведением, если\\
$\fall x,y \in V, \lambda \in \Rset$
\begin{enumerate}
    \item $(x, y) = (y,x)$ -- симметричность
    \item $(x_1 + x_2, y) = (x_1, y) + (x_2, y)$ -- аддитивность по первому аргументу
    \item $(\lambda x, y) = \lambda(x,y)$ -- однородность по 1 аргументу
    \item $(x, x) \geq 0$, причем $=0 \LRto x=\0$
\end{enumerate}
\textbf{Следствие}\\
Линейность по второму аргументу\\
$(V, (\cdot, \cdot))$ -- вещественное линейное пространство с заданным на нем скалярным произведением -- Евклидово пространство\\
\textbf{Определение}\\
Пусть $V$ -- линейное пространство над $\Cset$\\
$(\cdot,\cdot): V^2 \rto \Rset$ называется псевдоскалярным произведением, если\\
$\fall x,y \in V, \lambda \in \Cset$
\begin{enumerate}
    \item $(x, y) = \ol{(y,x)}$
    \item $(x_1 + x_2, y) = (x_1, y) + (x_2, y)$ -- аддитивность по первому аргументу
    \item $(\lambda x, y) = \lambda(x,y)$ -- однородность по 1 аргументу
    \item $(x,x) = \ol{(x, x)} \Rto (x,x) \in \Rset$\\
    $(x, x) \geq 0$, причем $=0 \LRto x=\0$
\end{enumerate}
\textbf{Следствие}\\
$(x, y_1 + y_2) = (x, y_1) + (x, y_2)$ -- аддитивность по второму аргументу\\
$(x, \lambda y) = \ol{(\lambda y,x)} = \ol\lambda (x, y)$\\
Вместе: полуторолинейность\\
$(\Cset, (\cdot, \cdot))$ -- унитарное пространство (псевдоевклидово)\\
\textbf{Замечание}\\
Иногда будем называть псевдоскалярное пространство скалярным (читай контекст)\\
\textbf{Примеры}
\begin{enumerate}
    \item $V_3, (\vec a, \vec b) = |\vec a||\vec b|\cos \phi$
    \item $\Rset^n, x \in \Rset^n, x = \begin{pmatrix}
        x_1\\\vdots\\x_n
    \end{pmatrix}, x_i \in \Rset$\\
    $(x,y) := \sum x_iy_i$
    \item $\Cset^n, x \in \Cset^n, x = \begin{pmatrix}
        x_1\\\vdots\\x_n
    \end{pmatrix}, x_i \in \Cset$\\
    $(x,y) = \sum x_i\ol{y_i}$
\end{enumerate}
\textbf{Определение}\\
Норма $\|\cdot\|: V\rto K, V$ -- V -- линейное пространство над полем $K$
\begin{enumerate}
    \item $\|x\| = 0 \Rto x = \0$ -- невырожденность
    \item $\|\lambda x \| = |\lambda| \|x\|$ -- однородность
    \item $\|x+y\| \leq \|x\| + \|y\|$
\end{enumerate}
\textbf{Определение}\\
$(V, (\cdot, \cdot))$ -- евклидово/унитарное пространство\\
$\|x\|:=\sqrt{(x,x)}$ -- евклидова норма\\
Докажем аксиомы
\begin{enumerate}
    \item Очевидно
    \item $\|\lambda x\| = \sqrt{(\lambda x, \lambda x)} = \sqrt{(\lambda\ol\lambda)(x,x)} = |\lambda|\sqrt{(x,x)} = |\lambda|\|x\|$
    \item 
    \textbf{К.Б.Ш.}\\
    $|(x,x)| \leq \|x\|\|y\|$, причем $|(x,x)| = \|x\|\|y\| \LRto x,y$ линейно зависимые\\
    \textbf{Доказательство}\\
    $\fall \alpha, \beta \in \Cset$\\
    $0 \leq (\alpha x + \beta y, \alpha x + \beta y) = \alpha\ol\alpha(x,x) + \alpha\ol\beta(x,y) + \ol\alpha\beta(y,x) + \beta\ol\beta(y,y) = \ldots$\\
    Пусть $\alpha:= (y,y) \in \Rset$\\
    $\beta := -(x,y) \in \Cset$\\
    $\ldots = \alpha(\|x\|^2\|x\|^2 - \ub{|(x,y)|^2}{\ol{(x,y)}(x,y)} - (x,y)(y,x) + |(x,y)|^2) = \alpha(\|x\|^2\|y\|^2 - (x,y)^2) \geq 0$\\
    $\alpha \geq 0$\\
    Отсюда $\|x\|\|y\| \geq (x,y)$\\
    Если $x = 0$ или $y = 0$, то неравенство 0\\
    Если $x,y\neq 0, |(x,y)|=\|x\|\|y\|$\\
    $\alpha, \beta \neq 0$
    Тогда $0 \leq (\alpha x + \beta y, \alpha x + \beta y) = \alpha(\ub{0}{\|y\|^2\|x\|^2 - |(x,y)|^2}) = 0$\\
    Тогда $\ex \alpha, \beta \neq 0 : \|\alpha x + \beta y\| = 0 \LRto \alpha x + \beta y = \0 \LRto$ $x, y$ линейно зависимые\\
    Пусть $\ex \alpha, \beta \neq 0: \alpha x + \beta y = \0$\\
    $\left\{\begin{array}{ccc}
        \ub{\neq 0}{\alpha (x,x)} + \beta(y,x) = 0 & \Rto & \alpha\|x\|^2 = -\beta(y,x)\\
        \alpha (x,y) + \ub{\neq 0}{\beta(y,y)} = 0 & \Rto & \beta\|y\|^2 = -\alpha(x,y)
    \end{array}\right.$\\
    Тогда $\alpha\beta\|x\|^2\|y\|^2 = \alpha\beta(y,x)(x,y) = |(x,y)|^2$\\
    \textbf{Доказательство выполнения аксиомы}\\
    $\|x+y\|^2 = (x+y,x+y) = \|x\|^2 + (x,y) + (y, x) + \|y\|^2 = \|x\|^2 + \|y\|^2 + 2\ub{\leq |(x,y)|}{\Re((x,y))} \leq \|x\|^2 + \|y\|^2 + 2|(x,y)| \leq \|x\|^2+\|y\|^2 + 2\|x\|\|y\| = (\|x\|+\|y\|)^2$\\
    $\|x+y\| \leq \|x\| + \|y\|$
\end{enumerate}
\textbf{Определение}\\
$\fall x, y \in (V, (\cdot, \cdot))$\\
$\|x\|$ -- длина вектора\\
$\cos \angle(x,y) = \frac{(x,y)}{\|x\|\|y\|}$ -- косинус угла между векторами\\
$|\cos \angle(x,y)| \leq 1$ -- по КБШ\\
\subsubsection{Процесс ортогональный Грама-Шмидта. О.Н.Б. (ортонормированный базис). Ортогональное дополнение}
\textbf{Определение}\\
$(V, (\cdot,\cdot))$ -- евклидово/унитарное\\
$\fall x,y \in V$ называются ортогональными, если $(x,y) = 0$\\
$\0$ ортогонален всем векторам\\
\textbf{Определение}\\
Система векторов $v_1, \ldots, v_m$ называется ортогональной, если вектора попарно ортогональны\\
Система векторов называется ортонормированными, если вектора попарно ортогональны и нормированы($\|v_i\| = 1$)\\
\textbf{Утверждение}\\
Ненулевые $v_1, \ldots, v_m$ ортогональны $\Rto v_1,\ldots, v_m$ система линейно независимая\\
\textbf{Доказательство}\\
Пусть $\sum_{k=1}^m \alpha_k v_k = \0$\\
$v_j(\sum_{k=1}^m \alpha_k v_k) = \sum_{k=1}^m \alpha_k v_jv_k = \0$\\
$\sum_{k=1}^m \alpha_k v_jv_k = \sum_{k=1}^m \alpha_k \ub{\0 \text{ при } k\neq j}{v_jv_k} = \alpha_j \ub{\neq 0}{(v_j, v_j)}$\\
Тогда $\fall i\ \alpha_i = 0$\\
Отсюда вектора линейно независимые\\
\textbf{Теорема (процесс ортогонализации Грама-Шмидта)}\\
Любую систему векторов $a_1, \ldots, a_m$ можно заменить на систему ортогональных векторов $b_1,\ldots, b_k$ таким образом, что $\span(a_1,\ldots, a_m) = \span(b_1, \ldots, b_k)$, причем $k \leq m$, $k = m \LRto$ система линейно независимая\\
\textbf{Доказательство}
\begin{enumerate}
    \item Пусть $a_1, \ldots, a_m$ линейно независимые
    Построим $b$ индукционно:
    \begin{enumerate}
        \item Возьмем $a_1, a_2$\\
        $b_1:= a_1$\\
        $b_2 := a_2 - c_1a_1$\\
        $c_1: (b_2, b_1) = 0 \LRto 0 = (a_2, b_1) - c_1(a_1,a_1) \LRto c_1 = \frac{(a_2, b_1)}{(a_1,a_1)}$\\
        $\span(a_1,a_2) = \span(b_1,b_2)$, т.к. $b_2$ линейно независим с $a_1,a_2$
        \item $a_1,\ldots,a_k \rto b_1,\ldots,b_k$ -- ортогональные\\
        $\ub{\text{линейно независимый}}{\span(a_1, \ldots, a_k)} = \ub{\text{попарно орт.}}{\span(b_1,\ldots,b_k)} \Rto$ линейно независимые
        \item Покажем для $k+1$\\
        $b_{k+1} = a_{k+1} - \sum_{i=1}^k c_ib_i$\\
        $c_i$ такой, чтобы $\fall i = 1\ldots k\ (b_{k+1}, b_i) = 0$
        $c_i := \frac{(a_{k+1}, b_i)}{(b_i, b_i)}$\\
        $b_{k+1} \in \span(a_1,\ldots, a_{k+1})$\\
        $b_{k+1} \perp b_j, j = 1\ldots k$\\
        $\span(a_1,\ldots,a_k) = \span(b_1, \ldots, b_k)$\\
        $b_{k+1}$ линейно независимый с $(a_1, \ldots, a_k)$\\
        $\span(a_1,\ldots, a_{k+1}) = \span(b_1,\ldots, b_{k+1})$
    \end{enumerate}
    \item Если $a_1, \ldots, a_m$ линейно зависимые, предварительно выполним прополку $a$\\
    Если без прополки, то некоторые $b_i$ будут $\0$
\end{enumerate}
\textbf{Следствие 1}\\
В $(V, (\cdot, \cdot))$ всегда существует о.н.б.\\
\textbf{Доказательство}\\
Применим Грама-Шмидта и нормируем\\
\textbf{Следствие 2}\\
В $(V, (\cdot, \cdot))$ любую ортогональную систему можно дополнить до ортонормированного базиса\\
\textbf{Определение}\\
$L \subset V$ -- линейное подпространство\\
$L^\perp = \{y \in V: (x,y) = 0 \fall x \in L\}$ -- ортогональное дополнение\\
\textbf{Свойства}
\begin{enumerate}
    \item $L^\perp$ -- линейное подпространство\\
    \textbf{Доказательство}\\
    $\fall y_1, y_2 \in L^\perp, \lambda \in K, x \in L\ (x,\lambda y_1 + y_2) = \ol\lambda\ub{0}{(x,y_1)} + \ub{0}{(x, y_2)}$\\
    Отсюда $\lambda y_1 + y_2 \in L^\perp$ -- линейное подпространство
    \item $V = L \oplus L^\perp$\\
    \textbf{Доказательство}\\
    Докажем, что $L, L^\perp$ -- дизъюнктные\\
    $y \in L \cap L^\perp \Rto (y, y)=0 \LRto y = \0$ -- дизъюнктные\\
    Пусть $L = \span(a_1, \ldots, a_k)$\\
    Дополним $a_1,\ldots, a_k$ векторами $a_{k+1}, \ldots, a_n$ до базиса $V$\\
    Тогда $V = L \oplus \span(a_{k+1},\ldots, a_n)$\\
    $\fall a_{k+j}\ (a_i, a_{k+j}) = 0$\\
    Тогда $(a_i, \sum_{j=1}^{n-k} \alpha_j a_{k+j}) = 0$\\
    Тогда $(\sum_{i = 1}^k \beta_i a_i, \sum_{j=1}^{n-k} a_{k+j}) = 0$\\
    Отсюда $\span(a_{k+1}, \ldots, a_n) \subset L^\perp$\\
    $V = L \oplus \span(a_{k+1}, \ldots, a_n), L, L^\perp$ -- дизъюнктные\\
    Тогда $L^\perp = \span(a_{k+1},\ldots, a_n)$\\
    Тогда $V = L \oplus L^\perp$
    \item $(L^\perp)^\perp = L$\\
    \textbf{Доказательство}\\
    $L\oplus L^\perp = V = L\perp \oplus (L^\perp)^\perp$\\
    $\fall x \in L, y \in L^\perp (x, y) = 0 \Rto x \in (L^\perp)^\perp \Rto L \subset (L^\perp)^\perp$\\
    Тогда $L = L^\perp$
    \item $(L_1 \cap L_2)^\perp = L_1^\perp + L_2^\perp$\\
    $(L_1 + L_2)^\perp = L_1^\perp \cap L_2^\perp$\\
    \textbf{Доказательство}\\
    Докажем 1\\
    Пусть $y \in (L_1 + L_2)^\perp$\\
    Тогда $\fall \ub{\in L_1}{x_1} + \ub{\in L_2}{x_2} \in L_1 + L_2\ (x_1 + x_2, y) = (x_1, y) + (x_2, y) = 0$\\
    \begin{enumerate}
        \item $x_2 = 0$\\
        $\fall x_1 \in L_1\ (x_1, y) = 0 \Rto y \in L^\perp$\\
        $(x_2, y) = 0$\\
        Тогда $y \in L_1^\perp \cap L_2^\perp$\\
        Отсюда $(L_1+L_2)^\perp \subset L_1^\perp \cap L_2^\perp$
        Обратно: $y \in L_1^\perp \cap L_2^\perp$\\
        $\fall x_1\ (x_1, y) = 0$\\
        $\fall x_2\ (x_2, y) = 0$\\
        Отсюда $(x_1 + x_2, y) = 0 \Rto y \in (L_1 + L_2)^\perp$\\
        $L_1^\perp \cap L_2^\perp \subset (L_1 + L_2)^\perp$
        \item Из предыдущего пункта\\
        $(L_1^\perp + L_2^\perp)^\perp = (L_1^\perp)^\perp \cap (L_2^\perp)^\perp = L_1 \cap L_2$\\
        $L_1^\perp + L_2^\perp = ((L_1^\perp + L_2^\perp)^\perp)^\perp = (L_1 \cap L_2)^\perp$
    \end{enumerate}
    \item $\0^\perp = V, V^\perp = \0$
\end{enumerate}
\subsection{Матрица Грама и ее свойства. Ортогональные и унитарные матрицы}
$(V, (\cdot, \cdot))$\\
$e_1, \ldots, e_n$ -- базис\\
$\fall x,y \in V\ x \us e \lrto \begin{pmatrix}
    x_1\\\vdots\\x_n\\
\end{pmatrix}\\
    y \us e \lrto \begin{pmatrix}
        y_1\\\vdots\\y_n
\end{pmatrix}$\\
$(x,y) = (\sum_{i=1}^n x_i e_i, \sum_{i=1}^n y_ie_i) = \sum_i \sum j x_i \ol{y_j} (e_i, e_j)$\\
Пусть $g_{ij} = (e_i, e_j)$\\
$\Gamma = (g_{ij})$ -- матрица Грама базиса $e_1, \ldots, e_n$\\
$(x,y) = x^\perp \Gamma \ol y$ -- координатная форма записи скалярного произведения\\
В частности, если $e$ -- о.н.б., то $g_{ij} = \sigma_{ij}$\\
$\Gamma = E$\\
$(x, y) = x^\perp \ol y = \sum_{i=1}^n x_i \ol{y_i}$\\
$(x,x) = x^\perp \ol x = \sum_{i=1}^n x_i \ol{x_i} = \sum_{i=1}^n |x_i|^2$\\
\textbf{Замечание}\\
Если $V$ евклидово пространство, то, очевидно, все комплексные сопряжения можно убрать\\
\textbf{Определение}\\
$A_{n\times n}$\\
$A^*$ называется сопряженной к $A$, если $A^* = \ol{A^T}$\\
$*$ -- операция сопряжения\\
$(A+\lambda B)^* = A^* + \ol \lambda B^*$\\
\textbf{Определение}\\
Матрица $A_{n \times n}$ -- самосопряженная, если $A^* = A$\\
Если $a_{ij} \in \Rset$, то самосопряженная = симметричная\\
Если $a_{ij} \in \Cset$, то самосопряженная = эрмитова\\
Очевидно, что $\Gamma^* = \Gamma$, т.е. самосопряженная\\
\textbf{Определение}\\
$a_1, \ldots, a_k \in V$\\
$G(a_1,\ldots, a_k) = ((a_i, a_j))_{k\times k}$ -- матрица Грама для системы векторов\\
$\Gamma = G(e_1,\ldots, e_n)$\\
$G = G^*$\\
\textbf{Теорема об определителе матрица Грама}\\
$g(a_1, \ldots, a_k) := \det G(a_1,\ldots, a_k)$\\
Применим к векторам алгоритм Грама-Шмидта\\
$a_1, \ldots, a_k \leadsto b_1, \ldots, b_k$\\
Тогда $g(a_1, \ldots, a_k) = \prod_{i=1}^k \|b_i\|^2$\\
\textbf{Доказательство}\\
$g(a_1, \ldots, a_k) = \begin{vmatrix}
    (a_1, a_1) & (a_1, a_2) & \ldots & (a_1, a_k)\\
    \vdots & \ddots & \ddots & \vdots\\
    (a_k, a_1) & (a_k, a_2) & \ldots & (a_k, a_k)\\
\end{vmatrix}$
Заменим в матрица все $a_1$ на $b_1$\\
2 строка -= 1 строка $\cdot c_1$\\
Тогда $\fall j = 2\ldots k\ \begin{array}{ll}
    (a_2, a_j) - c_1 (b_1, a_j) = (a_2-c_1b_1, a_j) = (b_2, a_j)\\
    (a_2, b_1) - c_1(b_1,b_1) = (b_2, b_1) = 0
\end{array}$\\
2 столбец -= 1 столбец $\cdot c_1$\\\\
$\fall j=3\ldots k\ \begin{array}{ll}
    (a_j, a_2) - c_1(a_j b_1) = (a_j, a_2 - c_1 b_1) = (a_j, b_2)\\
    (b_1, a_2) - c_1(b_1, a_1) = (b_1, b_2) = 0
\end{array}$\\
Тогда после этих двух шагов в матрице не осталось $a_2$\\
Применим аналогичные действия, зная, что $b_i = a_i - c_1 b_1 - \ldots - c_{i-1}b_{i-1}$\\
Таким образом мы получим матрицу, где вместо $a_i$ будут $b_i$\\
По построению определитель не поменялся\\
Тогда $g(a_1, \ldots, a_k) = g(b_1, \ldots, b_k) = \det \nm{diag}(\|b_1\|^2, \ldots, \|b_k\|^2) = \prod_{i=1}^k \|b_i\|^2$\\
\textbf{Следствие 1}\\
$a_1, \ldots, a_k$ -- линейно независимые $\LRto g(a_1, \ldots, a_k) > 0$\\
\textbf{Доказательство}\\
Если $a_1, \ldots, a_k$ линейно незавиимые $\us{\text{Г.Ш.}}\lrto b_1, \ldots, b_k$ -- линейно независимые $\LRto \|b_i\|^2 > 0$\\
\textbf{Следствие 2}\\
$a_1, \ldots, a_{k-1}$ -- линейно независимые\\
$\|b_k\|^2 = \frac{g(a_1, \ldots, a_k)}{g(a_1, \ldots, a_{k-1})}$\\
\textbf{Свойства матрицы Грама}\\
$\Gamma = G(e_1, \ldots, e_n), e$ -- базис\\
1 + 2 -- положительно определенная матрица ($\Gamma > 0$)
\begin{enumerate}
    \item $\Gamma = \Gamma^*$
    \item $\fall x \neq \0\ x^T\Gamma \ol x > 0$
    \item $\fall \delta k = g(e_1, \ldots, e_k)\ \delta_k > 0$\\
    $\delta k$ -- угловой минор\\
    В частности, при $k = n\ \delta_k = g > 0$, т.е. $\Gamma$ невырожденная\\
    \textbf{Доказательство}\\
    $e_1, \ldots, e_k$ -- линейно независимые $\LRto g(e_1, \ldots, e_k) > 0$
    \item $e_1, \ldots, e_n; e'_1, \ldots, e'_n$ -- базисы $V$
    $T = T_{e\rto e'}$\\
    $\Gamma = G(e_1, \ldots, e_n)$\\
    $\Gamma' = G(e'_1, \ldots, e'_n)$\\
    Тогда $\Gamma' = T^T \Gamma \ol T$\\
    \textbf{Доказательство}\\
    $(x, y) = x'^T \Gamma' \ol y' = x^T \Gamma \ol y$\\
    $\Gamma' = (g'_{ij})$\\
    $g'_{ij} = (e'_1, \ldots, e'_j) = T_i^T \Gamma \ol{T_j} \LRto \Gamma' = T^T \Gamma \ol T$
\end{enumerate}
В частности, если $e, e'$ -- о.н.б. $V$\\
$\Gamma' = E = \Gamma$\\
$T^T \ol T = E \LRto \ol{T^T}T = E \LRto T^*T = E \LRto T^{-1} = T^*$\\
\textbf{Определение}\\
Невырожденная матрица $Q$ вещественная/комплексная называется ортогональной/унитарной, если $Q^* = Q^{-1}$\\
\textbf{Свойства унитарной/ортогональной матрицы}
\begin{enumerate}
    \item $Q$ -- унитарна/ортогональна $\LRto$ строки(столбцы) попарно ортогональны в стандартном скалярном произведении пространств $\Cset^n(\Rset^n)$\\
    \textbf{Доказательство}\\
    $Q$ унитарна/ортогональна $\LRto Q^*Q = QQ^* = E$\\
    Пусть $Q = \begin{pmatrix}
        Q_1 & Q_2 & \ldots & Q_n
    \end{pmatrix}$\\
    $Q^*Q = \ol{Q^T}Q = \begin{pmatrix}
        \ol{Q_1^T}\\
        \vdots\\
        \ol{Q_n^T}
    \end{pmatrix}\cdot \begin{pmatrix}
        Q_1 & Q_2 & \ldots & Q_n
    \end{pmatrix} = ((Q_i, Q_j)) = E$
    \item $Q$ унитарна/ортогональна $\LRto Q^{-1}$ унитарна ортогональна\\
    $\ol A \cdot (\ol{A})^{-1}\ol{AA^{-1}} = \ol E = E$
    $(Q^{-1})^* = \ol{(Q^{-1})^T}= (\ol{Q^T})^{-1} = (Q^*)^{-1} = Q$\\
    Тогда $Q = (Q^{-1})^{-1} = {Q^{-1}}^*$
    \item $Q$ унитарна/ортогональна $\Rto |\det Q| = 1$\\
    В частности, если $Q$ ортогональная, то $\det Q = \pm 1$\\
    \textbf{Доказательство}\\
    $Q^*Q = E$\\
    $\det Q^* \det Q = 1$\\
    $\det Q^* = \det(\ol{Q^*}) = \ol{\det Q}$\\
    $\det Q \ol(\det Q) = |\det Q|^2 = 1$\\
    \item $Q, R$ унитарная/ортогональная $\Rto QR$ унитарная/ортогональная\\
    \textbf{Доказательство}\\
    $(QR)^* = \ol{(QR)^T} = \ol {R^TQ^T} = \ol{R^T}\ol{Q^T} = R^*Q^* = R^{-1}Q^{-1}=(QR)^{-1}$\\
    \item $e,e'$ -- о.н.б.$V, T = T_{e\rto e'}$\\
    Тогда $T$ унитарна/ортогональна (см. своство матрицы $\Gamma$)
\end{enumerate}
\subsection{Теорема Пифагора. Задача о наилучшем приближении и перпендикуляре. Расстояние от точки до линейного подпространства и многообразия. Объем $k$-мерного параллелепипеда в $n$-мерном пространстве}
\textbf{Теорема Пифагора}\\
$\fall y,z \in V: (y, z) = 0$\\
$\|y+z\|^2 = \|y\|^2 + \|z\|^2$\\
\textbf{Доказательство}\\
$\|y+z\|^2 = (y+z, y+z) = \|y\|^2 + \ub0{(z,y)} + \ub0{(y,z)} + \|z\|^2$\\
\textbf{Следствие}\\
$x_1, \ldots, x_k$ попарно ортогональны\\
$\|x_1 + \ldots + x^k\|^2 = \sum_i \|x_i\|^2$\\\\
Пусть $L \subset V$ -- линейное подпространство\\
$V = L \oplus L^\perp$\\
$\fall x \in V\ \ex! x=y+z, y\in L, z \in L^\perp$\\
$(y,z) = 0$\\
$y$ -- ортогональная проекция $x$ на $L$\\
$z$ -- ортогональной составляющей $x$ относительно $L$ или перпендикуляром, опущенном из $x$ на линейное подпространство $L$\\
\textbf{Теорема о наилучшем приближении}\\
$L \subset V$ -- линейное подпространство\\
$\fall x \in V\ \ex! y\in L, z \in L^\perp: x = y+z$\\
$\fall l\neq y \in L \|x-y\|< \|x-l\|$\\
Т.е. $y$ является наилучшим приближением к $x$ из элементов пространства $L$\\
(Любая наклонная длиннее перпендикуляра)\\
\textbf{Доказательство}\\
$\fall l \neq y \in L$\\
$\| x - l \|^2 = \|y + z - l\|^2 = \|y-l\|^2 + \|z\| > \|z\|^2 = \|x-y\|^2$\\\\
Как найти перпендикуляр?\\
$L = \span(a_1, \ldots, a_k), a$ -- базис\\
$x = y + z, y \in L, z \in L^\perp$\\
Пусть $y = \sum_{i=1}^k c_i a_i$\\
$x = \sum_{i=1}^k c_ia_i + z$\\
$(x, a_j) = \sum_{i=1}^k c_i (a_i, a_j) + \ub0{(z, a_j)}$\\
$(x, a_j) = \sum_{i=1}^k c_i (a_i, a_j)$\\
$G^T(a_1, \ldots, a_k)\begin{pmatrix}
    c_1\\\vdots\\c_k
\end{pmatrix} = \begin{pmatrix}
    (x, a_1)\\\vdots\\(x,a_k)
\end{pmatrix}$ -- СЛНУ относительно $c_i$\\
$a_1, \ldots, a_k$ -- линейно независимые $\LRto g(a_1, \ldots, a_k) > 0 \LRto G(a_1,\ldots, a_k)$ -- невырожденная $\LRto \ex!$ решение $\Rto y = \sum_{i=1}^k c_i a_i$ -- определен однозначно\\
\textbf{Определение}\\
$\dist(x, L) = \min_{l\in L} \|x-l\| = \|x-y\|=\|z\|$\\
\textbf{Теорема о расстоянии до линейного подпространства}\\
$L = \span(a_1, \ldots, a_k), a$ -- базис\\
$\dist^2(x,L) = \frac{g(a_1, \ldots, a_k, x)}{g(a_1, \ldots, a_k)}$\\
\textbf{Доказательство}\\
$\dist^2(x,L) = \|z\|^2$\\
$a_1, \ldots, a_k \leadsto b_1, \ldots, b_k$\\
$\span(a_1, \ldots, a_k) = \span(b_1, \ldots, b_k)$\\
$z = x - \ub{z}{\sum_{i=1}^k c_ia_i} = x - \sum_i \ot c_i b_i$\\
$(z, y) = 0$\\
$a_1, \ldots, a_k, x = b_1, \ldots, b_k, z =: b_{k+1}$\\
$\|b_{k+1}\|^2 = \|z\|^2 = \frac{g(a_1, \ldots, a_k, x)}{g(a_1, \ldots, a_k)}$\\
\textbf{Определение}\\
$P = x_0 + L$ -- линейное многообразие\\
$\dist(x, P) = \min_{u \in P} \|x-u\| \ub{u = x_0 + l, l \in L}= \min_{l \in L} \|x-x_0-l\| = \dist(x-x_0, L)$\\\\
Пусть $P_1, P_2: P_i = x_i + L_i, L_i \subset V, x_i \in V$\\
$\dist(P_1, P_2) = \min_{u_1\in P_1, u_2 \in P_2} \|u_1 - u_2\| = \min_{l_1 \in L_1, l_2 \in L_2} \|x_1 - x_2 - (l_1 + l_2)\| = \dist(x_1 - x_2, L_1 + L_2) = \frac{\sqrt{g(a_1, \ldots, a_k, x_1-x_2)}}{\sqrt{g(a_1, \ldots, a_k)}} = \frac{V(\Pi(a_1, \ldots, a_k, x_1-x_2))}{V(\Pi(a_1, \ldots, a_k))}$\\
\textbf{Определение}\\
$(V, (\cdot, \cdot))$ -- евклидово\\
$a_1, \ldots, a_k$ -- линейно независимые\\
$\Pi(a_1, \ldots, a_k) = \{x \in V | x = \sum_{i=1}^k \alpha_i a_i, \_i \in [0, 1]\}$ -- $k$-мерный параллелепипед\\
(считаем, что все $a_1, \ldots, a_k$ приложены к какой-то одной точке, к $\0$, натянутой на векторы $a_1, \ldots, a_k$)\\
\textbf{Определение}\\
$V(\Pi(a_1, \ldots, a_k)) = \sqrt{g(a_1, \ldots, a_k)}$ -- объем $k$-мерного параллелепипеда\\
$V(\Pi(a_1, \ldots, a_k)) = V(\Pi(a_1, \ldots, a_{k-1}))\|h\|$\\
$\|h\| = \frac{g(a_1, \ldots, a_k)}{g(a_1, \ldots, a_{k-1})}$\\
$h \perp \span(a_1, \ldots, a_{k-1})$ из алгоритма Г.Ш.\\
$h$ -- перпендикуляр, опущенный из $a_k$ на подпространство $\span(a_1, \ldots, a_{k-1})$\\\\
Пусть $e_1, \ldots, e_n$ -- о.н.б $V$\\
$\Pi(a_1, \ldots, a_k)$ -- параллелепипед\\
$a_j \us e\lrto A_j = \begin{pmatrix}
    a_{1j}\\\vdots\\a_{nj}
\end{pmatrix}$\\
$A = \begin{pmatrix}
    A_1 & \ldots & A_k
\end{pmatrix}$\\
$V(\Pi(a_1, \ldots, a_k)) = \sqrt{\det G(a_1, \ldots, a_k)}$\\
$(a_i, a_j) = A_i^T A_j$\\
Тогда $G = A^TA$\\
Отсюда $V(\Pi(a_1, \ldots, a_k)) = \sqrt{\det G(a_1, \ldots, a_k)} = \sqrt{\det \ub{k\times n}{A^T} \ub{n\times k}A}$\\
В частности, если $k = n$, то $V(\Pi(a_1, \ldots, a_n)) = |\det A|$\\
Также можно задать ориентацию базиса: если определитель матрицы перехода из одного базиса в другой > 0, то базисы в одной ориентации. Иначе в разных\\
Тогда $\det A$ = $+V(\Pi(a_1, \ldots, a_n))$, если $a_1, \ldots, a_n$ и базис в одной ориентации\\
Иначе $\det A$ = $-V(\Pi(a_1, \ldots, a_n))$\\\\
Пусть $\mcB \in \nm{End}(V)$ -- невырожденный(изоморфизм)\\
$x \in \Pi(a_1, \ldots, a_k) \lrto x = \sum_{i=1}^k \alpha_i a_i, \alpha_i \in [0,1]$\\
$\mc B x = \sum_{i=1}^k \alpha_i \mcB a_i = \sum_{i=1}^k \alpha_i \beta_i \in \Pi(b_1, \ldots, b_k)$\\
$\mcB(\Pi(a_1, \ldots, a_k)) = \Pi(b_1 := \mcB a_1, \ldots, b_k := \mcB a_k)$\\
$V(\Pi(b_1, \ldots, b_k)) = \sqrt{g(b_1, \ldots, b_k)} = \sqrt{\det (BA)^T (BA)} = \sqrt{\det A^TB^TBA}$\\
Если $k = n$, то $V(\Pi(b_1, \ldots, b_k)) = |\det A||\det B| = V(\Pi(a_1, \ldots, a_k)) |\det B|$
\subsection{Коэффициенты Фурье. Тождество Парсеваля. Неравенство Бесселя. Ортогональные проекторы. Полиномы Лежандра}
$(V, (\cdot, \cdot))$ -- унитарное/евклидово пространство\\
$e_1, \ldots, e_n$ -- ортогональный базис\\
$\fall x\in V\ x=\sum_{i=1}^n \chi_ie_i$\\
$\fall x\in V\ (x, e_j)=\sum_{i=1}^n \chi_i(e_i, e_j) = \chi_j(e_j, e_i) = \chi_j\|e_j\|^2$\\
$\chi_j = \frac{(x, e_j)}{\|e_j\|^2}$ -- коэффициент Фурье элемента относительно ортогонального базиса\\
$L_i = \span(e_i), i = 1\ldots n$\\
$V = \bigoplus_{i=1}^n L_i$\\
$\fall x\in V\ \ex! (x_i): x = \sum_{i=1}^n x_i, x_i$ -- ортогональная проекция $x$ на $e_i$\\
$x = \chi_i e_i$\\
Тогда по т. Пифагора $\|x\|^2 = \sum_{i=1}^n \|x_i\|^2 = \sum_{i=1}^n |\chi_i|^2\|e_i\|^2$ -- тождество Парсеваля\\
Неравенство Бесселя: $\fall k=1\ldots n\ \sum_{i=1}^k |\chi_i|\|e_i\|^2 \leq \|x\|^2$ -- квадрат длины вектора не меньше суммы квадратов длин его проекций\\
В частности, если $e$ -- ортонормированный базис\\
$\chi_j = (x, e_j)$ -- проекция $x$ на вектор $e_j$\\
$x = \sum_{j=1}^n (x,e_j)e_j$\\
$x_j = \chi_j e_j$ -- проекция $x$ на вектор $e_j$\\
$\|x\|^2 = \sum_{i=1}^n |\chi_i|^2$\\
$\|x\|^2 \geq \sum_{i=1}^k |\chi_i|^2$\\\\
$\rho_i: V\rto V$ -- проектор\\
$\fall x \in V\ \rho x:= x_i$\\
$\ex! (x_i): x=\sum_{i=1}^n \ub{\in L_i}{x_i}$\\
$\rho_i$ -- оператор ортогонального проектирования\\
$V = \bigoplus_{i=1}^k L_i, L_i \subset V$ -- попарно ортогональные линейные подпространства\\
$V = \span(e_1, \ldots, e_n)$ -- о.н.б.\\
$\fall x \in V \rho_i x = \sum_{e_j \in L_j} (x_i, e_j)e_j$\\
\textbf{Примеры ортогональных систем}
\begin{enumerate}
    \item Рассмотрим множество полиномов степени не более $n$\\
    $(p,q) = \int_{-1}^1 p(t)q(t)\df t$\\
    Рассмотрим многочлены $1, t, t^2, t^3, \ldots, t^n$\\
    Найдем ортогональный базис\\
    $\ub{\text{полиномы Лежандра}}{1, t, t^2 - \frac13, t^3 - \frac35t, \ldots}$\\
    $l_k = \lambda_k ((t^2-1)^k)^{(k)}, \deg l_k = k$ -- общая формула полиномов Лежандра\\
    Покажем, что $q_k(t):= ((t^2-1)^k)^{(k)}$ ортогональны $1,\ldots, t^{k-1}$\\
    $(q_k, t^m) = \int_{-1}^1 ((t^2-1)^k)^{(k)} t^m \df t = \int_{-1}^1 t^m \df((t^2-1)^k)^{(k-1)} = $\\
    $= \ub0{t^m\ub{\pm1\text{ -- корни}}{((t^2-1)^k)^{(k-1)}} \vl_{-1}^1} - m\int_{-1}^1 ((t^2-1)^k)^{(k-1)}t^{m-1} = \ldots$\\
    $= (-1)m!\ub{((t^2-1)^k)^{k-m-1}\vl_{-1}^1}{\int_{-1}^1 ((t^2-1)^k)^(k-m) \df t}$\\
    $q_k \perp \span(1, \ldots, t^{k-1}) \Rto q_k \perp \span(l_1, \ldots, l_{k-1}) \Rto l_k \perp \span(l_1, \ldots, l_{k-1})$\\
    $(uv)^{(k)} = \sum_{m=0}^k C_k^m u^{(m)} v^{(k-m)}$ -- формула Лейбница\\
    $q_k(1) = ((t^2-1)^k)^{(k)} \vl_{t=1} = ((t-1)^k (t+1)^k)^{(k)} \vl_{t=1} = \sum_{m=0}^k C_k^m ((t-1)^k)^{(m)} ((t+1)^k)^{(k-m)}\vl_{t=1} = C_k^k \ub{k!}{((t-1)^k)^{(k)}} \ub{2^k}{((t+1)^k)^{(0)}} \vl_{t=1} = k!2^k = (2k)!!$\\
    $l_k = \frac{((t^2-1)^k)^{(k)}}{k!2^k}, l_k(1) = 1$ -- формула многочлена Лежандра в форме Родрига\\
    $B(x,y) = \int_0^1 (1-t)^{x-1}t^{y-1}\df t$\\
    $B(x,y) = \frac{\Gamma(x)\Gamma(y)}{\Gamma(x+y)}$\\
    $\|l_k\|^2 = \frac1{(2^kk!)^2} \int_{-1}^1 ((t^2-1)^k)^{(k)}\df t = \frac1{(2^kk!)^2} \int_{-1}^1 ((t^2-1)^k)^{(k)}((t^2-1)^k)^{(k)}\df t = \frac1{(2^kk!)^2} \int_{-1}^1 ((t^2-1)^k)^{(k)}\df ((t^2-1)^k)^{(k-1)} = -\frac1{((2k)!!)^2} \int_{-1}^1 ((t^2-1)^k)^{(k-1)}((t^2-1)^k)^{(k+1)} = \ldots = \frac{(-1)^k}{((2k)!!)^2} \int_{-1}^1 (t^2-1)^k \ub{(2k)!}{((t^2-1)^k)^{(2k)}}\df t = \frac{(-1)^k(-1)^k(2k)!}{((2k)!!)^2} 2\int_0^1 \frac{t(1-t^2)^k}t \df t = \frac{(2k)!}{((2k)!!)^2}\ub{B(k+1, \frac12)}{\int_0^1 (1-t)^kt^{-\frac12}\df t} = \frac{(2k)!}{((2k)!!)^2} \frac{\Gamma(k+1)\Gamma(\frac12)}{\ub{(k+\frac12)(k-\frac12)+\ldots+\frac12\Gamma(\frac12)}{\Gamma(k+1+\frac12)}} = \frac{(2k)!k!2^{k+1}}{((2k)!!)^2(2k+1)!!} = \frac{2(2k)!(2k)!!}{(2k+1)!(2k)!!} = \frac2{2k+1}$
    \item $f: [-\pi, \pi] \rto \Rset(\Cset)$\\
    $(f,g) = \int_{-\pi}^\pi f(t)g(t)\df t$\\
    $f \in L^1(-\pi, \pi) \lor f \in L^2(-\pi, \pi)$\\
    \begin{enumerate}
        \item вещественная ортогональная тригонометрическая система\\
        $1, \sin t, \cos t, \sin 2t, \cos 2t, \ldots$ -- бесконечномерная ортогональная система\\
        Несложно проверить, что $(\sin kt, \cos mt) = (\sin kt, \sin mt) = (\cos kt, \cos mt) = 0, k \neq m$\\
        $\|\cos kt\|^2 = \int_{-\pi}^\pi \cos^2 kt \df t = \int_{-\pi}^\pi \frac{1+\cos 2kt}2 \df t = \pi, k \neq 0$\\
        $\|1\|^2 = 2\pi$\\
        $\|\sin kt\|^2 = \pi$\\
        Пусть $f(t) = \sum_{i=1}^\infty c_n e_n$ -- ряд Фурье\\
        $c_j = \frac{(f, e_j)}{\|e_j\|^2}$ -- коэффициенты Фурье\\
        Тогда $a_k := \frac{(f, \cos kt)}{\|\cos kt\|^2} = \frac1\pi \int_{-\pi}^\pi f(t)\cos kt = \df t$\\
        $b_k := \frac{(f, \sin kt)}{\|\sin kt\|^2} = \frac1\pi \int_{-\pi}^\pi f(t) \sin kt \df t$\\
        Теперь забьем на сходимость и сопоставим $f$ с последовательностью коэффициентов\\
        $f \sim \frac{a_0}2 + \sum_{k=1}^\infty a_k \cos kt + b_k \sin kt$ -- ряд Фурье по классической тригонометрической системе
        \item комплексная ортогональная тригонометрическая система\\
        $c_k = \widehat{f(k)} = \frac1{\|e^{ikt}\|^2}\int_{-\pi}^{\pi} f(t)e^{-itk}\df t$\\
        $\|e^{ikb}\|^2 = \int_{-\pi}^\pi e^{ikt}e^{-ikt} \df t = 2\pi$\\
        $f \sim \sum_{k=-\infty}^\infty c_k e^{ikt}$ -- комплексный ряд Фурье\\
        \item $L^2([-1,1], \frac{\df t}{\sqrt{1-t^2}})$\\
        $(f,g) = \int_{-1}^1 f(t)g(t)\frac{\df t}{\sqrt{1-t^2}}$\\
        $T_n(t) = \cos(n-\arccos t)$ -- полиномы Чебышева\\
        $\deg T_n = n$
    \end{enumerate}
\end{enumerate}
\subsection{Изометрия евклидовых/унитарных пространств. Теорема Рисса. Естественный изоморфизм евклидова пространства своему сопряженному}
$(V, (\cdot, \cdot)_V), (V', (\cdot, \cdot)_{V'})$\\
\textbf{Определение}\\
$V, V'$ изометричны, если $V, V'$ изоморфны и сохраняется скалярное произведение\\
$x,y\in V \lrto x',y' \in V' \Rto (x,y)_V = (x', y')_{V'}$\\
Отсюда $\|x-y\|_V = \sqrt{(x,y)_V^2} = \sqrt{(x',y')_{V'}^2} = \|x'-y'\|_{V'}$ -- расстояния сохраняются\\
\textbf{Теорема}\\
Любые два конечномерных линейных пространства одной размерности изометричны\\
\textbf{Доказательство}\\
Пространства изоморфны\\
Пусть $e$ -- о.н.б. $V$\\
$e'$ -- о.н.б. $V'$\\
Тогда $x = \sum_{i=1}^n x_i e_i \lrto \sum_{i=1}^n x_i e_i' = x'$\\
$\Gamma = G(e_1, \ldots, e_n) = E = G(e_1', \ldots, e_n') = \Gamma'$\\
$(x,y)_v = \sum_{i=1}^n x_i\ol{y_i} = (x',y')_{V'}$\\\\
Зафиксируем $y \in V$\\
$\fall x \in V\ (x,y)=:f(x) \in V^*$\\
$(\cdot, y): V \rto V^*$\\
\textbf{Теорема Рисса}\\
$\fall f \in V^* \ex! y \in V: f(x) = (x,y) \fall x \in V$\\
Т.е. $V \lrto V^*$ -- взаимооднозначное сопоставление\\
\textbf{Доказательство}\\
Докажем единственность\\
Пусть $y_1, y_2 \in V: f(x) = (x, y_1) = (x, y_2) \fall x \in V$\\
Тогда $(x, y_1 - y_2) = 0$\\
Пусть $x = y_1 - y_2$\\
Тогда $\|y_1-y_2\|^2 = 0 \LRto y_1 = y_2$\\
Докажем существование\\
Пусть $e_1, \ldots, e_n$ -- о.н.б. в $V$\\
$\fall x \in V\ x=\sum_{i=1}^n x_ie_i$\\
$\fall f \in V^*\ f(x) = \sum_{i=1}^n x_if(e_i)$\\
Пусть $y_i = \ol{f(e_i)}$\\
$y = \sum_{i=1}^n y_i e_i$\\
$f(x) = (x,y)$\\
Т.о. мы сопоставили $f$ и $y$\\
Если $V$ -- евклидово (вещественное), то $V \os{P}\cong V^*$ (изоморфизм)\\
\textbf{Замечание}\\
$e_1, \ldots, e_n$ -- о.н.б. $V$\\
$\fall x \in V\ \omega^i(x) = \chi^i = (x, e_i)$\\
$x = \chi^i e_i$\\
Тогда $\omega^i \os{P}\lrto e_i$
\subsection{Тензоры в евклидовом пространстве. Метрические тензоры. Взаимные базисы. Операции опускания и поднимания индексов. Евклидовы тензоры}
Пусть $(V, (\cdot, \cdot))$ -- евклидово\\
$e_1, \ldots, e_n$ -- базис $V$\\
$\Gamma = G(e_1, \ldots, e_n) = (g_{ij})$\\
$g_{ij} = (e_i, e_j)$\\
$\Gamma$ -- тензор $\in T_{(2,0)}$ -- 2 раза ковариантный метрический тензор\\
Покажем, что $\Gamma$ -- тензор\\
$T = T_{e\rto e'}$\\
$\Gamma' = T^T \Gamma T$\\
$g'_{ij} = t^k_i g_{km} t^m_j = g_{km} t^k_i t^m_j$ -- действительно тензор\\
$\Gamma^{-1} = (g^{ij}) \in T_{(0,2)}$ -- 2 раза контрвариантный метрический тензор\\
$\Gamma^{-1} \Gamma = E$\\
$(\Gamma^{-1})' = (\Gamma')^{-1} = (T^T \Gamma T)^{-1} = (T^T)^{-1} \Gamma^{-1} T^{-1} = S^T \Gamma^{-1} S$\\
$g'^{ij} = s^i_k g^{km} s^j_m = g^{km}s^i_ks^j_m$\\
\textbf{Свойства}
\begin{enumerate}
    \item $\Gamma = \Gamma^T$\\
    $\Gamma^{-1} = (\Gamma^{-1})^T$\\
    $g^{ij} = g^{ji}, g_{ij} = g_{ji}$
    \item $\Gamma\Gamma^{-1} = E = \Gamma^{-1}\Gamma \Rto g^{ik}g_{kj} = g^{ki}g_{kj} = g^{ki}g_{jk} = g^{ik}g_{jk} = \sigma_i^j$
    \item $\fall x, y \in V\ (x,y) = g_{ij} x^i y^j, (x\neq 0 \Rto (x,x)> 0) \Rto (x \neq 0 \Rto g_{ij}x^ix^j > 0)$
\end{enumerate}
\textbf{Определение}\\
Пусть $e_1, \ldots, e_n $ -- базис $V$\\
$e^1, \ldots, e^n$ -- базис $V$\\
$e_i, e^i$ -- взаимные базисы, если $(e_i, e^j) = \sigma_i^j$\\
\textbf{Теорема}\\
$\fall e_1, \ldots, e_n$ -- базис $V \ex! e^1, \ldots, e^n$ -- взаимный базис\\
\textbf{Доказательство}\\
Пусть $e^1, \ldots, e^n$ -- базис $V$\\
$T_{e_i \rto e^i} = (x^{km})_{n\times n}$\\
$\begin{pmatrix}e^1 & \ldots & e^n\end{pmatrix} = \begin{pmatrix}e_1 & \ldots & e_n\end{pmatrix} T_{e_i\rto e^i}$\\
$(e_i, e^j) = (e_i, x^{kj} e_k) = x^{kj} \ub{g_{ik}}{(e_i, e_k)} = \sigma_i^j$\\
$g_{ik}x^{kj} = \sigma^j_i \LRto \Gamma T_{e_i \rto e^i} = E$\\
$T_{e_i \rto e^i} = \Gamma^{-1}$\\
$e^1,\ldots, e^n$ -- взаимооднозначное с $e_1,\ldots, e_n$\\
\textbf{Следствие 1}
\begin{enumerate}
    \item $e_i, e^i$ -- взаимные базисы\\
    $\begin{pmatrix}
        e^1 & \ldots & e^n
    \end{pmatrix} = \begin{pmatrix}
        e_1 & \ldots & e_n
    \end{pmatrix}\Gamma^{-1} \lrto e^j = g^{kj}e_k = g^{jk}e_k$\\
    $\begin{pmatrix}
        e_1 & \ldots & e_n
    \end{pmatrix} = \begin{pmatrix}
        e^1 & \ldots & e^n
    \end{pmatrix}\Gamma \lrto e_j = g_{kj}e^k = g_{jk}e^k$
    \item $\Gamma^{-1} = G(e^1, \ldots, e^n)$\\
    \textbf{Доказательство}\\
    $(e^i, e^j) = (e^i, g^{jk}e_k) = g^{jk}(e^i,e_k)=g^{jk}\sigma^j_k = g^{ji} \in \Gamma^{-1}$
\end{enumerate}
\textbf{Следствие 2}\\
$e_1, \ldots, e_n$ -- о.н.б.\\
Тогда $e^i = e_i$\\
\textbf{Доказательство}\\
Очевидно, $\Gamma = E = \Gamma^{-1}$\\
\textbf{Замечание}
\begin{enumerate}
    \item на практике скалярное произведение, в свою очередь, может быть задано какой-то матрицей Грамма, относительно какого-то другого базиса
    \item $e_1, \ldots, e_n$ и $e_1', \ldots, e_n'$ -- имеют один класс ориентации, если $\det T_{e\rto e'} > 0$\\
    Отсюда взаимные базисы принадлежат к одному классу ориентации
\end{enumerate}
\textbf{Теорема 2}\\
Если $e_1, \ldots, e_n$ -- базис пространства $V$\\
$\omega^1, \ldots, \omega^n$ -- сопряженный базис $V^*$\\
Тогда $\omega^i \os{P}\lrto e^i \in V \Rto e^1, \ldots, e^1, \ldots, e^n$ -- взаимный с $e_1, \ldots, e_n$\\
\textbf{Доказательство}\\
$\fall \omega^i \in V^*\ \ex! e^i \in V: \omega^i(x) = (x, e^i) \fall x \in V$\\
Пусть $x = e_j\ \ub{\sigma_i^j}{\omega^i(e_j)} = (e_j, e^i) \Rto $ взаимный базис\\
\textbf{Замечание}\\
$e$ -- о.н.б. из теоремы Рисса такой, что $\omega^i \os P\lrto e_i$\\
$\omega^i \os P\lrto e^i$\\
Отсюда $e^i = e_i$ (снова следствие 2)\\
\textbf{Определение}\\
$e_1, \ldots, e_n$ и $e^1, \ldots, e^n$ -- взаимные базисы\\
$\fall x = x^ie_i = x^j e^j$\\
$x_j$ -- ковариантные координаты\\
$x^i$ -- контрвариантные координаты\\\\
координатная функция относительно базиса $e^i \lrto (x, e_i) = (x_j e^j, e_i) = x_j (e^j, e_i) = x_j \sigma_i^j = x_i$\\
$\omega^j \lrto (x, e^j) = (x^i e_i, e^j) = x^i(e_i, e^j) = x^i\sigma^j_i = x^j$\\
$x = (x, e_i)e^i = (x, e^j)e_j$ -- формула Гибса\\
$T= T_{e\rto e'}$\\
$\begin{pmatrix}x^1\\\vdots\\x^n\end{pmatrix} = T\begin{pmatrix}x'^1\\\vdots\\x'^n\end{pmatrix}$ -- контрвариантный\\
$\omega^j \os P \cong e^j$\\
$x_j \omega^j \cong x_j  e^j$\\
$\begin{pmatrix}x_1 & \ldots & x_n\end{pmatrix} = \begin{pmatrix}x'^1 & \ldots &x'^n\end{pmatrix}S$ -- ковариантный\\\\
Рассмотрим координаты как тензоры\\
$(x^i) \lrto T_{(0,1)}$\\
$(x_i) \lrto T_{(1,0)}$\\
Рассмотрим свертку с соответствующим метрическим тензором\\
$g_{ki} x^i =(e_k, e_i) x^i = (e_k, e_ix^i) = (e_k, x) = (x, e_k) = x_k$\\
Свертка контрвариантного тензора с ковариантным метрическим тензором дает ковариантный тензор -- опускание индекса\\
$g^{jk} x_j = (e^j, e^k) x_j = (x_j e^j, e^k) = (x, e^k) = x^k$\\
Свертка ковариантного тензора с контрвариантным метрическим тензором дает контрвариантный тензор -- поднятие индекса\\\\
Определим операции для произвольных тензоров\\
Рассмотрим $\alpha\in T_{(p,q)}$\\
Операцией опускания поднятия индекса называется преобразование матрицы тензора в результате его свертки с ковариантным/контрвариантным метрическим тензором. При этом, чтобы сохранить соответствия записи элементов в матрице тензора применяют следующие правила записи
\begin{enumerate}
    \item Если опускается крайний правый верхний индекс, он становится крайним левым нижним\\
    $\alpha^{i_1, \ldots, i_{q-1}, \kappa}_{j_1, \ldots, j_p} g_{\kappa,j_0} = \alpha^{i_1, \ldots, i_{q-1}}_{j_0, \ldots, j_p}$
    \item Если поднимается крайний левый нижний индекс, он становится крайним правым верхним\\
    $\alpha^{i_1, \ldots, i_q}_{\kappa, j_2, \ldots, j_p} g^{\kappa,i_{q+1}} = \alpha^{i_1, \ldots, i_{q+1}}_{j_2, \ldots, j_p}$
    \item Если происходит опускание или поднятие остальных индексов, его прежняя позиция обозначается точкой. Сам индекс при этом занимает крайнюю левую нижнюю/правую верхнюю позицию\\
    $\alpha^{i_1, \ldots, \kappa, \ldots, i_q, \kappa}_{j_1, \ldots, j_p} g_{\kappa,j_0} = \alpha^{i_1, \ldots, \bullet, \ldots, i_q}_{j_0, \ldots, j_p}$\\
    $\alpha^{i_1, \ldots, i_q}_{j_1, \ldots, \kappa, \ldots, j_p} g^{\kappa,i_{q+1}} = \alpha^{i_1, \ldots, i_{q+1}}_{j_1, \ldots, \bullet, \ldots, j_p}$
    \item Если опускаются/поднимаются несколько индексов то их прежние позиции обозначаются точками, а сами они записываются по тем же правилам с сохранением исходного порядка
\end{enumerate}
Если базис ортонормированный, то поднятие/опускание индексов не меняет тензор\\
Если $e_1, \ldots, e_n; e_1', \ldots, e_n'$ -- о.н.б. базисы, то $T = T_{e\rto e'}$ -- ортогональная (т.е. $T^{-1} = T^T$)\\
Тогда $\alpha'^{k^1, \ldots, k_q}_{m_1,\ldots, m_p} = \alpha_{j_1, \ldots, j_p}^{i_1, \ldots, i_q} t^{j_1}_{m_1}\cdot t_{m_p}^{j_p} s_{i_1}^{j_p} \ldots s_{i_q}^{k_q} = \sum_{i_1}\sum_{i_2}\ldots\sum_{i_q} \alpha^{i_1,\ldots, i_q} t^{j_1}_{m_1}\cdot t_{m_p}^{j_p} t^{i_1}_{j_p} \ldots t^{i_q}_{k_q}$\\
После приведения к о.н.б. в $V$ получаем тензоры, которые отличаются только расположением тензора сверху/снизу. Такие тензоры называются \it{евклидовы} ранза $r=p+q$\\
Для них нет разницы, сверху или снизу индексы (пока мы переходим по ортонормированным базисам), поэтому пишем все внизу
\section{Линейные операторы в унитарном/евклидовом пространстве}
\subsection{Сопряженные операторы в унитарном/евклидовом пространстве}
\textbf{Определение}\\
$\mcA \in L(U, V)$\\
$\mcA^*: V^* \rto U^*$ -- сопряженное к $\mcA$\\
$\fall f \in V^*\ \fall x \in U\ (\mcA^* f)(x) = f(\mcA x)$\\
Заметим, что $\mcA$ -- линейное отображение\\
Пусть $\mcA^* f = g$\\
$g(x) = f(\mcA x) \in K$ -- линейно по $x$, т.к. $\mcA, f$ -- линейные\\
Тогда $g \in U^*$\\
Тогда $\mcA^*: V^*\rto U^*$\\
$\fall \lambda \in K \fall f_1, f_2 \in V^*$\\
$\fall x \in U\ (\mcA^*(\lambda f_1 + f_2))(x) = ( \lambda f_1 + f_2)(\mcA x) = \lambda f_1(\mcA x) + f_2(\mcA x) = \lambda(\mcA^* f_1)(x)  + (\mcA^* f_2)(x)$\\\\
$\us x U \os \mcA \rto \us{\mcA x}V$\\
$\us{g=\mcA^* f}{U^*} \us{\mcA^*}\lto \us f {V^*}$\\
Пусть $(V, (\cdot, \cdot))$ -- унитарное/евклидово, $\mcA \in \nm{End}(V)$\\
$V^* \os P \lrto V$ -- естественный изоморфизм\\
$f \in V^* \os P \lrto y\in V$\\
$\fall x \in V\ f(x) = (x,y)$\\
$\mcA^*: V^* \rto V^*$\\
$\ex!  z \in V \os P \lrto g \in V^*$\\
$\ex! y \in V \os P \lrto f \in V^*$\\
$\fall x \in V\ g(x) = (x, z), f(x) = (x, y)$\\
По определению $\mcA^*: g(x) = (\mcA^* f)(x) = f(\mcA x) = (\mcA x, y)$\\
$\mcA^*: \ub{\os P \lrto V}{V^*} \rto \ub{\os P \lrto V}{V^*}$\\
\textbf{Определение}\\
$\mcA \in \nm{End}(V)$\\
$\mcA^* \in \nm{End}(V)$ называется сопряженным к $\mcA$, если $\fall x, y \in V\ (x, \mcA^* y) = (\mcA x,y)$\\
\textbf{Замечание}\\
$\mcA^*$ зависит от скалярного произведения\\
При фиксированном скалярном произведении $\mcA^*$ определен однозначно\\
Если поменять скалярное произведение, получим другое евклидово/унитарное пространство\\
Тогда и $\mcA^*$ будет другим\\
\textbf{Свойства сопряженного оператора}
\begin{enumerate}
    \item $A, A^{(*)}$ -- матрицы $\mcA$ и $\mcA^*$ в некотором базисе $e_1, \ldots, e_n$ пространства $V$\\
        Тогда $A^{(*)} = \ol {\Gamma^{-1}} A^* \ol \Gamma = \ol{\Gamma^{-1} A^T \Gamma}$\\
        \textbf{Доказательство}\\
        $\fall x, y \in V$\\
        $(x, \mcA^* y) = \sum_{j=1}^n \sum_{i=1}^n g_{ij} x_i \ol{A^{(*)} y}_j = x^T \Gamma \ol{\mcA^{(*)} y}$\\
        $(\mcA x, y) = \sum_{i=1}^n \sum_{j=1}^n g_{ij} (A x)_i \ol{y}_j = (A x)^T \Gamma y $\\
        $x^T \Gamma A^{(*)} \ol y = x^T A^T \Gamma \ol y $\\
        Пусть $x = e_i, y = e_j$\\
        $( \Gamma \ol{A^{(*)}})_{ij} = (A^T \Gamma)_{ij} $\\
        $ \Gamma \ol{A^{(*)}} = A^T \Gamma $\\
        $ \ol{A^{(*)}} = \Gamma^{-1}A^T \Gamma $\\
        В частности, если о.н.б., то $T = E \Rto A^{(*)} = A^* = \ol{A^T} $
    \item $\fall \lambda \in K\ (\mcA + \lambda\mcB)^* = \mcA^* + \ol \lambda \mcB^* $\\
        Если евклидово пространство, то $*$ -- линейное, если унитарное -- полуторолинейное
    \item $(\mcA \circ \mcB)^* = \mcB^* \mcA^*$\\
    \item Если $\ex \mcA^{-1}$, то $\ex (\mcA^*)^{-1}$, причем $(\mcA^*)^{-1} = (\mcA^{-1})^* $\\
        \textbf{Доказательство}\\
        $(\mcA \mcA^{-1})^* = (E)^* = \eps $\\
        $(\mcA^{-1})^* \mcA^* = \eps $\\
        Отсюда $\ex (\mcA^*)^{-1} = (\mcA^{-1})^* $
    \item $(\mcA^*)^* = \mcA $\\
        \textbf{Доказательство}\\
        $(x, \mcA^* y) = (\mcA x, y) $\\
        $\ol{(\mcA^* y, x)} = \ol{(y, \mcA^x)} $\\
        $(\mcA^* y, x) = (y, \mcA x)$\\
        Тогда по определению $\mcA = (\mcA^*)^* $
    \item $\ker \mcA^* = (\im \mcA)^\perp $\\
        $\im \mcA^* = (\ker \mcA)^\perp $\\
        \textbf{Доказательство}\\
        Пусть $y \in \ker \mcA^*$\\
        $(x, \ub{0}{\mcA^* y}) = (\mcA x, y)$\\
        Тогда $y \perp \mcA x \Rto y \perp \im \mcA $\\
        Тогда $\ker \mcA^* \subset (\im \mcA)^\perp $\\
        $\dim \ker \mcA^* = \dim \ker A^{(*)} = \ker \ol{ \Gamma^{-1} A^T \Gamma} = n - \rg( \Gamma^{-1}A^T \Gamma) = n - \rg A^T = n - \dim \im \mcA = \dim (\im \mcA)\perp$\\
        Тогда $\ker \mcA^* = (\im \mcA)^\perp $\\
        $\ker \mcA = (\im \mcA^*)\perp$\\
        Тогда $\im \mcA^* = (\ker \mcA)^\perp$\\
    \item $\chi( \lambda) = 0 \LRto \chi_{\mcA^*} ( \lambda) = 0$\\
        \textbf{Доказательство}\\
        $\chi_{\mcA^*}(t) = \det (\mcA^{(*)} - tE) = \det(\ol{ \Gamma^{-1}A^T \Gamma} - tE) = \ol{\det( \Gamma^{-1}A^T) \Gamma  - \ol t \ub{E}{\Gamma^{-1} \Gamma}} = \ol{\det( \Gamma^{-1}(A^T - \ol tE) \Gamma)} = \ol{\det (A^T - \ol t E)}  = \ol {\chi_\mcA(\ol t)} $
    \item $ \lambda$ -- с.ч., $u$ -- с.в. $\mcA$\\
        $\mu \neq \ol \lambda$ -- с.ч., $v$ -- с.в. $\mcA^*$\\
        Тогда $u \perp v$\\
        \textbf{Доказательство}\\
        $ \lambda(u, v) = ( \lambda u, v) = (\mcA u, v) = (u, \mcA^* v) = (u, \mu v) = \ol \mu (u, v)$\\
        $( \lambda - \ol \mu)(u, v) = 0 \LRto (u, v) = 0$
    \item $L \subset V$ -- инвариантное относительно $\mcA \Rto L^\perp$ - инвариантное относительно $\mcA^*$\\
        \textbf{Доказательство}\\
        $\fall x \in L, y \in L^\perp\ (x, \mcA^* y) = (u\ub{\in L}{\mcA x}, \ub{\in L^\perp}y) = 0 \Rto \mcA^* y \in L^\perp$
\end{enumerate}
\subsection{Нормальные операторы и их свойства}
\textbf{Определение}\\
$\mcA \in \nm{End}(V), (V, (\cdot, \cdot))$\\
$\mcA$ -- нормальный, если $\mcA\mcA^* = \mcA^*\mcA$\\
Или $(\mcA x, \mcA y) = (\mcA^* x, \mcA^* y)$\\
\textbf{Свойства}
\begin{enumerate}
    \item $\mcA$ -- нормальный $\LRto A^{(*)}A = AA^{(*)} $, где $A, A^{(*)}$ -- матрицы операторов в некотором базисе
    \item $\ker \mcA^* = \ker \mcA$\\
        $\im \mcA^* = \im \mcA$\\
        $\ker \mcA^2 = \ker \mcA$\\
        Тогда $V = \ker \mcA \oplus \im \mcA $\\
        \textbf{Доказательство}\\
        $x \in \ker \mcA \LRto \mcA x = \0 \LRto (\mcA x, \mcA x) = 0 \LRto (\mcA^* x, \mcA^* x) = 0 \LRto \mcA^* x = \0 \LRto x \in \ker \mcA^*$\\
        $(\im \mcA)^\perp = \ker \mcA^* = \ker \mcA$\\
        $\im \mcA = (\ker \mcA)^\perp = \im \mcA^*$\\
        Пусть $x \in \ker \mcA^2 \LRto (\mcA^2 x \mcA^2 x) = 0 \LRto (\mcA^* \mcA x, \mcA^* \mcA x ) = 0 \LRto \mcA^*(\mcA x) = 0 \Rto \ub{\in \im \mcA}{\mcA x} \in \ker \mcA^* = \ker \mcA$\\
        $\mcA x \in \im \mcA \cap \ker \mcA \Rto \mcA x = 0$\\
        $x \in \ker \mcA$\\
        Тогда $\ker \mcA^2 \subset \ker \mcA$\\
        Очевидно также, что $\ker \mcA^2 \supset \ker \mcA$\\
        Отсюда $\ker \mcA = \ker \mcA^2$
    \item Если $\mcA$ -- нормальный, то $\mcB = \mcA - \lambda \eps$ -- нормальный оператор
        \textbf{Доказательство}\\
        $\mcB^* = \mcA^* - \ol\lambda \eps$\\
        $\mcB \mcB^* = (\mcA - \lambda\eps)(\mcA^* - \ol \lambda\eps) = \mcA \mcA^* - \lambda\mcA^* - \ol \lambda\mcA + | \lambda|^2 \eps $\\
        Аналогично $\mcB^*\mcB = \mcA^*\mcA - \ol \lambda\mcA - \lambda\mcA^*  + | \lambda|^2\eps $\\
        Отсюда ч.т.д.
    \item $ \lambda $ -- с.ч., $u$ -- с.в. $\mcA \Rto \ol \lambda$ -- с.ч., $u$ -- с.в. $\mcA^*$\\
        \textbf{Доказательство}\\
        $\chi_\mcA( \lambda) = 0 \LRto \chi_{\mcA^*}(\ol \lambda) = 0 $\\
        $u$ -- с.в. $\mcA \LRto \mcA u = \lambda u \LRto \mcB u = 0 \LRto u \in \ker \mcB = \ker \mcB^* \LRto \mcB^*u = \0 \LRto \mcA^* u = \ol \lambda u \LRto u$ -- с.в. $\mcA^*$
    \item $ \lambda$ -- с.ч., $u$ -- с.в. $\mcA$\\
        $ \mu \neq \lambda$ -- с.ч., $v$ -- с.в. $\mcA$\\
        Тогда $u \perp v$\\
        Т.о. собственные подмножествва $V_ \lambda \perp V_ \mu$\\
        \textbf{Доказательство}\\
        $ \lambda(u, v) = ( \lambda u, v) = (\mcA u, v) = (u, \mcA^* v) = (u, \ol \mu v) = \mu(u, v)$\\
        Отсюда $(u, v) = 0 \LRto u \perp v$
\end{enumerate}
\textbf{Теорема о каноническом виде матрицы нормального оператора в унитарном пространстве}\\
$\mcA \in \nm{End}(V), (V, (\cdot, \cdot))$ -- унитарное\\
$\mcA$ -- нормальный оператор $\LRto \ex$ о.н.б. такой, что матрицы оператора $\mcA$ в этом базисе будет иметь диагональный вид $ \Lambda = \nm{diag}( \lambda_1, \ldots, \lambda_n)$\\
Причем, матрица $\mcA^*$ в этом базисе также будет иметь диагональный вид $\ol{ \Lambda} = \nm{diag}(\ol \lambda_1, \ldots, \ol \lambda_n)$\\
\textbf{Замечание}
$ \lambda_1, \ldots, \lambda_n$ -- с.ч. $\mcA$\\
$\ol \lambda_1, \ldots, \ol \lambda_n$ -- с.ч. $\mcA^*$\\
$\mcA$ -- нормальный $\Rto \mcA$ -- о.п.с., но не наоборот\\
о.н.б. -- из собственных векторов\\
\textbf{Доказательство}\\
Пусть $ \lambda_1, v_1$ -- с.ч. и с.в. $\mcA$\\
Рассмотрим $L = \span(v_1), V - L \oplus L^\perp$\\
$L$ -- инвариантное относительно $\mcA \Rto L^\perp$ -- инвариантное относительно $\mcA^*$\\
Также по свойству 4 $v_1$ -- с.в. $\mcA^* \Rto L$ -- инвариантное относительно $\mcA^* \Rto L^\perp$ инвариантное относительно $\mcA$\\
Тогда $\mcA \vl_{L^\perp}, \mcA^* \vl_{L^\perp}$ -- остаются взаимосопряженными и нормальными\\
Применим метод математической индукции:\\
База: $n = 1$ -- очевидно\\
Пусть для $n = k$ выполнено. Докажем для $k+1$\\
Пусть $ \lambda_1, v_1$ -- с.ч. и с.в. $\mcA$\\
$L = \span(v_1)$\\
$V = L \oplus L^\perp, \dim L^\perp = k$\\
По индукционному предположению для $\mcA\vl_{L^\perp}\ \ex$ о.н.б. $v_2, \ldots, v_{k+1}$ в $L^\perp$ из с.в., матрицы $\mcA\vl_{L^\perp}$ имеет диагональный вид $\nm{diag}( \lambda_2, \ldots, \lambda_{k+1})$\\
Т.к. $V = L\oplus L^\perp$, матрица $\mcA$ имеет диагональный вид $\nm{diag}( \lambda_1, \ldots, \lambda_{k+1})$\\
$v_1 \perp v_2, \ldots, v_{k+1}$\\
В обратную сторону очевидно\\
\textbf{Следствие 1}\\
$\mcA$ -- нормальный в унитарном пространстве $\LRto V = \bigoplus_{ \lambda}V_\lambda, V_\lambda \perp V_\mu, \lambda != \mu$\\
\textbf{Следствие 2}\\
$AA^* = A^*A$ -- нормальная матрица\\
$a_{ij} \in \Cset \Rto \ex$ унитарная матрица $T: T^*AT = \ol{T^T}AT = \Lambda = \nm{diag}( \lambda_1, \ldots, \lambda_n), \lambda_i$ -- с.ч. $\mcA$\\
\textbf{Доказательство}\\
$A^*$ -- матрица $\mcA^*$ в о.н.б.\\
$A$ -- матрица $\mcA$\\
Тогда по теореме существует базис и о.н.с.в. $A$\\
$T = \begin{pmatrix}
    v_1 & v_2 & \ldots & v_n
\end{pmatrix}$ -- о.н.с.в. $= T_{e\rto v}$\\
$T^{-1} = A T = \Lambda = \nm{diag}( \lambda_1, \ldots, \lambda_n)$ -- т.к. $v_1, \ldots, v_n$ -- попарно ортогональны и нормированы\\
$\LRto T$ -- унитарная матрица $\LRto T^{-1} = \ol{T^T} = T^*$\\\\
Что будет в евклидовом пространстве?\\
$A$ -- вещественная матрица $\Rto \chi_\mcA$ -- вещественные коэффициенты\\
Не все корни $\chi_{\mcA}$ -- собственные числа, а только вещественные\\
\textbf{Определение}\\
$V$ -- линейное пространство над $\Rset$\\
$(V, (\cdot, \cdot))$ -- евклидово пространство\\
$V_\Cset$ -- комплексификация $V$\\
$\fall z = x + iy, w=u+iv \in V_\Cset, x, y, u, v \in V\ (z, w):= (x, y) + (y, v) + i(-(x, v) + (y, u))$\\
$(V_\Cset, (\cdot, \cdot))$ -- унитарное пространство\\
\textbf{Упражнение}\\
$\ol{(z_1, z_2)} = (\ol z_1, \ol z_2)$\\
$\mcA \in \nm{End}(V)$
$\mcA_\Cset \in \nm{End}(V_\Cset)$\\
$\mcA_\Cset (x+iy) = \mcA x + i \mcA y$\\
\textbf{Напоминание}\\
$e_1, \ldots, e_n$ -- базис $V \Rto $ базис $V_\Cset$\\
$\chi_A(t) = \chi_{A_\Cset}(t)$\\
$\ol{\mcA_\Cset z} = \mcA_\Cset(\ol z)$\\
$ \lambda, z$ -- с.ч., с.в. $\mcA_\Cset \Rto \ol \lambda, \ol z$ -- с.ч., с.в. $\mcA_\Cset$\\
$\mcA_\Cset \ol z = \ol{\mcA_\Cset z} = \ol{ \lambda z} = \ol \lambda \ol z$\\
\textbf{Свойства}
\begin{enumerate}
    \item $ \lambda \in \Rset, V_ \lambda$ -- с.ч. и собственное подпространство $\mcA \Rto \lambda, (V_ \lambda)_\Cset$ -- с.ч. и с.п. $\mcA_\Cset$\\
        \textbf{Доказательство}
        //todo 12:10 11.05
    \item $ \lambda, z$ -- с.ч. и с.в. $\mcA$\\
        $\ol \lambda, \ol z$ -- с.ч. и с.в. $\mcA_\Cset$\\
        $z = u + iv, \ol z = u - iv$\\
        Тогда $(z, \ol z) = 0 \Rto u \perp v, \|u\| = \|v\|$\\
        \textbf{Доказательство}\\
        $0 = (z, \ol z) = (u + iv, u - iv) = \ub 0{(u,u) - (v,v)} + \ub{0}{i(v,u) + i(u, v)}$
    \item $(\mcA_\Cset)^* = (\mcA^*)_\Cset$\\
        \textbf{Доказательство}\\
        $e_1, \ldots, e_n$ -- о.н.б. $V \rto e_1, \ldots, e_n$ -- о.н.б. в $V_\Cset$\\
        $\mcA \lrto A, \mcA^* \lrto A^T \Rto (\mcA^*)_\Cset \lrto A^T$\\
        $\mcA_\Cset \lrto A, (\mcA_\Cset)^* \lrto A^T$
    \item $(\mcA \mcB)_\Cset = \mcA_\Cset, \mcB_\Cset$\\
        \textbf{Доказательство}\\
        $(\mcA\mcB)_\Cset z = (\mcA\mcB) x + i (\mcA\mcB)y = \mcA_\Cset (\mcB x + i\mcB y) = \mcA_\Cset \mcB_\Cset z$\\
    \item $\ex \mcA^{-1} \Rto (\mcA_\Cset)^{-1}$, причем $(\mcA_\Cset)^{-1} = (\mcA^{-1})_\Cset$\\
        \textbf{Доказательство}\\
        $\chi_\mcA = \chi_{\mcA_\Cset} \Rto \ex (\mcA_\Cset)^{-1}$\\
        $\mcA_\Cset \mcA_\Cset^{-1} = \eps = (\mcA \mcA^{-1})_\Cset = \mcA_\Cset (\mcA^{-1})_\Cset$
    \item $\mcA$ нормальный $\Rto \mcA_\Cset$ нормальный
\end{enumerate}
\textbf{Теорема о каноническом виде матрицы нормального оператора в евклидовом пространстве}\\
$\mcA \in \nm{End}(V), (V, (\cdot, \cdot))$ -- евклидово пространство\\
$\mcA$ -- нормальный оператор $\LRto \ex$ о.н.б. пр-ва $V$ такой, что матрица оператора $\mcA$ в этом базисе будет иметь блочно-диагональный вид $ \Lambda = \nm{diag}( \lambda_1, \ldots, \lambda_k, \Phi_1, \ldots, \Phi_m)$, где $ \lambda_i \in R$ -- с.ч. $\mcA$\\
$ \Phi_i = \begin{pmatrix}
    \alpha_i & \beta_i\\
    -\beta_i & \alpha_i 
\end{pmatrix}, \alpha_i, \beta_i \in \Rset$, где $ \alpha_i \pm i \beta_i$ -- комплексные сопряженные корни характеристического многочлена $\mcA$\\
Причем, матрица $\mcA^*$ имеет вид $ \Lambda^* = \Lambda^T = \nm{diag}( \lambda_1, \ldots, l_k, \Phi_1^T, \ldots, \Phi_m^T)$\\
\textbf{Доказательство $\Lto$}\\
Очевидно: $ \Phi_i^T \Phi_i = \begin{pmatrix}
    \alpha_i^2 + \beta_i^2 & 0\\
    0 & \alpha_i^2 + \beta_i^2
\end{pmatrix} = \Phi_i \Phi_i^2$\\
\textbf{Доказательство $\Rto$}\\
Если все корни $\chi_\mcA$ вещественные, все очевидно\\
Иначе применим комплексификацию\\
$\mcA$ -- нормальный $\Rto \mcA_\Cset$ нормальный, $V_\Cset$ -- унитарное пространство\\
Тогда по теореме $\ex$ о.н.б. $w_1, \ldots, w_n$ из с.в. $\mcA_\Cset$ такой, что матрица $\mcA_\Cset$ будет иметь диагональный вид\\
$V = \bigoplus_{\lambda\text{-- с.в. } \mcA_\Cset} V_ \lambda = \bigoplus_{i=1, \lambda_i \in \Rset}^k V_{ \lambda_i}^\Cset \oplus \bigoplus_{\mu, \ol \mu} \span(z_j^\mu, \ol{z}_j^{\ol \mu})$\\
$\mu, \ol \mu$ -- комплексные сопряженные корни $\chi_\mcA$\\
$z, \ol z$ -- с.в., пусть они нормированные\\
$(z, \ol z) = 0$\\
$z = u + iv, u,v \in V$\\
$V_\lambda \perp V_\mu$\\
$V_{ \lambda_i}^\Cset = $ по свойству 1 $= (V_ {\lambda_i})_\Cset = \span^\Cset(\omega_1, \ldots, \omega_k)$\\
$(z, \ol z) = 0 \Rto u \perp v, \|u\| = \|v\|$\\
$\span^\Cset(z, \ol z) = \span^\Cset(u, v) = (\span(u,v))_\Cset$\\
Тогда $V_\mu^\Cset = \span^\Cset(z_1, \ldots, z_r) \perp V_{\ol \mu}^\Cset = \span^\Cset(\ol z_1, \ldots, \ol z_r)$\\
$V_\Cset = \span^\Cset(\omega_1, \ldots, \omega_k, u_1, v_1, u_2, v_2, \ldots), \omega, u, v$ -- вещественные вектора\\
$\|z_i\|^2 = 1 = \|u_i\|^2 + \|v_i\|^2, \|u_i\|=\|v_i\| \Rto \|u_i\|=\|v_i\| = \frac1{\sqrt{2}}$\\
$\mcA_\Cset \lrto A \lrto \mcA$ -- в вещественном базисе\\
$\mcA_\Cset z_i = \mu_i z_i$\\
$\mu_i = \alpha_i + i \beta_i$\\
$\mcA_\Cset z_i = \frac12 \mcA_{\Cset}(z_i + \ol z_i) = \frac12(\mu_i z_i + \ol \mu_i \ol z_i) = \re(\mu_i z_i) = \re(( \alpha_i + i \beta_i)(u_i + i b_i)) = \alpha_i u_i - \beta_i v_i \lrto \begin{pmatrix}0\\0\\\vdots\\0\\ \alpha_i \\ - \beta_i\\0\\\vdots\end{pmatrix}$\\
$\mcA_\Cset v_i = \frac1{2i} \mcA_\Cset(z_i - \ol z_i) = \frac1{2i}(\mu_iz_i - \ol \mu_i \ol z_i) = \Im (\mu_i z_i) = \beta_i u_i + \alpha_i v_i \lrto \begin{pmatrix}0\\0\\\vdots\\0\\\beta_i\\\alpha_i\\0\\\vdots\end{pmatrix}$\\
Осталось ортогонализовать базис. Заменим $u_i$ на $\sqrt(2)u_i, v_i$ -- на $\sqrt(2)v_i$\\
Т.о. мы получили матрицу из теоремы\\
\textbf{Следствие}\\
$AA^* = A^*A(AA^T = A^TA)$\\
$a_{ij} \in \Rset$\\
Тогда $\ex$ ортогональная матрица $T$ такая, что $T^T AT = \Lambda = \nm{diag}( \lambda_1, \ldots, \lambda_k, \Phi_i, \ldots, \Phi_m)$\\
\textbf{Доказательство}\\
$T = \begin{pmatrix}\omega_1 & \ldots & \omega_k & u_1 & v_1 & \ldots\end{pmatrix}$\\
$T$ -- ортогональная матрица $\LRto T^{-1} = T^* = T^T$
\subsection{Самосопряженные операторы и их свойства. Изометрические операторы и их свойства}
\textbf{Определение}\\
$\mcA$ -- называются самосопряженный, если $\mcA = \mcA^*$\\
Если $V$ унитарное, то -- эрмитовый\\
Если $V$ евклидово, то -- симметричный\\
$\LRto (\mcA x, y) = (x, \mcA y)$\\
\textbf{Замечание}\\
Если $\mcA$ -- самосопряженный, то $\mcA$ -- нормальный\\
\textbf{Свойства}
\begin{enumerate}
    \item $\mcA$ -- самосопряженный $\LRto \ex$ о.н.б. такой, что $A^* = A$
    \item $\mcA, \mcB$ самосопряженные $\Rto \fall \lambda \in \Rset\ \mcA + \lambda\mcB$ -- самосопряженный
    \item $\mcA, \mcB$ -- самосопряженные и перестановочные $\Rto \mcA\mcB, \mcB\mcA$ -- самосопряженные
    \item Если $\ex \mcA^{-1}, \mcA$ -- самосопряженный $\Rto \mcA^{-1}$ -- самосопряженный\\
    \textbf{Доказательство}\\
    $(\mcA^{-1}\mcA)^* = \eps^* = \eps$\\
    $\mcA^* (\mcA^{-1})^* = \eps$\\
    $\mcA(\mcA^{-1})^* = \eps \Rto (\mcA^{-1})^* = \mcA^{-1}$
    \item $\mcA$ самосопряженный $\LRto \mcA$ нормальный и все корни $\chi_\mcA$ вещественные\\
        \textbf{Доказательство для унитарного пространства}\\
        По теореме о каноническим виде матрицы\\
        $\mcA \lrto \Lambda = \nm{diag}( \lambda_1, \ldots, \lambda_n)$\\
        $\mcA^* \lrto \ol{ \Lambda^T} = \nm{diag}{\ol \lambda_1, \ldots, \ol \lambda_n}$\\
        $\mcA = \mcA^* \lrto \Lambda = \ol{ \Lambda^T} \LRto \lambda_i = \ol{ \lambda_i} \LRto \lambda_i \in \Rset$\\
        \textbf{Доказательство для евклидова пространства}\\
        По теореме о каноническом виде матрицы\\
        $\mcA = \mcA^* \LRto \Lambda = \Lambda^T$\\
        $ \Phi_i = \Phi_i^T \LRto \beta_i = 0$\\
        Тогда нет блоков $ \Phi_i \Rto \Lambda$ -- диагональная $\Rto \lambda_i$ вещественные
    \item $L \subset V$ -- линейное подпространство\\
        $L$ -- инвариантно относительно $\mcA \Rto L^\perp$ инвариантно относительно $\mcA$
\end{enumerate}
//todo 11.05 13:56
\textbf{Следствие 2}\\
$\mcA^* = \mcA \Rto \ex$ унитарная/ортогональная $T$ такая, что $T^*AT$ имеет диагональный вид\\
\textbf{Определение}\\
$Q$ невырожденный $\in \nm{End}(V)$ называется изометрическим, если $Q^{-1} = Q^*$\\
Если $V$ -- унитарная, то называется унитарным\\
Если $V$ -- евклидово, то называется ортогональным\\
$\LRto (Qx, Qy) = (x, Q^*Qy) = (x,y)$\\
\textbf{Замечание}\\
Изометрический $\Rto$ нормальный\\
\textbf{Свойства}
\begin{enumerate}
    \item $Q$ изометрический $\LRto \ex$ базис такой, что $\ol{Q^T} = Q^* = Q^{-1}$ 
    \item $Q$ изометрический $\Rto$ переводит ортонормированный базис в ортонормированный базис\\
    \textbf{Доказательство $\Rto$}\\
    $e_1, \ldots, e_n$ -- о.н.б.\\
    $(Qe_i, Qe_j) = (e_i, e_j) = \delta_{ij}$\\
    \textbf{Доказательство $\Lto$}\\
    $e_1, \ldots, e_n$ -- о.н.б.\\
    $\fall x, y \in V\ Qe_1, \ldots, Qe_n$ -- о.н.б.\\
    Тогда $(Qe_i, Qe_j) = \delta_{ij}$\\
    $(Qx, Qy) = \sum_{ij} x_i \ol{y_j}(Qe_i, Qe_j) = \sum_i x_i \ol{y_i} = (x,y)$
    \item $Q, R$ -- изометрические $\Rto QR$ -- изометрические
    \item $Q$ -- изометрический $\Rto Q^{-1}$ -- изометрический
    \item $Q$ -- изометрический $\LRto Q$ -- нормальный и все корни $\chi_Q$ по модулю равны 1\\ 
    \textbf{Доказательство для унитарного пространства}\\
    По теореме о каноническом виде\\
    $\ex$ о.н.б. такой, что $Q \lrto \Lambda = \nm{diag}( \lambda_1, \ldots, \lambda_n)$\\
    $Q^* \lrto \ol{ \Lambda^T} = \nm{diag}( \ol{\lambda_1}, \ldots, \ol{ \lambda_n})$\\
    $QQ^* = \eps \LRto \Lambda \ol{ \Lambda^T} = E = \nm{diag}(\| \lambda_1\|^2, \ldots, \| \lambda_n\|^2) \Rto \|\lambda\| = \pm 1$\\
    \textbf{Доказательство для евклидова пространства}\\
    $QQ^* = \eps \LRto \Lambda \ol{ \Lambda^T} = E = \nm{diag}(\| \lambda_1\|^2, \ldots, \| \lambda_k\|^2, |\Phi_1\Phi_1^T|, \ldots, |\Phi_k\Phi_k^T|)$\\
    $ \Phi_i \Phi_i^T = \nm{diag}( \alpha_i^2 + \beta_i^2, \alpha_i^2 + \beta_i^2)$\\
    $ \alpha_i^2 + \beta_i^2 = 1$\\
    В частности, если корни $\chi_Q$ вещественные, то $\pm 1$\\
    \item $L \subset V$ -- линейное подпространство, инвариантное относительно $Q$. Тогда $L^\perp$ инвариантно относительно $Q$\\
    \textbf{Доказательство}\\
    //todo 11.05 14:19
\end{enumerate}
\textbf{Теорема о каноническом виде матрицы изометрического оператора}\\
$Q \in \nm{End}(V), (V, (\cdot, \cdot))$ -- унитарное/евклидово\\
$Q$ -- изометрический $\LRto \ex$ о.н.б. такой, что матрица имеет диагональный/блочно-диагональный вид\\
$ \Lambda = \nm{diag}( \lambda_1, \ldots, \lambda_n)$ / $ \Lambda = \nm{diag}(\lambda_1, \ldots, \lambda_k, \Phi_1, \ldots, \Phi_m), \lambda_i = \pm 1, \Phi_i = \begin{pmatrix}
    \cos \phi_i & \sin \phi_i\\
    -\sin \phi_i & \cos \phi_i
\end{pmatrix}, \cos \phi_i \pm i\sin \phi_i$ -- корни $\chi_Q$\\
\textbf{Доказательство}\\
$ \Lambda^{-1} = \ol{ \Lambda^T}$\\
\textbf{Замечание}\\
$Q$ ортогональный в евклидовом пространстве $\Rto$ композиция поворотов и отражений\\
\textbf{Следствие}\\
$Q^* = Q^{-1}$ -- унитарная/ортогональная матрица\\
Тогда $\ex$ унитарная/ортогональная матрица $T$ такая, что $T^* Q T = \Lambda$ -- из теоремы\\
\subsection{Разложение матриц. LU(LDU), Холецкого, QR-разложение, полярное}
\textbf{Определение}\\
$L = \begin{pmatrix}
    1 & 0 & \ldots & 0 & 0\\
    & 1 & \ddots & 0 & 0\\
    & & \ddots & \ddots & 0\\
    & e_{ij} & & \ddots & \vdots\\
    & & & & 1
\end{pmatrix}$ -- нижняя унитреугольная матрица(левая)\\
Аналогично верхнетреугольная матрица $U$\\
\textbf{Определение}\\
$A = (a_{ij})_{n\times n}$\\
$1 \leq k \leq n\ A_k = \begin{pmatrix}
    a_{11} & \ldots & a_{1k}\\
    \vdots & \ddots & \vdots\\
    a_{k1} & \ldots & a_{kk}
\end{pmatrix}$ -- угловая матрица\\
$\Delta_k = \det A_k$ -- угловой минор\\
\textbf{Теорема}\\
$\Delta_k \neq 0, \fall k=1\ldots n-1 \LRto \ex!$ унитреугольная нижняя $L, $ унитреугольная верхняя $U, D = \nm{diag}(d_1, \ldots, d_n), d_k\neq 0, k=1\ldots n-1$ такие, что $A = LDU$\\
\textbf{Замечание}
\begin{enumerate}
    \item $A$ невырожденная $\LRto \det A = \det L \det D \det U = \det D = \ub{\neq 0}{d_1d_2\ldots d_{n-1}} d_n \LRto d_n \neq 0$
    \item $A=LDU$\\
    $LD = \begin{pmatrix}
        d_1 & 0 & 0 & \ldots & 0\\
        & \ddots & 0 &\vdots & 0\\
        & & \ddots & 0 & 0\\
        & * & & \ddots & 0\\
        & & & & d_n
    \end{pmatrix} = $ н.у.о. $= L \Rto A = LU$\\
    $DU = \begin{pmatrix}
        d_1 & & & &\\
        0 & \ddots & & * &\\
        0 & 0 & \ddots & &\\
        0 & \ddots & 0 & \ddots &\\
        0 & 0 & \ddots & 0 & d_n
    \end{pmatrix} = $ н.у.о. $= U \Rto A = LU$\\
    Называется LU-разложением. Оно неоднозначно, а отличие от $LDU$
\end{enumerate}
\textbf{Доказательство $\Lto$}\\
$A = LDU \Rto A_k = L_kD_kU_k$\\
$a_{ij} = \sum_{s=1}^n \sum_{t=1}^n \ub{s > i \Rto =0}{l_{is}}d_{st}\ub{t > j \Rto =0}{u_{ti}} = \sum_{s=1}^i \sum_{t=1}^j l_{is}d_{st}u_{ij} = \ub{(L_kD_kU_k)_{ij}}{\sum_{s=1}^k\sum_{t=1}^k l_{is}d_{st}u_{ij}}$\\
$\Delta_k = \det A_k = \ub{1}{\det L_k} \det D_k \ub{1}{\det U_k} = d_1 \ldots d_k \neq 0$\\
$d_k = \frac{\Delta_k}{\Delta_{k-1}}$\\
\textbf{Доказательство $\Rto$}\\
Методом мат. индукции
\begin{enumerate}
    \item $k=1. a_{11} = \ub L1\ub{D}{d_1}\ub U1$
    \item Пусть верно для $k$\\
    Тогда $\Delta_1, \ldots, \Delta_k \neq 0$\\
    $A_k = L_kD_kU_k$ -- единственным образом, $d_1, \ldots, d_k \neq 0$
    Докажем для $k+1$\\
    $A_{k+1} = \begin{pmatrix}
        A_k & b_{k+1}\\
        c_{k+1} & a_{k+1, k+1}
    \end{pmatrix}$\\
    $L_{k+1} = \begin{pmatrix}
        L_k & 0\\
        X & 1
    \end{pmatrix}$\\
    $U_{k+1} = \begin{pmatrix}
        U_k & y\\
        0 & 1
    \end{pmatrix}$\\
    $D_{k+1} = \nm{diag}(d_1, \ldots, d_k, d_{k+1})$\\
    Докажем, что $A_{k+1} = L_{k+1}D_{k+1}U_{k+1}$\\
    //todo 18.05 10:38
\end{enumerate}
\textbf{Алгоритм LDU-разложения}\\
Рассмотрим матрицу $\begin{pmatrix}
    A & \vl & E
\end{pmatrix}$\\
Методом Гаусса приведем к верхнедиагональному виду $\begin{pmatrix}
    A' & \vl & A''
\end{pmatrix}$\\
Здесь не переставляем строки и столбцы во время преобразований, а также не прибавляем к строке $i$ значения из строк $j < i$(чтобы получить справа нижнедиагольный вид)\\
Получим $A'$ -- верхнедиагональную и $A''$ нижнедиагональную\\
$A'=DU, A''=L^{-1}$\\
\textbf{Определение}\\
$L_{ij}(\lambda)$ -- элементарная унитарная нижняя матрица, если $\ex! i, j: i > j, L_{ij} \neq 0$, при этом $L_{ij} = \lambda$ (единственный ненулевой элемент под диагональю)\\
$i > j$\\
$AL_{ij}(\Lambda) = \begin{pmatrix}
    \ldots & a_{1j} & \ldots & a_{1i} & \ldots\\
    a_{j1} & a_{jj} & \ldots & a_{ji} & \ldots\\
    \ldots & \ddots & \ddots & \ddots & \vdots\\
    a_{i1} & a_{ij} & \ldots & a_{ii} & \ldots\\
    \ldots & a_{nj} & \ldots & a_{ni} & \ldots\\
\end{pmatrix}\begin{pmatrix}
    1 & 0 & \ldots & 0 & 0\\
    & 1 & \ddots & 0 & 0\\
    & & \ddots & \ddots & 0\\
    & \ub{ij}\lambda & & \ddots & \vdots\\
    & & & & 1
\end{pmatrix} = \begin{pmatrix}\ldots & (A_j + \lambda A_i) & \ldots & A_i & \ldots\end{pmatrix}$\\
$L_{ij}(\Lambda)A = \begin{pmatrix}
    1 & 0 & \ldots & 0 & 0\\
    & 1 & \ddots & 0 & 0\\
    & & \ddots & \ddots & 0\\
    & \ub{ij}\lambda & & \ddots & \vdots\\
    & & & & 1
\end{pmatrix}\begin{pmatrix}
    \ldots & a_{1j} & \ldots & a_{1i} & \ldots\\
    a_{j1} & a_{jj} & \ldots & a_{ji} & \ldots\\
    \ldots & \vdots & \ddots & \vdots & \vdots\\
    a_{i1} & a_{ij} & \ldots & a_{ii} & \ldots\\
    \ldots & a_{nj} & \ldots & a_{ni} & \ldots\\
\end{pmatrix} = \begin{pmatrix}\vdots\\ (S_j + \lambda S_i)\\ \ldots\\ S_i\\ \ldots\end{pmatrix}$
$L_{ij}(\lambda)$ -- невырожденная $\Rto \ex L^{-1}_{ij}(\lambda) = L_{ij}(-\lambda)$\\
*Возвращаемся к методу Гаусса*\\
$\begin{pmatrix}
    \ub{\text{эл. нижн.унитр., соотв. м. Гаусса}}{L_m\ldots L_2L_1}A = DU & \vl & \ub{L^{-1}}{L_mL_{m-1}\ldots L}E
\end{pmatrix}$\\
$A = L_1^{-1}\ldots L_m^{-1}DU = LDU$\\
$L^{-1}_k = L_k(-\lambda_k)$\\
$L_1^{-1}L_2^{-1}\ldots L_m^{-1} = (L_m\ldots L_1)^{-1} = L$\\
\textbf{Следствие}\\
$A^* = A$\\
$\Delta_1, \ldots, \Delta_{n-1} \neq 0$\\
$\LRto \ex!, L, D = \nm{diag}(d_1, \ldots, d_n), U: d_i \in \Rset, d_i \neq 0, A=LDL^*=U^*DU$\\
\textbf{Доказательство}\\
Из теоремы $\ex! L,D,U$\\
$LDU = A = A^* = L^*D^*U^* = L^*DU^*$\\
Из единственности $L = U^*, U=L^*$\\
\textbf{Определение}\\
$\mcA = \mcA^*$ -- самосопряженный оператор\\
$V$ -- унитарное/евклидово\\
$\mcA$ -- положительно(отрицательно) определенным ($\mcA > 0$), если $\fall x \neq 0\ (\mcA x, x) = (x, \mcA x) \gtrless 0$\\
$\mcA$ -- положительный(отрицательный) полуопределенный ($\mcA \geq 0)$, если $\fall x \neq 0\ (\mcA x, x) = (x, \mcA x) \gtreqless 0$ и $\ex x\neq 0: (\mcA x, x) = 0$\\
$> 0$ не является ч.с.$\geq 0$\\
$\mcA \gtrless 0$ -- неопределенный, если $\ex x \in V: (\mcA x, x) = (x, \mcA x) > 0$ и $\ex y \in V: (\mcA y, y) = (y, \mcA y) < 0$\\\\
$\mcA$ -- самосопряженный $\LRto V = \bigoplus_{\lambda \text{-- с.ч.}} V_\lambda$ -- о.п.с.\\
Все корни $\lambda \in \Rset$\\
$V_\lambda \perp V_\mu, \lambda \neq \mu$\\
\textbf{Теорема}\\
$\mcA > 0 \LRto$ все с.ч. $\lambda > 0$\\
$\mcA \geq 0 \LRto$ все с.ч. $\lambda \geq 0, \ex \lambda = 0$\\
$\mcA \gtrless 0 \LRto \ex$ с.ч. $\lambda > 0, \ex$ с.ч. $\lambda < 0$\\
\textbf{Доказательство $\Rto$}\\
Пусть $\mcA > 0$\\
$\fall x \in V, x\neq 0\ (\mcA x, x) > 0$\\
$x = \sum_\lambda x_\lambda$\\
$(\mcA x, x) = \sum_\mu\sum_\lambda (\lambda x_\lambda, x_\mu) = \sum_\lambda (\lambda x_\lambda, x_\lambda) > 0$\\
$\lambda(x_\lambda, x_\lambda) > 0 \Rto \lambda > 0$\\
Аналогично для всех остальных случаев\\
\textbf{Доказательство $\Lto$}\\
$\fall x: (\mcA x, x) = \sum_\lambda \lambda(x_\lambda, x_\lambda)$\\
Пусть все $\lambda > 0 \Rto \fall x \neq \0 (\mcA x, x) = \sum_{\lambda} \lambda\|x_\lambda\|^2 > 0 \Rto \mcA > 0$\\
\textbf{Замечание}\\
Для самосопряженных матриц теорема аналогичная\\
\textbf{Замечание}\\
$A > 0 \LRto \det A \neq 0$\\
\textbf{Теорема (разложение Холецкого или метод квадратного корня)}\\
$\fall A > 0 \ex ! L > 0$ -- нижнетреугольная $U>0$ -- верхнетреугольная$: A = LL^* = U^*U$\\
\textbf{Доказательство}\\
Пусть $x \neq 0, A > 0, A= L_0 D_0 U_0 \us{A=A^*}= L_0D_0L_0^* = U_0^*D_0U_0$\\
$0 < (Ax, x) = (L_0D_0U_0x, x) = (D_0\ub{y}{U_0x}, L_0^*x) = (D_0y, y) = \sum_{j=1}^n d_j y_j^2$\\
$U_0$ -- унитреугольная $\Rto$ невырожденная $\Rto y\neq 0$, т.к. $x\neq 0$\\
Пусть $y = e_j$\\
Тогда $\fall j = 1 \ldots n\ d_j > 0$\\
$\sqrt{D_0} = \nm{diag}(\sqrt{d_1}, \ldots, \sqrt{d_n})$\\
$\sqrt{D_0}\sqrt{D_0} = D_0$\\
$A = \ub{L}{L_0\sqrt{D_0}}\sqrt{D_0}L_0^* = U_0^* \sqrt{D_0}\ub{U}{\sqrt{D_0}U_0}$\\
$L^* = (L_0\sqrt{D_0})^* = \sqrt{D_0}L_0^* = L_0^*\sqrt{D_0}$\\
$U^* = \sqrt{D_0} U_0$\\
\textbf{Теорема (QR-разложение)}\\
$\fall$ невырожд. $A$ (компл./вещ.) $\ex$ унит./ортог. $Q$, правотреугольная(верхнетреугольная) $R : A = QR$\\
\textbf{Доказательство}\\
$A = \begin{pmatrix}
    A_1 & \ldots & A_n
\end{pmatrix}$\\
Т.к. $A$ невырожденная, то $A_1, \ldots, A_n$ -- линейно независимые\\
Применим алгоритм Грамма-Шмидта\\
Получим попарно ортогональные и нормированные столбцы $q_1, \ldots, q_n$\\
$Q = \begin{pmatrix}
    q_1 & \ldots & q_n
\end{pmatrix}$ -- унитарная/ортогональная по построению\\
$Q$ -- унитарная/ортогональная по построению\\
$q_1 = u_{11}A_1$\\
$q_2 = u_12A_1 + u_22A_2$\\
$\vdots$\\
$q_n = u_{1n}A_1 + \ldots + u_{nn}A_n$\\
$\ub{\text{невыр.}}AU = \ub{\text{невыр.}}Q$\\
Тогда $U$ -- невырожденная\\
Тогда $\ex U^{-1} = R$\\
$R$ -- верхнетреугольная\\
$A = QU^{-1} = QR$\\
\textbf{Следствие}\\
$\fall$ невыр. $A \ex Q$ -- унит./ортог., $L$ -- левотреугольная(нижнетреугольная)\\
$A = LQ$\\
\textbf{Доказательство}\\
$A^* = \ot QR$\\
$A = (\ot QR)^* = R^*\ub{\text{унит./орт.}}{\ot Q^*} = R^* \ot Q^{-1} = LQ$\\
\textbf{Теорема (полярное разложение)}\\
В унитарном: $A=\ub{\text{эрмитова}}H\ub{\text{унитарная}}U$\\
В евклидовом: $A=\ub{\text{симметричная}}S\ub{\text{ортогональная}}Q$\\
$\fall A_{n\times n} \ex!$ ортогональная $H($ симметричная $S), H \geq 0(S \geq 0)$ и $\ex$ унитарная $U($ ортогональная $Q): A=HU (A=SQ)$\\
Причем, если $A$ невырожденная, то $U(Q)$ -- единственные, $H>0(S>0)$\\
Сформуриуем докажем соответствующую теорему для операторов, т.к. в о.н.б. этим матрицам соответствуют матрицам операторов\\
\textbf{Теорема (полярное разложение эндоморфизма в унитарном/евклидовом пространстве)}\\
$(V, (\cdot, \cdot))$ -- унитарное/ортогональное\\
$\fall \mcA \in \nm{End}(V) \ex! $самосопряженный $H \geq 0(S\geq 0), \ex U$ -- изомерический $: \mcA = HU (\mcA = SQ)$\\
Причем, если $\mcA$ невырожденный, то $\ex! U(Q), H > 0, S > 0$\\
\textbf{Лемма}\\
Пусть $\mcA$ -- о.п.с.\\
Все с.ч. $\lambda \in \Rset, \lambda > 0$\\
Тогда $\ex! \mcB$ -- о.п.с такой, что с.ч. $\mu \in \Rset, \mu \geq 0, \mcB^2 = \mcA$\\
$\mcB := \sqrt{\mcA}$\\
\textbf{Доказательство существования}\\
$\mcA$ -- о.п.с., $V = \bigoplus_{\lambda} V_\lambda = \span(v_1, \ldots, v_n), v_n$ -- с.в.\\
Определим $\mcB$:\\
$\fall v_j\ \beta v_j = \sqrt{\lambda_j} v_j$\\
$\mcB^2 v_j = \sqrt{\lambda_j} \sqrt{\lambda_j} v_j = \lambda_j v_j = \mcA v_j$\\
$\mcB^2 = \mcA$, т.к. их значения совпадают на базисных векторах\\
Очевидно из определения $\mcB$, что $\beta$ -- о.п.с., $\sqrt{\lambda_j} = \mu_j$ -- с.ч. $\mcB$\\
$v_j$ -- с.в. $\mcB$\\
$V_\lambda^\alpha = V_\mu^\beta$ -- с.в. $\beta$\\
\textbf{Доказательство единственности}\\
$\mcB, \mcC$ -- о.п.с.\\
$\nu \geq 0$ -- с.ч. $\mcC$\\
$V = \bigoplus_{\nu}V_\nu^C = \span(\omega_1, \ldots, \omega_n)$ -- с.в. $\mcC$\\
$\mcA\omega_j = \mcC^2 \omega_j = \nu^2_j \omega_j \Rto \lambda_j^2$ -- с.ч. $\mcA$\\
$V_\nu^\mcC = V_\lambda^\mcA = V_\mu^\mcC$\\
$\mcC \omega_i = \mcC\omega_i, \mu =  \Rto \mcC = \mcB$\\
\textbf{Доказательство теоремы}\\
$\mcA\mcA^*, \mcA^*\mcA$ -- самосопряженные\\
$(\mcA\mcA^*)^* = \mcA\mcA^*$\\
$\fall x \neq 0\ (\mcA\mcA^*x, x) = (\mcA^* x, \mcA^* x) \geq 0, (\mcA^*\mcA x, x) =(\mcA x, \mcA x) \geq 0$\\
Тогда $\mcA\mcA^*, \mcA^*\mcA \geq 0$\\
Рассмотрим $\mcA^*\mcA$\\
Он самосопряженный $\LRto$ он о.п.с. и его собственные подпространства попарно ортонормированы\\
$V = \bigoplus_\lambda V_\lambda, V_\lambda \perp V_\mu, \fall \lambda\ \lambda > 0$\\
$V = \span(v_1, \ldots, v_n)$ -- попарно ортогональные и нормированные с.в. $\mcA^*\mcA$\\
$(\mcA v_j, \mcA v_k) = \ub{\geq 0}{(\mcA^* \mcA v_j, v_k)} = (\lambda_j v_j, v_k) = \lambda\sigma_{jk}$\\
\begin{enumerate}
    \item $\lambda_j \neq 0\ (\mcA v_j, \mcA v_j) = \lambda > 0, \|\mcA v_j\|^2 \neq 0 \LRto \mcA v_j \neq \0$
    \item $\mcA v_j, \mcA v_k \neq 0, \lambda_j, \lambda_k \neq 0, \mcA v_j \perp \mcA v_j$\\
    Тогда $\mcA$ переводит попарно ортогональную нормированную систему с.в. в попарно ортогональную, но, возможно, неполную\\
    Дополним получившуюся систему до базиса\\
    Пусть о.н.б. $z_1, \ldots, z_n$ такой, что $\mcA \lambda_j \neq 0, z_j = \frac{\mcA v_j}{\sqrt{\lambda_j}}$\\
    $(z_j, z_j) = \frac{(\mcA v_j, \mcA v_j)}{\lambda_j} = \frac{\lambda_1}{\lambda_1} = 1$\\
    Определим $H\in \nm{End}(V)$\\
    $Hz_j := \sqrt{\lambda_j} z_j$\\
    Очевидно, $H$ -- о.п.с., $\sqrt{\lambda_j}$ -- с.ч.\\
    $H \geq 0$\\
    Определим $U \in \nm{End}(V)$\\
    $U\ub{\text{о.н.б.}}{v_j} := \ub{\text{о.н.б.}}{z_j}$\\
    Тогда $U$ --  изометрический\\
    $HUv_j = Hz_j = \sqrt{\lambda_j} z_j = \mcA v_j$\\
    Т.к. совпадает на базисных векторах, то $HU = \mcA$\\
    $\mcA^* = U^* H^* = U^* H = U^{-1}H$\\
    $\ub{\text{о.п.с., все с.ч.} \geq 0}{\mcA\mcA^*} = HUU^{-1}H = H^2$\\
    Отсюда $\ex! H$ -- о.п.с., все с.ч. $\geq 0$\\
    $H = \sqrt{\mcA\mcA^*}$ -- левый модуль $\mcA$\\
    $\mcA$ -- невырожденный $\Rto \mcA^*$ -- невырожденный $\Rto \mcA^*\mcA >0, \mcA \mcA^* > 0 \Rto$ все $\lambda_j > 0 \Rto H > 0$ -- невырожденный\\
    $\ub{\text{невыр.}}\mcA = \ub{\text{невыр.}}HU\Rto U$ -- невырожденный $\Rto U = H^{-1}\mcA$ -- ед.образом\\
\end{enumerate}
Аналогично для вещественного случая\\
\textbf{Следствие}\\
Аналогично для разложений $\mcA = UH (\mcA = QS)$\\
\textbf{Доказательство}\\
Построим разложение $\mcA^* = H_0U_0$\\
$H_0 = \sqrt{\mcA^*\mcA}$ -- правый модуль\\
$\mcA = (H_0U_0)^* = U_0^*H_0^* = \ub{\text{изометрия}}{U_0^{-1}}H_0 = U'_0H_0$
\section{Квадратичные формы}
\subsection{Основные понятия}
\textbf{Определение}\\
Квадратичной формой называется $f: \Rset^n \rto \Rset$ такая, что $f(x) = \sum_{i=1}^n \sum_{j=1}^n a_{ij}x_ix_j$, где $a_{ij} \in \Rset, a_{ij} = a_{ji}$\\
$f(x) = \sum_{i=1}^n a_{ii}x_i^2 + 2 \sum_{1 \leq i < j \leq n} a_{ij} x_ix_j$\\
$A = (a_ij)_{n\times n}$\\
$A^T = A$\\
$f(x) = x^T A  = (x, Ax) = (Ax, x)$ -- в стандартном скалярном произведении в $\Rset^n$\\
\textbf{Определение}\\
$\rg F = \rg A$\\
\textbf{Определение}\\
Говорят, что к квадратичной форме $f$ применили линейное преобразование $Q$, если $x = Qy, y \in \Rset^n$\\
$g(y) = f(Qy) = (Qy)^TA(Qy) = y^t Q^TAQy$ -- снова квадратичная форма\\
$A_g = Q^T A_f Q$\\
Если $Q$ невырожденное, то $\rg A_g = \rg A_f$\\
Мы будем рассматривать только невырожденные преобразования\\
Если матрица квадратичной формы имеет диагональный вид, то говорят, что форма приведена к каноническому виду\\
$f(x) = \sum_{i=1}^n a_{ii}x_i^2$\\
$\sigma^+$ -- положительный индекс инерции -- число $a_{ii} > 0$ в каноническом виде\\
$\sigma^-$ -- отрицательный индекс инерции -- число $a_{ii} < 0$ в каноническом виде\\
$\sigma^0$ -- число $a_{ii} = 0$ в каноническом виде\\
$(\sigma^+, \sigma^-, \sigma^0)$ -- сигнатура квадратичной формы\\
$\rg f = \sigma^+ + \sigma^- = n - \sigma^0$\\
Нормальный вид квадратичной формы -- канонический, где все все $a_{ii} \pm1$ или $0$\\
\subsection{Методы приведения квадратичной формы к каноническому виду}
\begin{enumerate}
    \item $\ub{=A^T}A\Rto \ub{Q^TAQ}\Lambda = \nm{diag}(\lambda_1, \ldots, \lambda_n)$
    //todo когда-то 18.05 между 14:00 и 15:30
    \item Метод Лагранжа(метод выделения полного квадрата)\\
    $f(x) = x^T Ax, A = A^T, x = \ub{\text{невыр.}}Qy$\\
    $g(y) = y^TBy = \sum_{i=1}^n b_{ii} y_i^2, B = Q^T A Q$
    \begin{enumerate}
        \item Пусть $i = 1\ldots n, a_{ii} = 0$ (в квадратичной форме нет квадратов)\\
        Пусть $a_{ij} \neq 0, i \neq j$\\
        $x_i = y_i + y_j$\\
        $x_j = y_i - y_j$\\
        $x_k = y_k, k \neq i, j$\\
        $f(x) = \ldots + 2a_{ij}x_ix_j + \ldots = \ldots + 2a_{ij} y_i^2 - 2a_{ij}y_j^2 + \ldots = g(y)$ -- есть ненулевые слагаемые с квадратами
        \item $\ex a_{ii} \neq 0$ (есть слагаемые с квадратом, тогда предыдущий шаг не нужен)\\
        Выпишем из $f$ все слагаемые, содержащие $x_i$:\\
        $a_{ii}x_i^2 + 2\sum_{j \neq i}a_{ij}x_ix_j = \frac1{a_{ii}}(a_{ii}^2 x_i^2 + 2\sum_{j\neq i} a_{ij}a_{ii} x_i x_j) = \frac1{a_{ii}}(\sum_{j=1}^n a_{ij} x_j)^2 - \ub{\text{кв. форма от $x_1\ldots x_n$ без $x_i$}}{\frac1{a_ii} \ub{\text{нет }x_i}{(\sum_{j\neq i} a_{jj}^2 x_j^2 + 2\sum_{j,k\neq i} a_{ij} a_{ik}x_jx_k)}}$\\
        $f(x) = \frac1{a_{ii}} (\sum_j a_{ij}x_j)^2 + \ub{\text{кв.форма}}{\ot{f}(x_1, \ldots, \ub{\text{без}}{\hat {x_i}}, \ldots, x_n)}$\\
        $y_i = \sum_{j} a_{ij} x_j, y_k = x_k, k\neq i, y = Q^{-1}x$\\
        $Q^{-1} = \begin{pmatrix}
            1 & 0 & \ldots & 0 & 0 & 0\\
            0 & 1 & \ldots & 0 & 0 & 0\\
            \vdots & \vdots & \ddots & \vdots & \vdots & \vdots\\
            a_{i1} & a_{i2} & \ldots & a_{ii} \neq 0 & \ldots & a_{in}\\
            \vdots & \vdots & \vdots & \vdots & \ddots & \vdots\\
            0 & 0 & 0 & 0 & \ldots & 1
        \end{pmatrix}$ -- невырожденная\\
        $x = Qy, g(y) = \frac1{a_{ii}} y_i^2 + \ub{\text{кв.форма $\Rto$ повторим алгоритм}}{\ot g(y_1, \ldots, \hat{y_i}, \ldots, y_n)}$\\
        Метод универсальный: можно применить ко всем квадратичным формам, но заранее неизвестен канонический вид в отличие от ортогонональго преобразования
    \end{enumerate}
    \item Метод Якоби\\
    $\Delta_k \neq 0, k=1\ldots n-1, \Delta_i$ -- угловые миноры (возможно, $\delta_n = 0$)\\
    $f(x) = x^T Ax$\\
    Если $A = A^* = A^T, \ex!$ унитреугольная нижняя $L$, верхнетреугольная $U, D = \nm{diag}(d_1, \ldots, d_n), d_i \in \Rset$\\
    $L, U$ -- унитр. $\Rto U,L$ -- невырожденные\\
    $L^* = L^T, U^T = U^*$\\
    $D = L^{-1}A(L^{-1})^T = (U^{-1})^T\ub{\text{матр. кв. формы}}AU^{-1}$\\
    $x = Qy, Q=U^{-1}=(L^{-1})^T$ -- верхнетреугольная матрица (матрица Якоби)\\
    См. алгоритм $LDU$ преобразования\\
    $d_1, \ldots, d_n$ -- из алгоритма(числа на диагонали слева)\\
    $f(x) = g(y) = d_1y_i^2 + \ldots + d_n y_n^2 = \Delta_1 y_1^2 + \frac{\Delta_2}{\Delta_1}y_2^2 + \ldots + \frac{\Delta_n}{\Delta_{n-1}}y_n^2, \rg f \geq n-1$
\end{enumerate}
\textbf{Теорема Якоби}\\
$\fall$ кв.ф. $f \ex!$ верхнетреуг. преобр. $Q: x=Qy$ такое, что кв. форма будет приведена к каноническому виду $g(y) = \Delta_1 y_1^2 + \frac{\Delta_2}{\Delta_1}y_2^2 + \ldots + \frac{\Delta_n}{\Delta_{n-1}}y_n^2$\\
Причем $Q = \begin{pmatrix}
    1 & q_{12} & q_{13} & \ldots & q_{1n}\\
    0 & 1 & q_{23} & \ldots & q_{2n}\\
    \vdots & \vdots & \ddots & \ddots & \vdots\\
    0 & 0 & 0 & 1 & q_{n-1,n}\\
    0 & 0 & 0 & 0 & 1
\end{pmatrix}$\\
$q_i = \begin{pmatrix}
    q_{1i}\\\vdots\\q_{i-1, i}
\end{pmatrix}$\\
$b_i = \begin{pmatrix}
    a_{1i}\\\vdots\\a_{i-1, i}
\end{pmatrix}$\\
$A_{k-1} q_k = -b_k, k=2\ldots n$\\
\textbf{Доказательство}\\
Методом мат. индукции
\begin{enumerate}
    \item $k = 2$\\
    $a_{11} = \Delta_1 \neq 0$\\
    $Q=\begin{pmatrix}
        1 & q_{12}\\
        0 & 1
    \end{pmatrix}$\\
    $Q^TAQ = D = \begin{pmatrix}
        d_1 & 0\\
        0 & d_2
    \end{pmatrix}$\\
    $a_{11} q_{12} = -a_{12}$\\
    $q_{12} = -\frac{a_{12}}{a_{11}}$\\
    $Q^TA^Q = \nm{diag}(\Delta_1, \frac{\Delta_2}{\Delta_1})$
    \item Пусть верно для $k: A_{j-1}q_j = - b_j, j = 1\ldots k, Q^T_k A_k Q_k = \nm{diag}(d_1, \ldots, d_k)$\\
    $\Delta_1, \ldots, \Delta_k \neq 0$\\
    Покажем для $k+1$\\
    $Q_{k+1} = \begin{pmatrix}
        Q & q_{k+1}\\
        0 & 1
    \end{pmatrix}$\\
    Пусть $q_{k+1}$ -- решение СЛНУ $A_k q_{k+1} = -b_{k+1}$\\
    $A_{k+1} = \begin{pmatrix}
        A_k & b_{k+1}\\
        b_{k+1}^T & a_{k+1, k+1}
    \end{pmatrix}$\\
    $Q_{k+1}^T A_{k+1}Q_{k+1} = \begin{pmatrix}
        Q_k^T & 0\\
        q^T_{k+1} & 1
    \end{pmatrix}\begin{pmatrix}
        A_k & b_{k+1}\\
        b^T_{k+1} & a_{k+1} a_{k+1}
    \end{pmatrix} \begin{pmatrix}
        Q_k^T & 0\\
        q^T_{k+1} & 1
    \end{pmatrix} = \\$
    $\begin{pmatrix}
        Q_k^T A_k & Q_k^T b_{k+1}\\
        q_{k+1}^T A_k + b_{k+1}^T & q_{k+1}^T b_{k+1} + a_{k+1, k+1}
    \end{pmatrix}\begin{pmatrix}
        Q_k^T & 0\\
        q^T_{k+1} & 1
    \end{pmatrix} = $\\
    $\begin{pmatrix}
        \ub{D_k}{Q_k^TA_kQ_k} & \ub{Q_k^T(A_kq_{k+1}+b_{k+1})=0}{Q_k^T A_k q_{k+1} + Q_k^T b_{k+1}}\\
        0 & q_{k+1}^T b_{k+1}q_{k+1} + a_{k+1, k+1}
    \end{pmatrix}$\\
    $\det (Q_{k+1}^T A_{k+1}Q_{k+1}) = \ub{1}{(\det Q_{k+1})^2} \ub{\Delta_{k+1}}{\det A_{k+1}} = d_1\ldots d_k x = \Delta_k x$\\
    $x = \frac{\Delta_{k+1}}{\Delta_k} = d_{k+1}$\\
    Т.о индукционный переход доказан, нигде не использовано, что $\Delta_{k+1} \neq 0$\\
    Отсюда можно применить до $k = n-1 \leadsto n$
\end{enumerate}
Метод Якоби не универсальный, но позволяет сразу записать канонический вид, не находя самого преобразования
\subsection{Закон инерции кв. форм. Критерий Сильвестра}
\textbf{Теорема (Закон инерции кв. форм)}\\
Каким бы линейным невырожденным преобразованием кв. ф. $f$ не была приведена к канон. виду, сигнатура этого вида будет одна и та же\\
$f(x) = x^T A x$\\
Пусть $x = \ub{\text{невыр}}{Q_1} y, g(y) = y^T B y$\\
$x = \ub{\text{невыр}}{Q_2} z, t(z) = z^T Cz$\\
$\sigma(g) = \sigma(t)$ (сигнатуры)\\
\textbf{Доказательство}\\
$g(y) = \sum_{i=1}^p \ub{> 0}{b_{ii}}y_i^2 + \sum_{j=p+1}^r \ub{< 0}{b_{ii}}y_i^2, r = \rg f = \rg g$\\
$\sigma(g) = (p, r-p, n - r)$\\
$t(z) = \sum_{i=1}^s c_{ii} z_i^2 + \sum_{j=s+1}^r c_{ii} z_i^2$\\
$\sigma(t) = (s, r-s, n-r)$\\
Пусть $p < s$\\
Т.к. $Q_1, Q_2$ невырожденные, рассмотрим системы:\\
$y = Q_1^{-1}x$ -- по любому $y$ однозначно находится $x$\\
$z = Q_2^{-1}x$ -- по любому $z$ однозначно находится $x$\\
Возьмем первые $p$ строк системы $Q^{-1}_1 x$ и приравняем к нулю\\
$(Q_1^{-1})_{1 \ldots p} x = \0$\\
Возьмем последнте $n-s$ строк системы $Q^{-1}_2 x$ и приравняем к нулю\\
$(Q_2^{-1})_{n-s\ldots n} x =\0$\\
Рассмотрим систему\\
$(Q_1^{-1})_{1 \ldots p} x = \0$\\
$(Q_2^{-1})_{n-s\ldots n} x = \0$\\
Мы получили СЛОУ\\
Уравнений $p+n-s < n$. Тогда существует нетривиальное решение $x_0 \neq \0$\\
Подставим $x_0$ в наши системы\\
$y_0 = Q_1^{-1} x_0$ -- первые $p$ координат решения -- нули, но сам он $\neq \0$ в силу невырожденности $Q_1^{-1}$\\
Аналогично с $z_0 = Q_2^{-1}x_0$\\
$f(x) = g(y) = t(z)$\\
$f(x_0) = \ub{\leq 0}{g(y_0)} = \ub{> 0}{t(z_0)}$ -- противоречие\\
\textbf{Определение}\\
$f > 0$ -- положительно определенная, если $\fall x \neq 0 f(x) > 0$\\
Тогда $f(x) = x^T Ax > 0 \LRto A > 0, A^T = A$\\
Аналогично $f < 0$\\
$f \geq 0 \LRto \fall x: f(x) \geq 0, \ex x \neq 0: f(x) = 0 \LRto A \geq 0$\\
$f \gtrless \LRto \ex x: f(x) > 0, y: f(y) < 0 \LRto A \gtrless$\\
$f > 0 \LRto \fall $ с.ч. $> 0 \LRto \lambda_1 y_1^2 + \ldots + \lambda_ny_n^2 = g(y) > 0 \LRto \sigma(f) = (n, 0, 0)$\\
$f < 0 \LRto \fall $ с.ч. $< 0 \LRto \sigma(f) = (0, n, 0)$\\
$f \geq 0 \LRto \sigma(f) = (r, 0, n-r), r < n$\\
$f \leq 0 \LRto \sigma(f) = (0, r, n-r), r < n$\\
$f \gtrless 0 \LRto \sigma(f) = (r, s, n-r-s), r, s > 0$\\
\textbf{Замечание}\\
$f > 0 \Rto -f < 0$ и т.д.\\
\textbf{Теорема (критерий Сильвестра)}\\
Если $\Delta_k \neq 0, k=1\ldots n$\\
Тогда $f > 0 \LRto \Delta_k > 0 \fall k$\\
Тогда $f < 0 \LRto (-1)^k\Delta_k > 0 \fall k$\\
$(\Delta_1 < 0, \Delta_2 > 0, \Delta_3 < 0, \ldots)$\\
\textbf{Доказательство}\\
Берем метод Якоби\\
\subsection{Приведение уравнения ПВП к каноническому виду}
$i, j, k$ - о.н.б.\\
$V_3$ -- лин.пр-во геом. векторов\\
$\ub{\text{лин.форма}}{a_{11}x^2 + a_{22}y^2 + a_{33}z^2 + 2a_{12}xy + 2a_{13}xz + 2a_{23}yz} + 2a_1 x + 2a_2 y_2 + 2a_3 z + a_0 = 0$\\
$a = \begin{pmatrix}
    a_1\\a_2\\a_3
\end{pmatrix}$\\
$f(v) = v^T A v + 2a^T v + a_0 = 0$\\
$i, j, k \xrto{Q \text{ орт}} e_1', e_2', e_3'$ -- о.н.б.\\
$Q = T_{ijk \rto e'}$ -- поворот\\
$Q = \begin{pmatrix}
    \cos \alpha_1 & \cos \alpha_2 & \cos \alpha_3\\
    \cos \beta_1 & \cos \beta_2 & \cos \beta_3\\
    \cos \gamma_1 & \cos \gamma_2 & \cos \gamma_3
\end{pmatrix}$\\
$Q = \begin{pmatrix}
    e_1' & e_2' & e_3'
\end{pmatrix}$\\
Т.к. ориентация не меняется, $\det A = 1 > 0$\\
$A \xrto{Q}$ диагональная(канонический вид)\\
$v = Q v'$\\
$v^T A v = v' Q^T A Q v$\\
Для кв.ф. $f$ построим ортогональное преобразование $f$ такое, что $f \os{Q}\leadsto$ канонический вид\\
$Q$ -- матрица поворота $\det Q = 1 \Rto$ столбцы $Q$ -- координаты нового базиса $\Rto$ оси\\
После преобразования получим $\lambda_1 x'^2 + \lambda_2 y'^2 + \lambda_3 z'^2 + \ub{2a'_1 x' + 2a'_2y + 2a'_3 z}{2\ub{a'}{a^T Q}v'} + a_0 = 0$\\
\begin{enumerate}
    \item $\lambda_1, \lambda_2, \lambda_3 \neq 0$\\
    $\lambda_1 x'^2 + 2a'_1 x' = \lambda_1(x' + \frac{a'_1}{x_1})^2 - \frac{a_1^2}{\lambda_1}$\\
    Аналогично с $y,z$\\
    Получили параллельный перенос. $O' = (-\frac{a'_1}{\lambda_1}, -\frac{a'_2}{\lambda_2}, -\frac{a'_2}{\lambda_2})$\\
    Получили $\lambda_1x''^2 + \lambda_2x''^2 + \lambda_3x''^2 + a_0' = 0$
    Если $a'_0 \neq 0$\\
    $\alpha x''^2 + \beta y''^2 + \gamma z''^2 = 1$\\
    $\alpha, \beta, \gamma > 0$ -- эллипсоид\\
    $\alpha, \beta, \gamma < 0$ -- $\varnothing$\\
    $\alpha, \beta > 0, \gamma < 0$ -- однополостной\\
    $\alpha, \beta < 0, \gamma > 0$ -- двуполостной\\
    Если $a'_0 = 0$\\
    $\alpha, \beta > 0$ -- конус\\
    $\alpha\cdot\beta < 0$ -- конус\\
    $\alpha, \beta$ -- точка
    \item $\lambda_1 \neq 0, \lambda_2 \neq 0, \lambda_3 = 0$\\
    Выполним перенос\\
    $x'' = x' + \frac{a'_1}{\lambda_1}$\\
    $y'' = y' + \frac{a'_2}{\lambda_2}$\\
    Если $a_3' \neq 0$\\
    $z'' = z' + \frac{a_0}{2a'_3}$\\
    $2a'_3z' + a_0 = 2a_3'(z + \frac{a_0}{2a'_3})$\\
    Получили $\alpha x''^2 + \beta y''^2 = z''$\\
    $\alpha\cdot\beta > 0$ -- эллиптический парабороид\\
    $\alpha\cdot\beta < 0$ -- гиперболический парабороид\\
    Если $a'_3 = 0$\\
    $\lambda_1 x''^2 + \lambda_2 y''^2 + a_0 = 0$\\
    Если $a_0 \neq 0$\\
    $\alpha x''^2 + \beta y''^2 = 1$\\
    $\alpha, \beta > 0$ -- эллиптический цилинд\\
    $\alpha, \beta < 0$ -- $\varnothing$\\
    $\alpha\cdot\beta < 0$ -- гиперболический цилинд\\
    Если $a_0 = 0$\\
    $y''^2 = \alpha x''^2$\\
    $\alpha > 0 \Rto +\pm \sqrt{\alpha} x''$ -- пересекающиеся плоскости\\
    $\alpha < 0 \Rto x=y=0$ -- прямая
    \item $\lambda_1 \neq 0, \lambda_2, \lambda_3 = 0$\\
    $\lambda_1 x''^2 + 2a'_2 y'' + 2a'_3 z'' + a_0' = 0$\\
    Если $a'_2, a_3' \neq 0$\\
    Выполним поворот в плоскости $O''Y''Z''$ на $\alpha: \tg \alpha = \frac{\alpha'_3}{\alpha'_2}$\\
    Получили $\lambda_1 x''^2 + 2a''_2y''' + a'_0 = 0$ -- параболический цилиндр\\
    Если $a'_3 = 0, a_2' \neq 0$\\
    Аналогично\\
    $a'_2 = a'_3 = 0$\\
    $\lambda_1 x''^2 \neq a'_0 = 0$\\
    $x''^2 = \alpha$
\end{enumerate}
\end{document}

