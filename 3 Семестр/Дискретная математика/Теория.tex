\documentclass[12pt]{article}
\input{../../header.tex}

\title{Дискретная математика. Теория}
\author{Александр Сергеев}
\date{}
\begin{document}
\maketitle
\section{Графы}
\subsection{Неориентированные графы}
\textbf{Определение}\\
\textit{Неориентированный граф} -- множество вершин $V$ и множество ребер $E \subset (V\times V \setminus \{(u,u)\})/_\sim$ (факторизованное отношением эквивалентности $\sim: (u, v) \sim (v, u)$)\\
\textit{Путь} $P$ -- последовательность $u_oe_1u_1\ldots e_ku_k$, где $u_i$ -- вершина, $e_i = u_{i-1}u_i$ -- ребро\\
$k:=|P|$ или $k:=\nm{len}(P)$ -- \textit{длина пути}\\
\textit{Простой путь} -- путь, который посещает каждую вершину не более одного раза\\
\textit{Реберно-простой путь} -- путь, который посещает каждое ребро не более одного раза\\
\textit{Циклический путь} -- путь, где $u_0 = u_k$\\
Зададим \textit{цикл}:
\begin{itemize}
    \item $\letus P = u_0 e_1u_1\ldots e_ku_k$\\
    $\letus Q = u_ie_{i+1}\ldots e_ku_ke_1u_1\ldots e_iu_i$\\
    $\letus R = u_k e_ku_{k-1}\ldots e_1u_0$\\
    $P \sim R, P \sim Q$ -- равны с точностью до отражения и циклического сдвига
    \item Пусть если в циклическом пути $\fall i\ e_{i+1} \neq e_{i+2}, u_i \neq u_{i+2}$, то циклический путь называется \textit{корректным}
\end{itemize}
Тогда \textit{цикл} -- класс эквивалентности корректных циклических путей относительно отношения эквивалентности $\sim$\\
\textit{Ациклический граф} -- граф без циклов\\
\textbf{Определение}\\
Пусть $\ex P: u_0 = u, u_k = v$. Тогда $u\leadsto v$ (отношение связанности путем)\\
Пусть $P: u\leadsto v, Q: v\leadsto w$. Тогда $P\circ Q:=u\leadsto v \leadsto w$ -- конкатенация пути\\
\textbf{Теорема}\\
Отношение $\leadsto$ в неориентированном графе -- отношение эквивалентности\\
\textbf{Определение}\\
Класс эквивалентности по отношению $\leadsto$ -- \textit{компонента связности}\\
Граф, содержащий одну компоненту связности -- \textit{связный граф}\\
\textbf{Определение}\\
$u, v$ -- реберно двусвязные, если существует два (возможно, совпадающих) реберно непересекающихся пути из $u$ в $v$\\
\textbf{Теорема}\\
Реберная двусвязность -- отношение эквивалентности\\
\textbf{Доказательство}\\
Путь $u$ (из одной вершины) реберно не пересекается с самим собой. Отсюда рефлексивность\\
Симметричность очевидна\\
Докажем транзитивность\\
Рассмотрим $u, v, w$, пары $(u, v), (v, w)$ реберно двусвязные\\
$P_1, P_2$ -- пути между $u,w$\\
Рассмотрим случаи:
\begin{itemize}
    \item $w = v \lor w = u$ -- очевидно
    \item $w \in P_2$\\
    \begin{tikzpicture}
        %Nodes
        \node[node] (u) at (0, 0) {u};
        \node[node] (v) at (4, 0) {v};
        \node[node] (w) at (2, -1) {w};
        %Lines
        \draw[-, snake] (u) to [bend left] node[above] {$P_1$} (v);
        \draw[-, snake] (u) to [bend right] node[below] {$Q_1$} (w);
        \draw[-, snake] (w) to [bend right] node[below] {$Q_2$} (v);
    \end{tikzpicture}\\
    Тогда $Q_2, P_1\circ Q_2$ реберно не пересекаются
    \item $\ex a \neq v, u, w:$\\
    \begin{tikzpicture}
        %Nodes
        \node[node] (u) at (0, 0) {u};
        \node[node] (v) at (4, 0) {v};
        \node[node] (a) at (2, -1) {a};
        \node[node] (w) at (2, -3) {w};
        %Lines
        \draw[-, snake] (u) to [bend left] node[above] {$P_1$} (v);
        \draw[-, snake] (u) to [bend right] node[below] {$A_1$} (a);
        \draw[-, snake] (a) to [bend right] node[below] {$A_2$} (v);
        \draw[-, snake] (a) to [bend left] node[right] {$Q_2$} (w);
        \draw[-, snake] (a) to [bend right] node[left] {$Q_1$} (w);
    \end{tikzpicture}\\
    Тогда $A_1\circ Q_1, P_1\circ A_2\circ Q_2$ реберно не пересекаются
    \item $\ex a\neq b \neq v, u, w:$\\
    \begin{tikzpicture}
        %Nodes
        \node[node] (u) at (0, 0) {u};
        \node[node] (v) at (4, 0) {v};
        \node[node] (a) at (1.2, -1) {a};
        \node[node] (b) at (2.8, -1) {b};
        \node[node] (w) at (2, -3) {w};
        %Lines
        \draw[-, snake] (u) to [bend left] node[above] {$P_1$} (v);
        \draw[-, snake] (u) to [bend right] node[below] {$A_1$} (a);
        \draw[-, snake] (a) to node[below] {$ $} (b);
        \draw[-, snake] (b) to [bend right] node[below] {$B_1$} (v);
        \draw[-, snake] (b) to [bend left] node[right] {$Q_2$} (w);
        \draw[-, snake] (a) to [bend right] node[left] {$Q_1$} (w);
    \end{tikzpicture}\\
    Тогда $A_1\circ Q_1, P_1\circ B_1\circ Q_2$ реберно не пересекаются
    \item $\ex a \neq b \neq v, u, w:$\\
    \begin{tikzpicture}
        %Nodes
        \node[node] (u) at (0, 0) {u};
        \node[node] (v) at (4, 0) {v};
        \node[node] (a) at (2, -1) {a};
        \node[node] (b) at (2, 1) {b};
        \node[node] (w) at (2, -3) {w};
        %Lines
        \draw[-, snake] (u) to [bend left] node[above] {$B_1$} (b);
        \draw[-, snake] (b) to [bend left] node[above] {$ $} (v);
        \draw[-, snake] (u) to [bend right] node[below] {$A_1$} (a);
        \draw[-, snake] (a) to [bend right] node[below] {$ $} (v);
        \draw[-, snake] (b) to [bend left] node[right] {$Q_2$} (w);
        \draw[-, snake] (a) to [bend right] node[left] {$Q_1$} (w);
    \end{tikzpicture}\\
    Тогда $B_1\circ Q_2, P_1\circ A_1\circ Q_1$ реберно не пересекаются
    \item $ $\\
    \begin{tikzpicture}
        %Nodes
        \node[node] (u) at (0, 0) {u};
        \node[node] (v) at (2, 0) {v};
        \node[node] (w) at (4, 0) {w};
        %Lines
        \draw[-, snake] (u) to [bend left] node[above] {$P_1$} (v);
        \draw[-, snake] (u) to [bend right] node[below] {$P_2$} (v);
        \draw[-, snake] (v) to [bend left] node[above] {$Q_1$} (w);
        \draw[-, snake] (v) to [bend right] node[below] {$Q_2$} (w);
    \end{tikzpicture}\\
    Тогда $P_1\circ Q_1, P_2\circ Q_2$ реберно не пересекаются
\end{itemize}
\textbf{Определение}\\
Ребра $ab, cd$(не являющиеся петлями) являются вершинно двусвязными, если существуют два вершинно непересекающихся пути, соединяющих их концы\\
\begin{tikzpicture}
    %Nodes
    \node[node] (a) at (0, 2) {a};
    \node[node] (b) at (0, 0) {b};
    \node[node] (c) at (2, 2) {c};
    \node[node] (d) at (2, 0) {d};
    %Lines
    \draw[-, snake] (a) to (c);
    \draw[-, snake] (b) to (d);
    \draw[-] (a) to (b);
    \draw[-] (c) to (d);
\end{tikzpicture}\\
\textbf{Теорема}\\
Отношение вершинной двусвязности -- отношение эквивалентности\\
\textbf{Доказательство} аналогично предыдущей теореме\\
\textbf{Определение}\\
Рассмотрим $A = \{ a, b: ab \text{ -- вершинно двусвязные} \}$ -- \textit{компоненту вершинной двусвязности (блок)}\\
Точка $v$ -- \textit{точка сочленения}, если она лежит в нескольких блоках\\
\textbf{Теорема}\\
Вершина является точкой сочленения $\LRto$ Ее удаление увеличивает количество компонент связности\\
\textbf{Доказательство $\Rto$}\\
Пусть $u$ -- точка сочленения\\
Тогда она лежит в нескольких блоках:\\
\begin{tikzpicture}
    %Nodes
    \node[node] (x) at (0, 2) {x};
    \node[node] (y) at (4, 2) {y};
    \node[node] (u) at (2, 0) {u};
    %Lines
    % \draw[-, snake] (a) to (c);
    % \draw[-, snake] (b) to (d);
    \draw[-] (x) to node[left] {a} (u);
    \draw[-] (u) to node[right] {b} (y);
\end{tikzpicture}\\
$a, b$ -- не являются вершинно двусвязными, т.к. лежат в разных блоках\\
Тогда не существует пути $x \leadsto y$, не проходящего через $u$\\
Отсюда при удалении $u$ $x$ и $y$ окажутся в разных компонентах\\
\textbf{Доказательство $\Lto$}\\
Пусть при удалении $u$ количество компонент увеличилось\\
Возьмем $x$ и $y$ такие, что до удаления $u$ они были в одной компоненте, а после удаления оказались в разных\\
Тогда любой путь из $x$ в $y$ проходил через $u$\\
Выберем какой-то путь из $x$ в $y$ и возьмем на нем вершины $x'$ и $y'$ -- соседей вершины $u$\\
\begin{tikzpicture}
    %Nodes
    \node[node] (x) at (-2, 2) {x};
    \node[node] (y) at (6, 2) {y};
    \node[node] (x2) at (0, 2) {x'};
    \node[node] (y2) at (4, 2) {y'};
    \node[node] (u) at (2, 0) {u};
    %Lines
    \draw[-, snake] (x) to (x2);
    \draw[-, snake] (y) to (y2);
    \draw[-] (x2) to node[left] {a} (u);
    \draw[-] (u) to node[right] {b} (y2);
\end{tikzpicture}\\
Тогда ребра $a$ и $b$ вершинно не двусвязные\\
\textbf{Определение}\\
\textit{Мост} -- ребро, соединяющее вершины из разных компонент реберной двусвязности\\
\textit{Мост} -- ребро, при удалении которого количество компонент связности увеличивается\\
\subsection{Ориентированные графы}
\textbf{Определение}\\
\textit{Ориентированный граф} -- множество вершин $V$ и ребер $E \subset V \times V$ (разрешаем петли)\\
В ребре $w = uv$ $\nm{beg} w = u, \nm{end} w = v$\\
\textit{Путь} $P$ -- последовательность $u_oe_1u_1\ldots e_ku_k$, где $u_i$ -- вершина, $e_i = u_{i-1}u_i$ -- ребро\\
\textit{Циклический путь} -- путь, где $u_0 = u_k$\\
\textit{Цикл} -- класс эквивалентности циклических путей относительно циклического сдвига\\
\textbf{Теорема}\\
Если $G$ -- ациклический ориентированный граф, то $\ex \phi: V \rto \{1,\ldots, n\}: uv\in E \Rto \phi(u) < \phi(v)$\\
(существует топологическая сортировка -- т.е. способ пронумеровать вершины так, чтобы все ребра вели из вершин с меньшим номером в вершины с большим номером)\\
\textbf{Лемма}\\
$G$ -- ациклический ориентированный граф\\
Тогда существует вершина, из которой не выходит ребро\\
\textbf{Доказательство теоремы}\\
Докажем по индукции\\
Возьмем вершину, из которой не выходит ребро\\
Присвоим ей номер $n$\\
Удалим ее\\
Пронумеруем оставшиеся вершины\\
\textbf{Определение}\\
\textit{Симметризация} $G$ -- граф $\ol{G}$ такой, что $uv \in G \Rto uv,vu \in \ol{G}$\\
(Т.е. восприятие $G$ как неориентированного графа (возможно, с петлями))\\
\textit{Компонента слабой связности} -- компонента связности в $\ol G$\\
\textit{Компонента сильной связности} -- компоненты, где существуют пути $u \leadsto v$ и $v \leadsto u$\\
Сильная связность -- отношение эквивалентности\\
\subsection{Деревья}
\textbf{Определение}\\
\textit{Дерево} -- связный неориентированный граф без циклов\\
\textbf{Теорема}\\
$G$ -- граф, содержащий $n$ вершин\\
Рассмотрим утверждения:
\begin{enumerate}
    \item В нем $n-1$ ребро
    \item В нем нет циклов
    \item Он связен
\end{enumerate}
Любые два утверждения влекут третье и задают дерево\\
\textbf{Лемма}\\
Пусть $G$ -- дерево, содержащее $\geq 2$ вершины\\
Тогда $\ex$ вершина степени 1\\
(На самом деле их хотя бы две)\\
\textbf{Доказательство}\\
Возьмем вершину $u_1$. Если у нее степень 1, ч.т.д.\\
Иначе пойдем в ее соседа $u_2$. Если у него степень 1, ч.т.д.\\
Иначе пойдем в соседа $u_3$, которого мы еще не посещали\\
Через не более $n$ шагов мы придем в вершину $u_i$, все соседи которой уже посещены\\
Если $u_i$ имеет более одного соседа, то мы нашли цикл. Отсюда $u_i$ будет иметь степень 1\\
\textbf{Доказательство 2}\\
Рассмотрим самый длинный путь в графе\\
Предположим, что его конец имеет степень, не равную 1\\
Тогда либо мы можем продлить путь, либо мы нашли цикл\\
Отсюда концы пути имеют степени 1, ч.т.д.\\
\textbf{Доказательство теоремы}
\begin{itemize}
    \item[$2 + 3 \Rto 1$] $ $\\
    Если $n = 1$ -- очевидно\\
    Если $n > 1$: Возьмем вершину степени 1\\
    Удалим ее вместе с ребром. Докажем, что в оставшемся ациклическом связном графе $n-2$ ребра
    \item[$1 + 2 \Rto 3$] $ $\\
    Пусть в графе $k$ компонент связности\\
    Если в $i$ компоненте $n_i$ вершин, то в ней $n_i - 1$ ребро\\
    Тогда всего ребер в графе $\sum_{i=1}^k (n_i - 1) = n - k = n - 1$\\
    Отсюда $k=1$
    \item[$1 + 3 \Rto 2$] $ $\\
    Если $n = 1$ -- очевидно\\
    Если $n > 1$ и есть вершина степени 1, удалим ее. Количество циклов это не уменьшает. Докажем, что оставшийся граф ацикличен\\
    Если $n > 1$ и нет вершины степени 1, то из каждой вершины выходит как минимум 2 ребра. Тогда всего ребер не меньше $\frac{2 * n}2 = n$ -- противоречие
\end{itemize}
\textbf{Лемма о рукопожатии}\\
$\sum_{u \in V} \deg u = \sum_{u \in V} \sum_{e \in E} [1, \nm{if} e = uv \lor e = vu] = \sum_{e \in E} \ub{2}{\sum_{u \in V} [1, \nm{if} e = uv \lor e = vu]} = 2|E|$\\
\textbf{Теорема}\\
$G$ -- дерево $\LRto \fall u,v\ \ex!$ простой путь $u \leadsto v$\\
\textbf{Доказательство $\Rto$}\\
Среди всех пар вершин, между которыми существует хотя бы два простых пути, выберем пару, для которой $l_1+l_2$ минимально\\
Тогда эти пути не имеют общих вершин, кроме концов (из минимальности)\\
Тогда эти два пути образуют цикл\\
\textbf{Доказательство $\Lto$}\\
Граф связен\\
Граф ацикличен -- если это не так, то между вершинами в цикле есть два простых пути\\
Отсюда это дерево\\
\textbf{Теорема}\\
$G$ -- связен $\LRto G$ связен и любое ребро -- мост\\
\textbf{Определение}\\
$G$ -- граф\\
$H$ -- получен удалением из $G$ вершин и/или ребер\\
$H$ -- \textit{подграф} $G$\\
\textbf{Определение}\\
$G$ -- граф\\
$H$ -- получен из $G$ удалением вершин (и ребер, выходящих из них)\\
$H$ -- \textit{индуцированный} подграф $G$\\
\textbf{Определение}
$G$ -- граф\\
$H$ -- получен из $G$ удалением ребер с сохранением связности\\
$H$ -- \textit{остовный} подграф $G$\\
\textbf{Теорема}\\
У любого связного графа есть остовное дерево\\
\textbf{Доказательство 1}\\
Обойдем граф bfs-ом и получим дерево\\
\textbf{Доказательство 2}\\
Среди всех остовных подграфов возьмем граф с минимальным количеством ребер\\
Утверждается, что он будет деревом\\
\textbf{Доказательство 3 (жадный алгоритм)}\\
Будем удалять ребра, пока граф связен\\
Мы получим ацикличный связный граф\\\\
Научимся считать количество остовных деревьев\\
Рассмотрим матрицу $n\times n$:\\
На диагонали напишем степень вершины\\
В остальных клетках поставим -1, если вершины соединены ребром, иначе 0\\
\textbf{Определение}\\
\textit{Матрица Кирхгофа} -- матрица $n\times n$ такая, что $a_{ij} = \left\{\begin{array}{cc}
    \deg i & i = j\\
    -1 & ij\in E\\
    0 & 
\end{array}\right.$\\
\textbf{Теорема}\\
Пусть $G$ -- связный граф\\
Тогда количество остовных деревьев $G = \widehat{A_ij}\ \fall i,j$ -- алгебраическое дополнение любого элемента матрицы $A$\\
\textbf{Лемма 1}\\
Рассмотрим \textit{матрицу инцидентности} $I_G$\\
Это матрица $n\times m, m = |E|$\\
В ней каждой вершине соответствует строка, каждому ребру соответствует столбец\\
$(I_G)_{ve} = \left\{\begin{array}{cc}
    1 & e = vu \lor e = uv\\
    0 & 
\end{array}\right.$\\
$(I_G I_G^T)_{ij} = \left\{\begin{array}{cc}
    \deg i & i = j\\
    1 & ij\in E\\
    0 & 
\end{array}\right.$\\
Ориентируем граф (для каждого ребра выберем направление). Теперь началу будет соответствовать 1, концу -- -1\\
$(\overrightarrow{I_G})_{ve} = \left\{\begin{array}{cc}
    1 & e = vu\\
    -1 & e = uv\\
    0 & 
\end{array}\right.$\\
$(\overrightarrow{I_G} \overrightarrow{I_G}^T)_{ij} = \left\{\begin{array}{cc}
    \deg i & i = j\\
    -1 & ij\in E\\
    0 & 
\end{array}\right.$\\
$\overrightarrow{I_G} \overrightarrow{I_G}^T =$ матрица Кирхгофа\\\\
\textbf{Лемма 2}\\
Рассмотрим $\overrightarrow{I_G}$\\
Выберем $n-1$ ребро\\
Рассмотрим столбцы, соответствующие этим ребрам\\
Удалим строку, соответствующую вершине $u$ ($u$ любая)\\
Мы получили матрицу $n-1\times n-1$\\
Обозначим ее как $B$\\
Если выбранные ребра образуют остовное дерево, то $|B| = \pm 1$, иначе $|B| = 0$\\
\textbf{Доказательство}\\
Рассмотрим граф $T$, образованный всеми вершинами и выбранными ребрами\\
Докажем, что если $T$ не дерево, то $|B| = 0$\\
Т.к. это не дерево и в нем $n-1$ ребро, то граф не связен\\
Рассмотрим компоненту связности, не содержащую $u$\\
Сложим строки, соответствующие вершинам из этой компоненты\\
Утверждается, что сумма $= \0$\\
Отсюда матрица вырожденная\\
Докажем, что если $T$ -- дерево, то $|B| = \pm 1$\\
По лемме у дерева есть два листа\\
Тогда есть как минимум один лист, не равный $u$. Назовем его $v_1$\\
Переставим строчку, соответствующую $v$, на первое место\\
От этого определитель не изменится с точностью до знака\\
Т.к. $v_1$ -- лист, то в соответствующей строчке будет ровно одно число, отличное от 0. Переставим столбец в начало матрицы\\
От этого определитель не изменится с точностью до знака\\
Рассмотрим дерево $T_2$, полученное удалением $v_1$ из $T$\\
В нем есть как минимум один лист, не равный $u$. Назовем его $v_2$\\
Переставим строчку, соответствующую $v_2$, на второе место\\
Т.к. $v_2$ -- лист, то в соответствующей строчке (исключая первый столбец) будет ровно одно число, отличное от 0. Переставим столбец на второе место\\
Повторим действия\\
В итоге мы получили нижнедиагональную матрицу, на диагонали которой $\pm 1$\\
Отсюда определитель будет $\pm 1$\\
\textbf{Лемма 3 (Формула Коши-Бине)}\\
Пусть даны матрицы $r\times s$ и $s \times r, r\leq s$\\
$\det AB = \sum_{1 \leq i_1 < \ldots < i_r \leq s} \det A^{i_1\ldots i_r}\det B_{i_1\ldots i_r}, A^{i_1\ldots i_r}$ -- оставили только столбцы $i_1\ldots i_r, B_{i_1\ldots i_r}$ -- оставили только строки $i_1\ldots i_r$\\\\
\textbf{Лемма 4}\\
$\widehat{A_ii} = \det (\overrightarrow{I_G}_{\text{без i строки}} \overrightarrow{I_G}^T_{\text{без i столбца}})$\\
Т.к. $m=|E| \geq n-1$, применим лемму 3:\\
$\widehat{A_ij} = \det (\overrightarrow{I_G}_{\text{без i строки}} \overrightarrow{I_G^T}^{\text{без i столбца}}) = \sum_{1 \leq i_1 < \ldots < i_{n-1} \leq m} \ub{1\text{, если образует ост.д, иначе 0}}{\det \overrightarrow{I_G}^{i_1\ldots i_{n-1}}_{\text{без i строки}}\det\overrightarrow{I_G^T}_{i_1\ldots i_{n-1}}^{\text{ без i столбца}}}$\\
Отсюда $\widehat{A_ij} = $ кол-во остовных деревьев
\subsection{Ориентированные деревья}
\textbf{Определение}\\
Пусть $G$ -- ориентированный граф\\
\textit{Подвешенное корневое дерево} -- ориентированное дерево, в котором из каждой вершины можно добраться в корень\\
\textit{Обратное подвешенное корневое дерево} -- ориентированное дерево, в котором из корня можно добраться в каждую вершину\\
\textbf{Теорема Тутта}\\
\textit{Лапласиан} графа $G$ -- матрица $(L(G))_{ij} = \left\{\begin{array}{cc}
    \deg^- i & i = j\\
    -1 & ij\in E\\
    0 & 
\end{array}\right.$ -- позволяет искать исходящиие остовные корневые деревья\\
(Для входящих $\deg^+$ и $ji \in E$)\\
Количество остовных корневых деревьев с корнем $i$ равно $\widehat{L(G)}_{ii}$\\\\
\textbf{Определение}\\
Пусть $f: \{1,\ldots, n\} \rto \{1,\ldots, n\}$\\
\textit{Функциональный граф} -- граф $G: (i, f(i)) \in E$\\
В функциональном графе каждая компонента имеет вид цикла, в которого входят деревья\\
Всего существует $n^n$ функциональных графов\\
Число функциональных подграфов $ = \prod_{u\in v} \deg^- u$
\subsection{Обход графа}
\textbf{Определение}\\
\textit{Эйлеров путь/цикл} -- путь/цикл, проходящий по каждому ребру в графе ровно один раз\\
\textit{Гамильтонов путь/цикл} -- путь/цикл, проходящий по каждой вершине в графе ровно один раз\\
Если в графе существует Эйлеров цикл, то граф называется \textit{Эйлеровым} (или граф без ребер)\\
\textbf{Теорема}\\
$G$ -- Эйлеров $\LRto$ Все его ребра лежат в одной компоненте связности и $\fall v\ \deg v$ -- четное\\
\textbf{Доказательство $\Rto$}\\
Заметим, что в каждую вершину мы вошли и вышли\\
Остюда степени четные и компонента связности одна\\
\textbf{Доказательство $\Lto$}\\
Н.у.о. будем считать, что в финальном графе одна компонента связности\\
Докажем индукцией по числу ребер\\
Если ребер 0, доказано\\
Пусть ребер $> 0$\\
//todo\\
\textbf{Теорема}\\
$G$ содержит эйлеров путь $\LRto$ Все его ребра лежат в одной компоненте связности и в графе не более двух вершин нечетной степени\\
\textbf{Доказательство}\\
Если она одна, то начнем обход в ней\\
Если их две, то соединим их фиктивной вершиной, найдем эйлеров цикл, после чего удалим ее\\
\textbf{Теорема}\\
Ориентированный граф содержит эйлеров цикл $\LRto$ граф слабо связен и $\fall v\ \deg^-(v)=\deg^+(v)$\\
\textbf{Теорема}\\
Ориентированный граф содержит эйлеров путь $\LRto$ граф слабо связен и $\deg^-(v)=\deg^+(v)$ для не более чем двух вершин $a, b$, а $\deg^+(a) = \deg^-(a) + 1$ и $\deg^+(b) = \deg^-(b) - 1$\\
\textbf{Задача}\\
Покрыть неориентированный граф минимальным количеством реберно простых путей, чтобы все ребра были покрыты\\
Всего их $\sum_{C \text{ -- к. св. с ребрами} G} \max(\frac{\nm{odd}(C)}2, 1), \nm{odd}(C)$ -- кол-во вершин нечетной степени в $C$\\
Покрыть ориентированный граф минимальным количеством реберно простых путей, чтобы все ребра были покрыты\\
Всего их $\sum_{C \text{ -- к. св. с ребрами} G} \max(\sum_{u\in C, \deg^+ u < \deg^- u}(\deg^- u - \deg^+ u), 1)$\\
\textbf{BEST-Теорема}\\
В слабо связном ориентированном эйлеровом графе число корневых деревьев всех вершин совпадает, а число эйлеровых циклов\\
$E = A\prod_{u\in V} (\deg^- u - 1)!$\\
\subsection{Укладки графов}
\textbf{Утверждение}\\
Компактные многообразия эквивалентны сфере <<с ручками>>\\
Пример: сфера с одной ручкой -- тор, с двумя -- <<крендель>>\\
\textbf{Определение}\\
Ориентируемое многообразие -- поверхность с ручками\\
Задается числом -- количество ручек\\
\textbf{Определение}\\
Укладка графа на поверхность $A$ -- инъективное отображение точек графа в точки на поверхности и ребер -- в непересекающиеся кривые\\
$V: V_G \rto A$ -- инъекция\\
$e: E_G \rto C_A$\\
$\phi \in C_A$ -- путь\\
$\phi : [0,1] \rto A,\phi(0)=\nm{beg}(e), \phi(1)=\nm{end}(e)$\\
$\fall \phi_1, \phi_2\ \phi_1[0,1]\cap \phi_2[0,1] = 0$\\
\textbf{Теорема}\\
Любой граф можно вложить в $\Rset^3$\\
\textbf{Доказательство}\\
Вложим граф как-то с пересечениями\\
Для каждого пересечения искривим одно из ребер, чтобы убрать пересечение\\
\textbf{Доказательство 2}\\
Воспользуемся вероятностным методом: случайно расположим точки, после чего проведем ребра-отрезки\\
Вероятность их пересечения равна 0\\
\textbf{Определение}\\
Два графа гомеоморфны, если можно превратить $G_1$ в $G_2$ следующими операциями\\
(кратные ребра разрешены)
\begin{enumerate}
    \item Удаляем ребро $uv$, добавляем вершину $x$ и ребра $ux, xv$
    \item Берем вершину $x$ степени 2 с соседями $u, v$\\
    Удалим вершину $x$ и добавим ребро $uv$
\end{enumerate}
\textbf{Лемма 1}\\
$G$ можно уложить на $\Rset^2 \LRto G$ можно уложить на сфере\\
\textbf{Доказательство}\\
Нарисуем плоскость\\
Положим на нее сферу\\
Точка соприкосновения сферы и плоскости =: южный полюс $S$\\
Противоположная сторона сферы =: северный полюс $N$\\
Возьмем точку $x$ на плоскости\\
Построим отрезок $xN$\\
Точка пересечения отрезка со сферой $x'$ -- существует и единственная\\
Т.о. мы построили непрерывную биекцию между сферой $\setminus \{N\}$ и плоскостью\\
Теперь положим сферу на плоскость так, чтобы северный полюс не лежал на ребре и не был вершиной\\
Тогда биекция ребра переводит в кривые-ребра, а вершины -- в точки-вершины\\
\textbf{Определение}\\
Грани -- области, полученные разрезанием поверхности по ребрам\\
\textbf{Теорема (Формула Эйлера)}\\
В связном графе на плоскости $V + F - E = 2$\\
$V$ -- число вершин\\
$E$ -- число ребер\\
$F$ -- число граней\\
\textbf{Доказательство}\\
Будем рисовать наш граф постепенно\\
При добавлении ребра количество ребер увеличивается на 1($E+=1$) и число граней увеличивается на 1($F+=1$)\\
При добавлении вершины число ребер увеличивается на 1($E+=1$) и число вершин увеличивается на 1($V+=1$)\\
Тогда $V + F - E = 2$\\
\textbf{Теорема}\\
$K_5$ нельзя уложить на плоскости\\
\textbf{Доказательство}\\
$V=5$\\
$E=10$\\
Отсюда $F = 7$\\
С точки зрения теории графов грань -- это цикл\\
Цикл имеет длину хотя бы 3\\
Пройдем по каждому циклу, соответствующему грани\\
Тогда суммарно мы пройдем хотя бы по 21 ребру\\
С другой стороны, ребро лежит на границе двух граней\\
Значит по каждому ребру мы должны пройти по 2 раза\\
Т.е. мы должны пройти суммарно по 20 ребрам\\
\textbf{Теорема 2}\\
$K_{3,3}$ нельзя уложить на плоскости\\
\textbf{Доказательство}\\
В двудольном графе цикл имеет длину хотя бы 4\\
Применяем тот же трюк\\
\textbf{Теорема}\\
В произвольном графе $G$ $3V - 6 \geq E$\\
В произвольном двудольном графе $G$ $2V - 4 \geq E$\\
\textbf{Лемма}\\
$G_1, G_2$ гомеоморфны\\
$G_1$ можно уложить $\LRto G_2$ можно уложить\\
\textbf{Лемма}\\
$G$ -- подграф $H$\\
$H$ можно уложить $\Rto G$ можно уложить\\
\textbf{Лемма}\\
$G$ можно уложить на плоскости и $u$ -- вершина $G$, то $G$ можно уложить так, чтобы $u$ была инцидентна(смежна) внешней грани\\
\textbf{Доказательство}\\
Переложим граф на плоскости\\
Переложим его на сферу\\
Повернем сферу так, чтобы грань, инцидентная $u$, содержала северный полюс\\
Переложим граф на плоскость\\
\textbf{Лемма}\\
$G$ можно уложить на плоскости и $uv$ -- ребро $G$, то $G$ можно уложить так, чтобы $uм$ было инцидентно(смежна) внешней грани\\
\textbf{Определение}\\
$G$ -- планарный, если его можно уложить на плоскость\\
\textbf{Лемма}\\
Если все компоненты реберной двусвязности $G$ планарны, то $G$ планарен\\
\textbf{Доказательство}\\
Докажем по индукции\\
База ($n=1$) -- очевидно\\
Переход: Удалим мост $uv$\\
Тогда в каждой компоненте связности $\leq n-1$ компонента реберной двусвязности\\
Уложим их так, чтобы $u$ и $v$ оказались инцидентны внейшней грани\\
Проведем ребро $uv$\\
\textbf{Лемма}\\
Если все компоненты вершинной двусвязности $G$ планарны, то $G$ планарен\\
\textbf{Доказательство}\\
Докажем по индукции\\
База ($n=1$) -- очевидно\\
Переход: Разобьем граф по какой-либо точке сочленения $v$ на два графа\\
В каждой будет своя копия вершины $v$ -- $v_i$
Уложим их так, чтобы $v_i$ лежали во внешней грани\\
Теперь удалим все $v_i$, кроме $v_1$ и <<притянем>> все ребра из $v_i$ к $v_1$\\
\textbf{Теорема}\\
$G$ можно уложить на $\Rset^2 \LRto G$ не содержит подграфов, гомеоморфных $K_5$ и $K_{3,3}$\\
\textbf{Доказательство $\Lto$}\\
Очевидно\\
\textbf{Доказательство $\Rto$}\\
% Пусть $G$ не планарен, но у него нет подграфов, гомеоморфных $K_5$ и $K_{3,3}$\\
% Среди всех таких $G$ выберем тот, у которого минимальное число ребер\\
% У данного графа нет мостов и точек сочленения из минимальности\\
% $\fall uv \in G\ G\setminus\{uv\}$ -- планарный\\
% $G\setminus\{uv\}$ -- не содержит мостов и точек сочленения\\
*слишком сложно описать доказательство, просто поверьте*\\
% $u$ и $v$ в $G\setminus\{uv\}$
\subsection{Раскраска}
\textbf{Определение}\\
$c: V \rto \{1,2, \ldots, k\}$ -- раскраска\\
Раскраска \textit{правильная}, если $\fall uv\ c(u) \neq c(v)$\\
По умолчанию будем говорить о правильный раскрасках\\
\textbf{Определение}\\
$G$ раскрашиваемый в $k$ цветов, если существует правильная раскраска в $k$ цветов\\
$k=1$ -- граф изолированный\\
$k=2$ -- граф двудольный\\
\textbf{Теорема}\\
Граф двудольный $\LRto$ любой цикл четный\\
\textbf{Определение}\\
Пусть есть граф $G$\\
Хроматическая функция $p_G(t)$ -- число способов раскрасить $G$ в $t$ цветов (можно использовать не все цвета)\\
$p_{K_n}(t)=t(t-1)\ldots(t-n+1) = t^{\ul n} = \frac{t!}{(t-n)!}$\\
\textbf{Определение}\\
$G / uv$ -- стягивание графа по $uv$\\
Стягивание означает, что мы заменяем вершины $u$ и $v$ одной вершиной\\
Если цвета $u$ и $v$ равны, то стягивание не влияет на раскраски\\
\textbf{Лемма}\\
Пусть $uv$ -- ребро в $G$\\
$p_G(t) = p_{G\setminus\{uv\}}(t) - p_{G/uv}(t)$\\
\textbf{Теорема о хроматическом многочлене}\\
Пусть $G$ -- неориентированный граф с $n$ вершинами, $m$ ребрами, $k$ компонентами связности\\
Тогда $p_G(t) = t^n - m t^{n-1} + p_{n-2}t^{n-2} - p_{n-3}t^{n-3} + \ldots \pm p_kt^k, p_i > 0$ (коэффициенты знакочередуются)\\
\textbf{Доказательство}\\
Индукция по числу вершин и ребер\\
Если $n = n, m=0$, то $p_G(t) = t^n$\\
Если $m > 0$\\
Рассмотрим ребро $uv$\\
$p_G(t) = p_{G\setminus uv}(t) - p_{G / uv}(t)$\\
Если $uv$ -- не мост\\
$p_{G\setminus uv}(t) = t^n - (m-1)t^{n-1} + q_{n-2}t^{n-2} - \ldots \pm q_k t^k$\\
$-p_{G / uv}(t) = -t^{n-1} + r_{n-2}t^{n-2} + \ldots \pm r_k t^k$\\
Отсюда $p_G(t) = t^n - mt^{n-1} + p_{n-2}t^{n-2} - \ldots \pm p_{k}t^k, p_i > 0$\\
Если $u_v$ -- мост, то $q_k = 0$, но это ничего не меняет\\
\textbf{Теорема}\\
$G$ -- дерево $\LRto p_G(t)=t(t-1)^{n-1}$\\
\textbf{Доказательство $\Lto$}\\
$p_G(t) = t^n - (n-1)t^{n-1} + \ldots + t$\\
Отсюда $n=n, m = n-1, k = 1$ -- дерево\\
\textbf{Доказательство $\Rto$}\\
Возьмем в графе лист $a$ и удалим его\\
$p_{\{v\}} = t$\\
$p_{G \setminus a}(t) = t(t-1)^{n-2}$\\
$p_{G}(t) = (t-1)p_{G \setminus a}(t)$\\
\textbf{Лемма}\\
В планарном графе $\ex u: \deg u \leq 5$\\
\textbf{Доказательство}\\
$E \leq 3v - 6$\\
Пусть это не так\\
Тогда $6V \leq 2E \leq 6V - 12$\\
\textbf{Теорема (super light)}\\
Любой планарный граф можно раскрасить в 6 цветов\\
\textbf{Доказательство}\\
Рассмотрим вершину степени не более 5\\
Удалим ее из графа\\
Планарность не сломается\\
Остаток раскрасим в 6 цветов\\
Потом добавим вершину обратно вершину\\
Для нее всегда можно выбрать какой-то цвет\\
\textbf{Теорема Хивуда (medium)}\\
Любой планарный граф можно раскрасить в 5 цветов\\
\textbf{Доказательство}\\
Рассмотрим вершину степени не более 5\\
Если степень меньше 5, применим трюк из прошлого доказательства\\
Если степень ровно 5, удалим ее\\
Раскрасим граф в 5 цветов\\
Вернем ее\\
Если есть 2 соседа одного цвета, то мы победили\\
Пусть все соседи разных цветов\\
Пусть \underline{по часовой стрелке} расположены соседи цветов 1, 2, 3, 4, 5\\
Возьмем соседа цвета 1, запустим DFS по вершинам цвета 1 и 3\\
Если мы не дошли до соседа цвета 3, то в дереве DFS'а поменяем всета 1 и 3 местами\\
Тогда нашу вершину покрасим в цвет 1\\
Пусть мы дошли до соседа цвета 3 (т.е. нашли цикл)\\
Тогда повторим аналогичные действия с вершинами цвета 2 и 4\\
Из планарности цикл в обходе невозможен\\
\textbf{Теорема (hard)}\\
Любой планарный граф можно раскрасить в 4 цвета\\
\textbf{Доказательство слишком сложное}\\
\textbf{Определение}\\
Регулярный граф -- граф, где все степени одинаковые\\
$\deg G = d$\\
\textbf{Лемма}\\
Пусть $G$ -- граф, $\deg v \leq d, \ex u: \deg u < d$\\
Тогда его можно раскрасить в $d$ цветов\\
\textbf{Доказательство}\\
Запустим из $u$ DFS\\
Построим остовное дерево с корнем в $u$\\
Будем раскрашивать вершины с листьев к корню\\
Вершину будем красить, если все ее дети уже покрашены\\
У каждой вершины всегда есть один непокрашенный сосед -- ее родитель\\
Тогда мы сможем покрасить дерево\\
\textbf{Теорема (Брукс)}\\
Пусть $G$ -- связный граф\\
$\deg v \leq d$\\
$G \neq K_n$\\
$G \neq C_{2n+1}$ (цикл)\\
Тогда $\ex$ раскраска $G$ в $d$ цветов\\
\textbf{Доказательство}\\
% Рассмотрим регулярный граф, не являющийся полным и не являющийся регулярным циклом\\
% Остальные случаи следуют из леммы\\
% \begin{itemize}
%     \item Если есть две вершины $u,v, uv \not\in G, xv,xu \in G, G\setminus \{u,v\}$ -- связный\\
%     Выполним действия, аналогичные лемме, но $u,v$ покрасим в один цвет\\
%     Тогда для $x$ можно будет выбрать цвет
%     \item В $G$ есть точка сочленения\\
%     Случай очевидный
%     \item В $G$ нет точки сочленения\\
% \end{itemize}
Какая-то глина
\subsection{Паросочетания в произвольных графах}
\textbf{Определение}\\
$I \subset V: \fall u,v \in I\ uv \not\in E$ -- \textit{независимое множество(антиклика)}\\
$\alpha(G)$ -- максимальный размер независимого множества в графе\\
\textbf{Определение}\\
$C \subset V: \fall uv \in E\ u\in C \lor v \in C$ -- \textit{вершинное покрытие}\\
$\beta(G)$ -- минимальный размер вершинного покрытия\\
\textbf{Теорема}\\
$\alpha(G) + \beta(G) = n$\\
\textbf{Лемма}\\
$A$ -- вершинное покрытие $\LRto V \setminus A$ -- независимое множество\\
\textbf{Доказательство}\\
Для каждого ребра верно, что один его конец лежит в $A$\\
Тогда не существует такого ребра $uv$, что $u, v \not\in A$\\
Тогда $V \setminus A$ для каждого ребра содержит не более одного его конца\\
\textbf{Определение}\\
\textit{Паросочетание} -- $M \subset E: \fall e,f \in M\ e,f$ не имеют общих концов\\
$\alpha'(G)$ -- размер максимального паросочетания в $G$\\
\textbf{Определение}\\
\textit{Реберное покрытие} -- $F\subset E: \fall u \ex e\in F: e = uv$\\
$\beta'(G)$ -- размер минимального реберного покрытия\\
\textbf{Теорема}\\
$\alpha'(G)+\beta(G) = n$\\
\textbf{Определение}\\
Будем рассматривать связные графы\\
Рассмотрим паросочетание размера $\alpha'(G)$\\
Для каждой изолированной вершины добавим свое ребро\\
Мы получим реберное покрытие\\
$\beta'(G) \leq \alpha'(G)+n - 2\alpha'(G)$\\
$\alpha'(G) + \beta'(G) \leq n$\\
Теперь возьмем минимальное реберное покрытие\\
Теперь выберем в этом графе максимальное паросочетание (пусть его размер -- $k$)\\
$k \leq \alpha'(G)$\\
Заметим, что для любого ребра в покрытии паросочетанием покрыта ровно один его конец:\\
Если оба конца покрыты, то это ребро не может лежать в минимальном покрытии\\
Если ни один конец не покрыт, то паросочетание не максимальное\\
Тога $\beta'(G) = n - 2k + k$\\
$n \leq \alpha'(G) + \beta'(G)$\\
\textbf{Определение}\\
Доминирующее множество $D \subset V: \fall u\ u\in D \lor \ex v\in D: uv \in E$\\
$\gamma(G)$ -- размер минимального доминирующего множества\\
\textbf{Определение}\\
\textit{Клика} -- $C\subset V: \fall u,v \in C: uv \in E$\\
$\omega(G)$ -- максимальная клика\\
\textbf{Определение}\\
Паросочетание \textit{совершенное}, если оно покрывает все вершины\\
\textbf{Определение}\\
Пусть зафиксировано множество ребер $M$\\
Путь \textit{чередующийся}, если в нем чередуются ребра из $M$ и не из $M$\\
Цикл \textit{чередующийся}, если в нем чередуются ребра из $M$ и не из $M$\\
Чередующийся путь \textit{дополняющий}, если его крайние ребра не в $M$\\
Чередующийся путь \textit{сбалансированный}, если ровно одно его крайнее ребро не в $M$\\
Чередующийся путь \textit{антидополняющий}, если его крайние ребра в $M$\\
\textbf{Определение}\\
$M$ -- максимальное $\LRto$ не существует дополняющих путей\\
$|M| = \alpha'(G)$\\
\textbf{Доказательство}\\
$M_1 \oplus M_2$ -- множество ребер, которые входят ровно в одно паросочетание\\
Компоненты связности в получившемся графе -- циклы и пути, дополняющие для $M_1,M_2$ или сбалансированные\\
Докажем $\Rto$\\
Пусть $M$ -- максимальный\\
Возьмем $M\oplus M_2$\\
В этом графе нет дополняющих путей: если бы они были, то $M$ был бы не максимальным\\
Докажем $\Lto$\\
Пусть не существует дополняющих путей\\
Возьмем $M_{max}$\\
$|M_{max}| \geq |M|$\\
Т.к. нет дополняющих путей, то в $M\oplus M_{max}$ есть только циклы, сбалансированные и антидополняющие пути\\
В каждом цикле/пути ребер из $M$ не меньше, чем из $|M_{max}|$\\
Тогда $|M| \geq |M_{max}|$\\
Тогда $|M| = |M_{max}|$\\
Отсюда $|M_{max}| = |M|$\\
\textbf{Определение}\\
$T \subset V$ --  множество Татта, если $\nm{odd}(G\setminus T) > |T|$, где $\nm{odd}$ -- количество компонент нечетного размера\\
\textbf{Теорема Татта}\\
$G$ содержит совершенное паросочетание $\LRto \fall S \subset V\ \nm{odd}(G \setminus S) \leq |S|$ (граф содержит множество Татта)\\
\textbf{Доказательство $\Rto$}\\
Пусть это не так\\
Пусть в графе содержится множество Татта $T$, и есть совершенное паросочетание\\
Удалим его из графа\\
Тогда у нас получился $\nm{odd}(G\setminus T)$ компонент с нечетным количеством вершин\\
Внутри них нет совершенного паросочетания\\
Тогда в каждой компоненте существует вершина, которая в совершенном паросочетании связана с вершиной из $T$\\
Но таких вершин больше, чем $|T|$\\
Отсюда множества Татта быть не может\\
\textbf{Лемма}\\
Рассмотрим $uv \not\in E$\\
$\nm{odd}(G\cup \{uv\}) \leq \nm{odd}(G)$\\
\textbf{Лемма 2}\\
$G$ -- не содержит множество Татта, $uv\not\in E$\\
Тогда $G \cup \{uv\}$ не содержит множество Татта\\
\textbf{Доказательство}\\
Рассмотрим $S \in V$\\
$\nm{odd}((G\cup \{uv\})\setminus S) = \nm{odd}(\left[\begin{array}{ll}
    G\setminus S\\
    G\setminus S \cup \{uv\}
\end{array}\right.) \leq \nm{odd}(G\setminus S)$\\
\textbf{Доказательство $\Lto$}\\
Пусть в графе $G$ не содержится множество Татта и не содержится совершенного паросочетания\\
Среди всех таких графов выберем $G$ с минимальным числом ребер, а затем с максимальным числом вершин\\
$G$ содержит четное число вершин -- иначе $\varnothing$ -- множество Татта\\
Тогда $G \neq K_n$ (иначе бы в нем содержалось совершенное паросочетание)\\
$U:=\{v: \deg v = n-1\}, U \neq V$\\
\textbf{Лемма 3}\\
Компоненты связности $G\setminus U$ -- полные графы\\\\
Рассмотрим эти компоненты\\
В четных компонентах выберем паросочетания\\
В нечетных выберем паросочетания, оставив одну вершину\\
Т.к. множества Татта нет, то $|U| \geq \nm{odd}(G\setminus U)$\\
Но вершины $U$ связаны со всеми\\
Соединим вершины $U$ с оставшимися вершинами из компонент в паросочетание\\
Возможно, в $U$ остались изолированные вершины\\
Соединим из в паросочетание (это возможно, т.к. в графе четное число вершин)\\
Т.о. мы построили совершенное паросочетание -- противоречие\\
\textbf{Доказательство леммы 3}\\
В графе $G\setminus U$ каждая вершина хотя бы с какой-то не связана\\
Предположим, что в какой-то компоненте $G \setminus U$ есть компонента, не являющаяся полным графом\\
Тогда в ней хотя бы два ребра\\
Выберем эти ребра $xy, xz: zy \not\in E$\\
Возьмем $w: xw \not\in E$\\
Вспомним, что $G$ -- граф с максимальным числом ребер\\
Тогда при добавлении ребра в $G$ должно появиться множество Татта(невозможно по леммам) или идеальное паросочетание\\
Тогда при добавлении $yz$ в графе должно появиться идеальное паросочетание\\
Назовем это паросочетание $M_1$ ($yz \in M_1$)\\
Уберем $yz$ и добавим $xw$\\
Назовем это паросочетание $M_2$ ($xw \in M_2$)\\
$M_1 \oplus M_2$\\
$yz, xw \in M_1\oplus M_2$\\
Заметим, что в $M_1\oplus M_2$ нет путей: если есть путь, то его конец лежит только в одном паросочетании, но покрыты все вершины\\
Тогда компоненты связности -- циклы
\begin{enumerate}
    \item $yz, xw$ -- в разных компонентах\\
    Тогда возьмем из компоненты $yz$ ребра $M_2$, а из компоненты $xw$ -- ребра $M_1$\\
    Из других компонент возьмем или ребра $M_1$, или ребра $M_2$\\
    Мы получили совершенное паросочетание -- противоречие
    \item $yz, xw$ -- в одной компоненте\\
    Утвержается, что можно взять в этой компоненте ребра так, что при добавлении ребра $xz$ или $xy$ возникает паросочетание -- противоречие
\end{enumerate}
\textbf{Определение}\\
$\nm{def} G = n - 2\alpha'(G)$ -- дефицит $G$ -- количество вершин, не покрытых максимальным паросочетанием\\
\textbf{Теорема (Формула Бержа)}\\
$\nm{def} G = \max_{S\subset V} (\nm{odd}(G\setminus S) - |S|)$\\
\textbf{Замечание}\\
$\nm{def} G \geq \nm{odd}(G) - |\varnothing| \geq 0$\\
% \textbf{Доказательство}\\
% Утверждение: $n + |S| + \nm{odd}(G\setminus S) \% 2 = 0$\\
% Удалим $S$ из $G$\\
% Остались компоненты $K_1, \ldots, K_t$\\
% $K_1+\ldots + K_t + |S| = n$\\
% $(K_1+\ldots + K_t) \% 2 = \nm{odd}(G\setminus S) \% 2$\\
% Отсюда $(\nm{odd}(G\setminus S) + |S|)\%2 = n\%2$\\
% Тогда $\fall S\ (\nm{odd}(G\setminus S) - |S|) \%2 = n\%2$
% \begin{enumerate}
%     \item Если $\max_{S\subset V} (\nm{odd}(G\setminus S) - |S|) = 0$, то $\fall S\ \nm{odd}(G\setminus S) \leq |S|$
%     \item Если $\max_{S\subset V} (\nm{odd}(G\setminus S) - |S|) = k$:\\
%     Возьмем $K_k$\\
%     Каждую вершину из $K_k$ соединим с каждой вершиной $G$\\
%     Для графа $H = K_k + G$ выполнено условие Татта\\
% \end{enumerate}
% \textbf{Лемма}\\
% $\fall S \subset V_H\ \nm{odd}(G\setminus S) \leq |S|$\\
% \textbf{Доказательство}\\
% Рассмотрим $S \setminus V_H$\\
% Если $K_k \not\setminus S$\\
//todo 1:22
\subsection{Паросочетания №2}
\textbf{Определение}\\
$G$ -- фактор-критический, если $\fall u\ G\setminus u$ содержит совершенное паросочетание\\
$\nm{def} G = 1$\\
$\alpha'(G) = \frac{n-1}{2}$\\
$\fall u \in V\ \alpha'(G\setminus u) = \alpha'(G)$\\
\textbf{Лемма Татта}\\
$\fall u \in V\ \alpha'(G\setminus u) = \alpha'(G) \Rto G$ -- фактор-критический\\
\textbf{Лемма}\\
Пусть $\fall u \in V\ \alpha'(S\setminus u)$\\
$S \neq \varnothing \Rto S$ -- не множество Татта\\
\textbf{Доказательство}\\
Рассмотрим $v\in S$\\
$G'=G\setminus v$\\
$S'=S\setminus v$\\
$\nm{def} G' \geq \nm{odd}(G'\setminus S') - |S'| = \nm{odd}(G\setminus S) - |S| + 1 = \nm{def} G + 1$\\
Но дефицит не может увеличиться\\
Отсюда $S = \varnothing$\\
Отсюда $\nm{def} = 1$\\
Отсюда $G$ -- фактор-критический\\
\textbf{Декомпозиция Эдмондса-Галлаи}\\
$D = \{v: \ex M$ -- максимальное паросочетание, $M$ -- не покрывает $v\}$\\
$A$ -- соседи $D$\\
$C = V\setminus(A\cup D)$\\
\textbf{Теорема}\\
Пусть $M$ -- совершенное паросочетание в $V$\\
Тогда $M$ покрывает все вершины $C$, причем вершины из $C$ находятся в паросочетании с вершинами $C$\\
В каждой компоненте связности $D$ покрыты все вершины, кроме одной (которая единственная может быть связана с вершиной из $A$)\\
$M$ покрывает все вершины из множества $A$\\
Компоненты в $D$ -- фактор-критические\\
$A$ -- множество Татта\\
\textbf{Лемма}\\
$a \in A$\\
Удалим ее\\
$D(G\setminus a) = D(G)$\\
$A(G\setminus a) = A(G)\setminus a$\\
$C(G\setminus a) = C(G)$\\
$\alpha(G\setminus a) = \alpha'(G)-1$\\
\textbf{Доказательство}\\
% Все утверждения следуют из 1\\
% Докажем 1\\
% $D(G) \subset D(G\setminus a)$\\
% Возьмем $v \in D(G\setminus a)$. Пусть $v \not\in D(G)$\\
% Т.к. $a \in A$, то $\ex w: a$ в паросочетании с $w$ в $G$\\ 
% Пусть $M_v$ -- макс. паросочетание в $G\setminus a$, не покрывающее $v$\\
% $M_w$ -- макс. паросочетание в $G$, не покрывающий $w$
//todo
\subsection{Факторизация}
\textbf{Определение}\\
Регулярный остов степени $k$ -- $k$-фактор графа\\
0-фактор -- изолированные вершины\\
1-фактор -- совершенное паросочетание\\
2-фактор -- разбиение на циклы\\
\textbf{Определение}\\
$f$-фактор, где $f$-вектор длины $n$\\
Остов, где $\deg i = f_i$\\
\textbf{Алгоритм}\\
Заменим $i$-ую вершину на $\deg i$ вершин\\
Теперь соединим эти вершины, чтобы при конденсации получился исходный граф (степени каждой вершины должны быть 1)\\
Найдем в полученном графе паросочетания\\
Далее для каждой вершины создадим $\deg i - d_i$ вершин и соединим каждую из них со всеми вершинами $i$ из предыдущего шага\\
Теперь найдем совершенное паросочетание\\
Удалим вершины из предыдущего шага и выполним конденсацию\\
\section{Матроиды}
\textbf{Определение}\\
Пусть есть множество $X$ -- носитель\\
Рассмотрим подмножества $X$\\
Пусть <<хорошие>> подмножества -- независимые\\
<<плохие>> -- зависимые\\
Множество хороших подмножеств $I \subset 2^X$\\
$I$ должно удовлетворять следующим свойствам:
\begin{enumerate}
    \item $\varnothing \in I$ -- аксиома нетривиальности
    \item $A \in I, B \subset A \Rto B\in I$
\end{enumerate}
Такая система называется предматроидом или Inheritance system\\
Но в такой системе не будет работать жадный алгоритм\\\\
Добавим еще одну аксиому:\\
$A \in I, B\in I, |A| > |B|$\\
Тогда $\ex x\in A \setminus B: B \cup x \in I$ -- аксиома замены\\
\textbf{Пример 1 (матричный матроид)}\\
$F^m, F$ -- поле\\
$I$ -- множества линейно независимых векторов\\
\textbf{Пример 2 (графовый матроид)}\\
Рассмотрим $G$ -- неориентированный граф $\an VE$\\
$X = E, I$ -- ациклическое множество\\
Докажем аксиому замены\\
$|V| = n, |E| = m$
Пусть есть множества $A$ и $B, |A| > |B|$\\
Рассмотрим компоненты связности в графе $G_A$ и $G_B$\\
Количество компонент связности $C_A = n - |A|, C_B = n - |B|$\\
$C_A < C_B$\\
Значит в $A$ существует компонента связности, содержащая вершины из двух компонент в $B$\\
Тогда в $A$ есть ребро, соединяющее разные компоненты из $B$\\
\textbf{Утверждение}\\
Рассмотрим $X_1, I_1 \subset 2^{X_1}$\\
$X_2, I_2 \subset 2^{X_2}$\\
Существует биекция $\phi:X_1 \rto X_2$\\
$A \in I_1 \LRto \phi(A) \in I_2$\\
Тогда пусть $M$ -- матроид $X_1, I_1$\\
$N$ -- система подмножеств $X_2, I_2$ и существует изоморфизм $N$ и $M$\\
Тогда $N$ -- матроид\\
\textbf{Лемма}\\
Графовый матроид изоморфен матричному матроиду\\
\textbf{Доказательство}\\
Рассмотрим матрицу инцидентности\\
Представим ее как множество векторов из 0 и 1 (сложение по модулю 2)\\
Докажем, что подграф ациклический $\LRto$ множество векторов линейно независимое\\
Если $A$ содержит цикл, то сложение(xor) векторов дает 0\\
Если $A$ не содержит цикл, то это лес. Там есть лист. Тогда xor не даст 0\\
\textbf{Пример 3 (матроид паросочетаний)}
Рассмотрим $G$ -- двудольный граф \\
$X, Y$ -- вершины двух долей\\
$E$ -- множество ребер\\
Пусть $X$ -- носитель\\
$I$ -- подмножество $X$, которое может быть покрыто одним паросочетанием\\
Докажем свойство 3\\
Пусть $A$ покрывается паросочетанием $M_A$\\
$B$ -- паросочетанием $M_B$\\
Рассмотрим $M_A \oplus M_B$\\
В таком графе пути будут иметь вид $ab...aba(b)$, где $a$ -- ребро из $A$, $b$ -- ребро из $B$\\
Т.к. $|M_A| > |M_B|$, то найдется путь, начинающийся и заканчивающийся на $a$\\
Назовем его $P$\\
В $M_B \oplus P$ найдется изолированная вершина\\
Добавим ее в $B$\\
%https://youtu.be/OUzIwiR0Mrc?si=kMougbZW4NcmJ9Cq&t=3000
\textbf{Пример 4 (универсальный матроид)}\\
$U_{n,k}$\\
$X = \{1, \ldots, n\}$\\
$I$ -- подмножества $X$ не более $k$\\
\textbf{Пример 5 (разноцветный матроид)}\\
$X$ -- множество пар $\an i {c_i}, i$ -- предмет, $c_i$ -- цвет\\
$c_i \in C$\\
$I$ -- множества предметов различных цветов\\
\textbf{Определение}\\
$A \subset X$\\
$\nm{base}(A) = B: B\in I, B \subset A, |B|$ -- максимально\\
В матричном матроиде: базис\\
В графовом матроиде: остовный лес\\
$\nm{base}(X)$ -- база матроида\\
\textbf{Лемма}\\
$A \subset X$\\
$B$ -- максимальное по включению подмножество $A, B \in I$\\
Тогда $B$ -- база $A$\\
\textbf{Доказательство}\\
Пусть есть $B'$ -- база $A$\\
Если $|D| > |B|$, то по аксиоме 3 $\ex x: x \in D\setminus B, B \cup x \in I$ -- что невозможно\\
Из данной леммы следует, что мы можем применять жадные алгоритмы\\
\textbf{Определение}\\
Взвешенный матроид -- пара из матроида и $w: X \rto \Rset$ -- весовая функция\\
$w(A) = \sum_{x\in A}w(X)$\\
Как найти базу минимального веса?\\
\textbf{Алгоритм (Жадный, Радо-Эдмондса)}
\begin{lstlisting}
    sort X
    for x in X
        if (B | {x}) in I:
            B.insert(x)
\end{lstlisting}
\textbf{Лемма}\\
Пусть $A_k$ -- независимое множество минимального веса мощности $k$\\
$y$ -- элемент минимального веса такой, что $A_k \cup y \in I, y\not\in A_k$\\
Тогда $A_{k+1} := A_k \cup y$\\
\textbf{Доказательство}\\
Рассмотрим $A_k$ и $A_{k+1}$\\
По аксиоме замены $z = A_{k+1} \setminus A_k$\\
Если $w(y) < w(z)$, то $w(A_k \cup y) < w(A_{k+1})$\\
Тогда $A_{k+1}$ -- не минимального веса\\
\textbf{Доказательство корректности алгоритма}\\
По индукции\\

\end{document}
