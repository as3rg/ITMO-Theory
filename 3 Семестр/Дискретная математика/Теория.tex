\documentclass[12pt]{article}
\input{../../header.tex}

\title{Дискретная математика. Теория}
\author{Александр Сергеев}
\date{}
\begin{document}
\maketitle
\section{Графы}
\subsection{Неориентированные графы}
\textbf{Определение}\\
\textit{Неориентированный граф} -- множество вершин $V$ и множество ребер $E \subset (V\times V \setminus \{(u,u)\})/_\sim$ (факторизованное отношением эквивалентности $\sim: (u, v) \sim (v, u)$)\\
\textit{Путь} $P$ -- последовательность $u_oe_1u_1\ldots e_ku_k$, где $u_i$ -- вершина, $e_i = u_{i-1}u_i$ -- ребро\\
$k:=|P|$ или $k:=\nm{len}(P)$ -- \textit{длина пути}\\
\textit{Простой путь} -- путь, который посещает каждую вершину не более одного раза\\
\textit{Реберно-простой путь} -- путь, который посещает каждое ребро не более одного раза\\
\textit{Циклический путь} -- путь, где $u_0 = u_k$\\
Зададим \textit{цикл}:
\begin{itemize}
    \item $\letus P = u_0 e_1u_1\ldots e_ku_k$\\
    $\letus Q = u_ie_{i+1}\ldots e_ku_ke_1u_1\ldots e_iu_i$\\
    $\letus R = u_k e_ku_{k-1}\ldots e_1u_0$\\
    $P \sim R, P \sim Q$ -- равны с точностью до отражения и циклического сдвига
    \item Пусть если в циклическом пути $\fall i\ e_{i+1} \neq e_{i+2}, u_i \neq u_{i+2}$, то циклический путь называется \textit{корректным}
\end{itemize}
Тогда \textit{цикл} -- класс эквивалентности корректных циклических путей относительно отношения эквивалентности $\sim$\\
\textit{Ациклический граф} -- граф без циклов\\
\textbf{Определение}\\
Пусть $\ex P: u_0 = u, u_k = v$. Тогда $u\leadsto v$ (отношение связанности путем)\\
Пусть $P: u\leadsto v, Q: v\leadsto w$. Тогда $P\circ Q:=u\leadsto v \leadsto w$ -- конкатенация пути\\
\textbf{Теорема}\\
Отношение $\leadsto$ в неориентированном графе -- отношение эквивалентности\\
\textbf{Определение}\\
Класс эквивалентности по отношению $\leadsto$ -- \textit{компонента связности}\\
Граф, содержащий одну компоненту связности -- \textit{связный граф}\\
\textbf{Определение}\\
$u, v$ -- реберно двусвязные, если существует два (возможно, совпадающих) реберно непересекающихся пути из $u$ в $v$\\
\textbf{Теорема}\\
Реберная двусвязность -- отношение эквивалентности\\
\textbf{Доказательство}\\
Путь $u$ (из одной вершины) реберно не пересекается с самим собой. Отсюда рефлексивность\\
Симметричность очевидна\\
Докажем транзитивность\\
Рассмотрим $u, v, w$, пары $(u, v), (v, w)$ реберно двусвязные\\
$P_1, P_2$ -- пути между $u,w$\\
Рассмотрим случаи:
\begin{itemize}
    \item $w = v \lor w = u$ -- очевидно
    \item $w \in P_2$\\
    \begin{tikzpicture}
        %Nodes
        \node[node] (u) at (0, 0) {u};
        \node[node] (v) at (4, 0) {v};
        \node[node] (w) at (2, -1) {w};
        %Lines
        \draw[-, snake] (u) to [bend left] node[above] {$P_1$} (v);
        \draw[-, snake] (u) to [bend right] node[below] {$Q_1$} (w);
        \draw[-, snake] (w) to [bend right] node[below] {$Q_2$} (v);
    \end{tikzpicture}\\
    Тогда $Q_2, P_1\circ Q_2$ реберно не пересекаются
    \item $\ex a \neq v, u, w:$\\
    \begin{tikzpicture}
        %Nodes
        \node[node] (u) at (0, 0) {u};
        \node[node] (v) at (4, 0) {v};
        \node[node] (a) at (2, -1) {a};
        \node[node] (w) at (2, -3) {w};
        %Lines
        \draw[-, snake] (u) to [bend left] node[above] {$P_1$} (v);
        \draw[-, snake] (u) to [bend right] node[below] {$A_1$} (a);
        \draw[-, snake] (a) to [bend right] node[below] {$A_2$} (v);
        \draw[-, snake] (a) to [bend left] node[right] {$Q_2$} (w);
        \draw[-, snake] (a) to [bend right] node[left] {$Q_1$} (w);
    \end{tikzpicture}\\
    Тогда $A_1\circ Q_1, P_1\circ A_2\circ Q_2$ реберно не пересекаются
    \item $\ex a\neq b \neq v, u, w:$\\
    \begin{tikzpicture}
        %Nodes
        \node[node] (u) at (0, 0) {u};
        \node[node] (v) at (4, 0) {v};
        \node[node] (a) at (1.2, -1) {a};
        \node[node] (b) at (2.8, -1) {b};
        \node[node] (w) at (2, -3) {w};
        %Lines
        \draw[-, snake] (u) to [bend left] node[above] {$P_1$} (v);
        \draw[-, snake] (u) to [bend right] node[below] {$A_1$} (a);
        \draw[-, snake] (a) to node[below] {$ $} (b);
        \draw[-, snake] (b) to [bend right] node[below] {$B_1$} (v);
        \draw[-, snake] (b) to [bend left] node[right] {$Q_2$} (w);
        \draw[-, snake] (a) to [bend right] node[left] {$Q_1$} (w);
    \end{tikzpicture}\\
    Тогда $A_1\circ Q_1, P_1\circ B_1\circ Q_2$ реберно не пересекаются
    \item $\ex a \neq b \neq v, u, w:$\\
    \begin{tikzpicture}
        %Nodes
        \node[node] (u) at (0, 0) {u};
        \node[node] (v) at (4, 0) {v};
        \node[node] (a) at (2, -1) {a};
        \node[node] (b) at (2, 1) {b};
        \node[node] (w) at (2, -3) {w};
        %Lines
        \draw[-, snake] (u) to [bend left] node[above] {$B_1$} (b);
        \draw[-, snake] (b) to [bend left] node[above] {$ $} (v);
        \draw[-, snake] (u) to [bend right] node[below] {$A_1$} (a);
        \draw[-, snake] (a) to [bend right] node[below] {$ $} (v);
        \draw[-, snake] (b) to [bend left] node[right] {$Q_2$} (w);
        \draw[-, snake] (a) to [bend right] node[left] {$Q_1$} (w);
    \end{tikzpicture}\\
    Тогда $B_1\circ Q_2, P_1\circ A_1\circ Q_1$ реберно не пересекаются
    \item $ $\\
    \begin{tikzpicture}
        %Nodes
        \node[node] (u) at (0, 0) {u};
        \node[node] (v) at (2, 0) {v};
        \node[node] (w) at (4, 0) {w};
        %Lines
        \draw[-, snake] (u) to [bend left] node[above] {$P_1$} (v);
        \draw[-, snake] (u) to [bend right] node[below] {$P_2$} (v);
        \draw[-, snake] (v) to [bend left] node[above] {$Q_1$} (w);
        \draw[-, snake] (v) to [bend right] node[below] {$Q_2$} (w);
    \end{tikzpicture}\\
    Тогда $P_1\circ Q_1, P_2\circ Q_2$ реберно не пересекаются
\end{itemize}
\textbf{Определение}\\
Ребра $ab, cd$(не являющиеся петлями) являются вершинно двусвязными, если существуют два вершинно непересекающихся пути, соединяющих их концы\\
\begin{tikzpicture}
    %Nodes
    \node[node] (a) at (0, 2) {a};
    \node[node] (b) at (0, 0) {b};
    \node[node] (c) at (2, 2) {c};
    \node[node] (d) at (2, 0) {d};
    %Lines
    \draw[-, snake] (a) to (c);
    \draw[-, snake] (b) to (d);
    \draw[-] (a) to (b);
    \draw[-] (c) to (d);
\end{tikzpicture}\\
\textbf{Теорема}\\
Отношение вершинной двусвязности -- отношение эквивалентности\\
\textbf{Доказательство} аналогично предыдущей теореме\\
\textbf{Определение}\\
Рассмотрим $A = \{ a, b: ab \text{ -- вершинно двусвязные} \}$ -- \textit{компоненту вершинной двусвязности (блок)}\\
Точка $v$ -- \textit{точка сочленения}, если она лежит в нескольких блоках\\
\textbf{Теорема}\\
Вершина является точкой сочленения $\LRto$ Ее удаление увеличивает количество компонент связности\\
\textbf{Доказательство $\Rto$}\\
Пусть $u$ -- точка сочленения\\
Тогда она лежит в нескольких блоках:\\
\begin{tikzpicture}
    %Nodes
    \node[node] (x) at (0, 2) {x};
    \node[node] (y) at (4, 2) {y};
    \node[node] (u) at (2, 0) {u};
    %Lines
    % \draw[-, snake] (a) to (c);
    % \draw[-, snake] (b) to (d);
    \draw[-] (x) to node[left] {a} (u);
    \draw[-] (u) to node[right] {b} (y);
\end{tikzpicture}\\
$a, b$ -- не являются вершинно двусвязными, т.к. лежат в разных блоках\\
Тогда не существует пути $x \leadsto y$, не проходящего через $u$\\
Отсюда при удалении $u$ $x$ и $y$ окажутся в разных компонентах\\
\textbf{Доказательство $\Lto$}\\
Пусть при удалении $u$ количество компонент увеличилось\\
Возьмем $x$ и $y$ такие, что до удаления $u$ они были в одной компоненте, а после удаления оказались в разных\\
Тогда любой путь из $x$ в $y$ проходил через $u$\\
Выберем какой-то путь из $x$ в $y$ и возьмем на нем вершины $x'$ и $y'$ -- соседей вершины $u$\\
\begin{tikzpicture}
    %Nodes
    \node[node] (x) at (-2, 2) {x};
    \node[node] (y) at (6, 2) {y};
    \node[node] (x2) at (0, 2) {x'};
    \node[node] (y2) at (4, 2) {y'};
    \node[node] (u) at (2, 0) {u};
    %Lines
    \draw[-, snake] (x) to (x2);
    \draw[-, snake] (y) to (y2);
    \draw[-] (x2) to node[left] {a} (u);
    \draw[-] (u) to node[right] {b} (y2);
\end{tikzpicture}\\
Тогда ребра $a$ и $b$ вершинно не двусвязные\\
\textbf{Определение}\\
\textit{Мост} -- ребро, соединяющее вершины из разных компонент реберной двусвязности\\
\textit{Мост} -- ребро, при удалении которого количество компонент связности увеличивается\\
\subsection{Ориентированные графы}
\textbf{Определение}\\
\textit{Ориентированный граф} -- множество вершин $V$ и ребер $E \subset V \times V$ (разрешаем петли)\\
В ребре $w = uv$ $\nm{beg} w = u, \nm{end} w = v$\\
\textit{Путь} $P$ -- последовательность $u_oe_1u_1\ldots e_ku_k$, где $u_i$ -- вершина, $e_i = u_{i-1}u_i$ -- ребро\\
\textit{Циклический путь} -- путь, где $u_0 = u_k$\\
\textit{Цикл} -- класс эквивалентности циклических путей относительно циклического сдвига\\
\textbf{Теорема}\\
Если $G$ -- ациклический ориентированный граф, то $\ex \phi: V \rto \{1,\ldots, n\}: uv\in E \Rto \phi(u) < \phi(v)$\\
(существует топологическая сортировка -- т.е. способ пронумеровать вершины так, чтобы все ребра вели из вершин с меньшим номером в вершины с большим номером)\\
\textbf{Лемма}\\
$G$ -- ациклический ориентированный граф\\
Тогда существует вершина, из которой не выходит ребро\\
\textbf{Доказательство теоремы}\\
Докажем по индукции\\
Возьмем вершину, из которой не выходит ребро\\
Присвоим ей номер $n$\\
Удалим ее\\
Пронумеруем оставшиеся вершины\\
\textbf{Определение}\\
\textit{Симметризация} $G$ -- граф $\ol{G}$ такой, что $uv \in G \Rto uv,vu \in \ol{G}$\\
(Т.е. восприятие $G$ как неориентированного графа (возможно, с петлями))\\
\textit{Компонента слабой связности} -- компонента связности в $\ol G$\\
\textit{Компонента сильной связности} -- компоненты, где существуют пути $u \leadsto v$ и $v \leadsto u$\\
Сильная связность -- отношение эквивалентности\\
\subsection{Деревья}
\textbf{Определение}\\
\textit{Дерево} -- связный неориентированный граф без циклов\\
\textbf{Теорема}\\
$G$ -- граф, содержащий $n$ вершин\\
Рассмотрим утверждения:
\begin{enumerate}
    \item В нем $n-1$ ребро
    \item В нем нет циклов
    \item Он связен
\end{enumerate}
Любые два утверждения влекут третье и задают дерево\\
\textbf{Лемма}\\
Пусть $G$ -- дерево, содержащее $\geq 2$ вершины\\
Тогда $\ex$ вершина степени 1\\
(На самом деле их хотя бы две)\\
\textbf{Доказательство}\\
Возьмем вершину $u_1$. Если у нее степень 1, ч.т.д.\\
Иначе пойдем в ее соседа $u_2$. Если у него степень 1, ч.т.д.\\
Иначе пойдем в соседа $u_3$, которого мы еще не посещали\\
Через не более $n$ шагов мы придем в вершину $u_i$, все соседи которой уже посещены\\
Если $u_i$ имеет более одного соседа, то мы нашли цикл. Отсюда $u_i$ будет иметь степень 1\\
\textbf{Доказательство 2}\\
Рассмотрим самый длинный путь в графе\\
Предположим, что его конец имеет степень, не равную 1\\
Тогда либо мы можем продлить путь, либо мы нашли цикл\\
Отсюда концы пути имеют степени 1, ч.т.д.\\
\textbf{Доказательство теоремы}
\begin{itemize}
    \item[$2 + 3 \Rto 1$] $ $\\
    Если $n = 1$ -- очевидно\\
    Если $n > 1$: Возьмем вершину степени 1\\
    Удалим ее вместе с ребром. Докажем, что в оставшемся ациклическом связном графе $n-2$ ребра
    \item[$1 + 2 \Rto 3$] $ $\\
    Пусть в графе $k$ компонент связности\\
    Если в $i$ компоненте $n_i$ вершин, то в ней $n_i - 1$ ребро\\
    Тогда всего ребер в графе $\sum_{i=1}^k (n_i - 1) = n - k = n - 1$\\
    Отсюда $k=1$
    \item[$1 + 3 \Rto 2$] $ $\\
    Если $n = 1$ -- очевидно\\
    Если $n > 1$ и есть вершина степени 1, удалим ее. Количество циклов это не уменьшает. Докажем, что оставшийся граф ацикличен\\
    Если $n > 1$ и нет вершины степени 1, то из каждой вершины выходит как минимум 2 ребра. Тогда всего ребер не меньше $\frac{2 * n}2 = n$ -- противоречие
\end{itemize}
\textbf{Лемма о рукопожатии}\\
$\sum_{u \in V} \deg u = \sum_{u \in V} \sum_{e \in E} [1, \nm{if} e = uv \lor e = vu] = \sum_{e \in E} \ub{2}{\sum_{u \in V} [1, \nm{if} e = uv \lor e = vu]} = 2|E|$\\
\textbf{Теорема}\\
$G$ -- дерево $\LRto \fall u,v\ \ex!$ простой путь $u \leadsto v$\\
\textbf{Доказательство $\Rto$}\\
Среди всех пар вершин, между которыми существует хотя бы два простых пути, выберем пару, для которой $l_1+l_2$ минимально\\
Тогда эти пути не имеют общих вершин, кроме концов (из минимальности)\\
Тогда эти два пути образуют цикл\\
\textbf{Доказательство $\Lto$}\\
Граф связен\\
Граф ацикличен -- если это не так, то между вершинами в цикле есть два простых пути\\
Отсюда это дерево\\
\textbf{Теорема}\\
$G$ -- связен $\LRto G$ связен и любое ребро -- мост\\
\textbf{Определение}\\
$G$ -- граф\\
$H$ -- получен удалением из $G$ вершин и/или ребер\\
$H$ -- \textit{подграф} $G$\\
\textbf{Определение}\\
$G$ -- граф\\
$H$ -- получен из $G$ удалением вершин (и ребер, выходящих из них)\\
$H$ -- \textit{индуцированный} подграф $G$\\
\textbf{Определение}
$G$ -- граф\\
$H$ -- получен из $G$ удалением ребер с сохранением связности\\
$H$ -- \textit{остовный} подграф $G$\\
\textbf{Теорема}\\
У любого связного графа есть остовное дерево\\
\textbf{Доказательство 1}\\
Обойдем граф bfs-ом и получим дерево\\
\textbf{Доказательство 2}\\
Среди всех остовных подграфов возьмем граф с минимальным количеством ребер\\
Утверждается, что он будет деревом\\
\textbf{Доказательство 3 (жадный алгоритм)}\\
Будем удалять ребра, пока граф связен\\
Мы получим ацикличный связный граф\\\\
Научимся считать количество остовных деревьев\\
Рассмотрим матрицу $n\times n$:\\
На диагонали напишем степень вершины\\
В остальных клетках поставим -1, если вершины соединены ребром, иначе 0\\
\textbf{Определение}\\
\textit{Матрица Кирхгофа} -- матрица $n\times n$ такая, что $a_{ij} = \left\{\begin{array}{cc}
    \deg i & i = j\\
    -1 & ij\in E\\
    0 & 
\end{array}\right.$\\
\textbf{Теорема}\\
Пусть $G$ -- связный граф\\
Тогда количество остовных деревьев $G = \widehat{A_ij}\ \fall i,j$ -- алгебраическое дополнение любого элемента матрицы $A$\\
\textbf{Лемма 1}\\
Рассмотрим \textit{матрицу инцидентности} $I_G$\\
Это матрица $n\times m, m = |E|$\\
В ней каждой вершине соответствует строка, каждому ребру соответствует столбец\\
$(I_G)_{ve} = \left\{\begin{array}{cc}
    1 & e = vu \lor e = uv\\
    0 & 
\end{array}\right.$\\
$(I_G I_G^T)_{ij} = \left\{\begin{array}{cc}
    \deg i & i = j\\
    1 & ij\in E\\
    0 & 
\end{array}\right.$\\
Ориентируем граф (для каждого ребра выберем направление). Теперь началу будет соответствовать 1, концу -- -1\\
$(\overrightarrow{I_G})_{ve} = \left\{\begin{array}{cc}
    1 & e = vu\\
    -1 & e = uv\\
    0 & 
\end{array}\right.$\\
$(\overrightarrow{I_G} \overrightarrow{I_G}^T)_{ij} = \left\{\begin{array}{cc}
    \deg i & i = j\\
    -1 & ij\in E\\
    0 & 
\end{array}\right.$\\
$\overrightarrow{I_G} \overrightarrow{I_G}^T =$ матрица Кирхгофа\\\\
\textbf{Лемма 2}\\
Рассмотрим $\overrightarrow{I_G}$\\
Выберем $n-1$ ребро\\
Рассмотрим столбцы, соответствующие этим ребрам\\
Удалим строку, соответствующую вершине $u$ ($u$ любая)\\
Мы получили матрицу $n-1\times n-1$\\
Обозначим ее как $B$\\
Если выбранные ребра образуют остовное дерево, то $|B| = \pm 1$, иначе $|B| = 0$\\
\textbf{Доказательство}\\
Рассмотрим граф $T$, образованный всеми вершинами и выбранными ребрами\\
Докажем, что если $T$ не дерево, то $|B| = 0$\\
Т.к. это не дерево и в нем $n-1$ ребро, то граф не связен\\
Рассмотрим компоненту связности, не содержащую $u$\\
Сложим строки, соответствующие вершинам из этой компоненты\\
Утверждается, что сумма $= \0$\\
Отсюда матрица вырожденная\\
Докажем, что если $T$ -- дерево, то $|B| = \pm 1$\\
По лемме у дерева есть два листа\\
Тогда есть как минимум один лист, не равный $u$. Назовем его $v_1$\\
Переставим строчку, соответствующую $v$, на первое место\\
От этого определитель не изменится с точностью до знака\\
Т.к. $v_1$ -- лист, то в соответствующей строчке будет ровно одно число, отличное от 0. Переставим столбец в начало матрицы\\
От этого определитель не изменится с точностью до знака\\
Рассмотрим дерево $T_2$, полученное удалением $v_1$ из $T$\\
В нем есть как минимум один лист, не равный $u$. Назовем его $v_2$\\
Переставим строчку, соответствующую $v_2$, на второе место\\
Т.к. $v_2$ -- лист, то в соответствующей строчке (исключая первый столбец) будет ровно одно число, отличное от 0. Переставим столбец на второе место\\
Повторим действия\\
В итоге мы получили нижнедиагональную матрицу, на диагонали которой $\pm 1$\\
Отсюда определитель будет $\pm 1$\\
\textbf{Лемма 3 (Формула Коши-Бине)}\\
Пусть даны матрицы $r\times s$ и $s \times r, r\leq s$\\
$\det AB = \sum_{1 \leq i_1 < \ldots < i_r \leq s} \det A^{i_1\ldots i_r}\det B_{i_1\ldots i_r}, A^{i_1\ldots i_r}$ -- оставили только столбцы $i_1\ldots i_r, B_{i_1\ldots i_r}$ -- оставили только строки $i_1\ldots i_r$\\\\
\textbf{Лемма 4}\\
$\widehat{A_ii} = \det (\overrightarrow{I_G}_{\text{без i строки}} \overrightarrow{I_G}^T_{\text{без i столбца}})$\\
Т.к. $m=|E| \geq n-1$, применим лемму 3:\\
$\widehat{A_ij} = \det (\overrightarrow{I_G}_{\text{без i строки}} \overrightarrow{I_G^T}^{\text{без i столбца}}) = \sum_{1 \leq i_1 < \ldots < i_{n-1} \leq m} \ub{1\text{, если образует ост.д, иначе 0}}{\det \overrightarrow{I_G}^{i_1\ldots i_{n-1}}_{\text{без i строки}}\det\overrightarrow{I_G^T}_{i_1\ldots i_{n-1}}^{\text{ без i столбца}}}$\\
Отсюда $\widehat{A_ij} = $ кол-во остовных деревьев
\subsection{Ориентированные деревья}
\textbf{Определение}\\
Пусть $G$ -- ориентированный граф\\
\textit{Подвешенное корневое дерево} -- ориентированное дерево, в котором из каждой вершины можно добраться в корень\\
\textit{Обратное подвешенное корневое дерево} -- ориентированное дерево, в котором из корня можно добраться в каждую вершину\\
\textbf{Теорема Тутта}\\
\textit{Лапласиан} графа $G$ -- матрица $(L(G))_{ij} = \left\{\begin{array}{cc}
    \deg^- i & i = j\\
    -1 & ij\in E\\
    0 & 
\end{array}\right.$ -- позволяет искать исходящиие остовные корневые деревья\\
(Для входящих $\deg^+$ и $ji \in E$)\\
Количество остовных корневых деревьев с корнем $i$ равно $\widehat{L(G)}_{ii}$\\\\
\textbf{Определение}\\
Пусть $f: \{1,\ldots, n\} \rto \{1,\ldots, n\}$\\
\textit{Функциональный граф} -- граф $G: (i, f(i)) \in E$\\
В функциональном графе каждая компонента имеет вид цикла, в которого входят деревья\\
Всего существует $n^n$ функциональных графов\\
Число функциональных подграфов $ = \prod_{u\in v} \deg^- u$
\subsection{Обход графа}
\textbf{Определение}\\
\textit{Эйлеров путь/цикл} -- путь/цикл, проходящий по каждому ребру в графе ровно один раз\\
\textit{Гамильтонов путь/цикл} -- путь/цикл, проходящий по каждой вершине в графе ровно один раз\\
Если в графе существует Эйлеров цикл, то граф называется \textit{Эйлеровым} (или граф без ребер)\\
\textbf{Теорема}\\
$G$ -- Эйлеров $\LRto$ Все его ребра лежат в одной компоненте связности и $\fall v\ \deg v$ -- четное\\
\textbf{Доказательство $\Rto$}\\
Заметим, что в каждую вершину мы вошли и вышли\\
Остюда степени четные и компонента связности одна\\
\textbf{Доказательство $\Lto$}\\
Н.у.о. будем считать, что в финальном графе одна компонента связности\\
Докажем индукцией по числу ребер\\
Если ребер 0, доказано\\
Пусть ребер $> 0$\\
//todo\\
\textbf{Теорема}\\
$G$ содержит эйлеров путь $\LRto$ Все его ребра лежат в одной компоненте связности и в графе не более двух вершин нечетной степени\\
\textbf{Доказательство}\\
Если она одна, то начнем обход в ней\\
Если их две, то соединим их фиктивной вершиной, найдем эйлеров цикл, после чего удалим ее\\
\textbf{Теорема}\\
Ориентированный граф содержит эйлеров цикл $\LRto$ граф слабо связен и $\fall v\ \deg^-(v)=\deg^+(v)$\\
\textbf{Теорема}\\
Ориентированный граф содержит эйлеров путь $\LRto$ граф слабо связен и $\deg^-(v)=\deg^+(v)$ для не более чем двух вершин $a, b$, а $\deg^+(a) = \deg^-(a) + 1$ и $\deg^+(b) = \deg^-(b) - 1$\\
\textbf{Задача}\\
Покрыть неориентированный граф минимальным количеством реберно простых путей, чтобы все ребра были покрыты\\
Всего их $\sum_{C \text{ -- к. св. с ребрами} G} \max(\frac{\nm{odd}(C)}2, 1), \nm{odd}(C)$ -- кол-во вершин нечетной степени в $C$\\
Покрыть ориентированный граф минимальным количеством реберно простых путей, чтобы все ребра были покрыты\\
Всего их $\sum_{C \text{ -- к. св. с ребрами} G} \max(\sum_{u\in C, \deg^+ u < \deg^- u}(\deg^- u - \deg^+ u), 1)$\\
\textbf{BEST-Теорема}\\
В слабо связном ориентированном эйлеровом графе число корневых деревьев всех вершин совпадает, а число эйлеровых циклов $E = A\prod_{u\in V} (\deg^- u - 1)!$\\
\textbf{Доказательство}\\
Выберем стартовое ребро $xr$\\
//todo лекция 3
\end{document}
