\documentclass[12pt]{article}
\input{../../header.tex}

\title{Дискретная математика. Теория}
\author{Александр Сергеев}
\date{}
\begin{document}
\maketitle
\section{Производящие функции}
\textbf{Определение}\\
\textit{Формальный степенной ряд}(производящая функция) -- $A(t) = \sum_{n=0}^\infty a_nt^n$\\
\textit{Формальный} означает, что вместо $t$ мы ничего не подставляем\\
Формальный степенной ряд -- некоторый способ задавать последовательность\\
$A(t) = a_0 + a_1t^1 + a_2t^2 + \ldots$\\
$B(t) = b_0 + b_1t^1 + b_2t^2 + \ldots$\\
$C=A + B = (a_0+b_0) + (a_1+b_1)t^1 + \ldots$\\
$C=A - B = (a_0-b_0) + (a_1-b_1)t^1 + \ldots$\\
$C=A \cdot B = (a_0b_0) + (a_1b_0 + a_0b_1)t^1 + (a_2b_0 + a_1b_1 + a_0b_2)t^2\ldots$\\
$c_n = \sum_{k=0}^na_kb_{n-k}$\\
$C=\frac{A}{B}$:\\
$A=C\cdot B$\\
Потребуем $b_0 \neq 0$\\
$a_0 = c_0b_0 \Rto c_0 = \frac{a_0}{b_0}$\\
$a_1 = c_0b_1 + c_1b_0 \Rto c_1 = \frac{a_1-c_0b_1}{b_0}$\\
$c_n = \frac{a_n - \sum_{k=0}^{n-1}c_kb_{n-k}}{b_0}$\\
Если $a_0 \neq 0, b_0 = 0$, то получаем, что числитель не делится на $t$, а знаменатель делится\\
Т.о. такая дробь не является степенным рядом\\
Если $a_0=0, b_0 = 0$\\
Тогда мы можем сократить на $t$\\\\
$B:=A'$ -- формальная производная\\
$b_n=(n+1)a_{n+1}$\\
$(A\pm B)' = A'\pm B'$\\
$(A\cdot B)' = A'\cdot B + A\cdot B'$\\
$\frac{A}{B} = \frac{A'B - AB'}{B^2}$\\\\
\textbf{Пример}\\
$\frac{1}{1-t} = \sum t^n$\\
$(\frac1{1-t})'t = \frac{t}{(1-t)^2} = \sum nt^n$\\\\
$A(B(t))$ -- возможно только при $b_0 = 0$\\
$C = A(B(t)) = a_0 + a_1(b_1t + b_2t^2 + b_3t^3+\ldots) + a_2(b_1t + b_2t^2 + b_3t^3+\ldots)^3 + \ldots = a_0 + (a_1b_1)t + (a_1b_2 + a_2b_1^2)t^2 + (a_1b_3 + a_2b_1b_2 + a_2b_2b_1 + a_3b_1^3)t^3+\ldots$\\
$c_n = \sum_{k=1}^n a_k\sum_{n=s_1+\ldots+s_k} \prod_{i=1}^{k}b_{s_k}$\\
$(A(B))' = A'(B)B'$\\
$B:=\int A$ -- формальная первообразная\\
$b_n = \frac{a_{n-1}}{n}$\\
$b_0$ -- может быть различным\\
\section{Дробно-рациональные производящие функции}
\textbf{Определение}\\
\textit{Дробно-рациональная производящая функция} $A(t) = \frac{P(t)}{Q(t)}, q_0 \neq 0, P, Q$ -- конечные многочлены\\
\textbf{Определение}\\
Линейное рекуррентное соотношение -- $a_n = \sum_{i=1}^k c_ia_{n-i}$\\
$a_1, \ldots, a_k$ -- конкретные значения\\
\textbf{Теорема ч.1 (теорема о дробно-рациональных производящих функциях)}\\
$A(t) = \frac{P(t)}{Q(t)} \LRto a_n = \sum_{i=1}^k c_ia_{n-i} \land Q(t) = 1-c_1t-\ldots - c_kt^k$\\
\textbf{Доказательство $\Rto$}\\
$Q(t) = q_0 + \ldots + q_kt^k$\\
$1 + \frac{q_1}{q_0}t + \ldots + \frac{q_k}{q_0}t^k$\\
$c_i = -\frac{q_i}{q_0}$\\
$P(t) := \frac{P}{q_0}$\\
Рассмотрим $\frac{P}{1-c_1t - \ldots - c_kt^k}$\\
Для $n > \max(k, \deg P)$\\
$a_n = \frac{p_n - \sum_{i=0}^{n-1} a_i(-c_{n-i})}{c_0} = \sum_{i=1}^k a_{n-i}c_i$\\
Уберем исходное требование\\
$a_n = \sum_{i=1}^k (c_i\cdot \left[\begin{array}{cc}
    a_{n-i},& n \geq i\\
    0,& n < i
\end{array}\right]) + p_n$\\
\textbf{Доказательство $\Lto$}\\
$n \geq m$\\
$a_n = c_1a_{n-1} + \ldots + c_ka_{n-k}$\\
Рассмотрим $A(t) = a_0 + a_1t + a_2t^2 + \ldots$\\
$c_1t A(t) = c_1a_0t + c_1a_1t^2 + c_1a_2t^3 + \ldots$\\
$c_2t^2 A(t) = c_2a_0t^2 + c_2a_1t^3 + c_2a_2t^4 + \ldots$\\
$c_kt^k A(t) = c_ka_0t^k + c_ka_1t^{k+1} + c_ka_2t^{k+2} + \ldots$\\
$A(t)(1-c_1t-c_2t^2 - \ldots - c_kt^k) = P(t), \deg P \leq m$\\
$A(t) = \frac{P}{1-c_1t-c_2t^2 - \ldots - c_kt^k}$\\\\\\
Рассмотрим $a_n = c_1a_{n-1} + \ldots + c_ka_{n-k}$\\
$\begin{pmatrix}
    a_n\\\vdots\\a_{n-k+1}
\end{pmatrix} = \begin{pmatrix}
    c_1 & c_2 & \ldots & c_k\\
    1 & 0 & \ldots & 0\\
    \vdots & \ddots & \ddots & \vdots\\
    0 & \ldots & 1 & 0\\
    0 & \ldots & 0 & 1
\end{pmatrix}\begin{pmatrix}
    a_{n-1}\\\vdots\\a_{n-k}
\end{pmatrix}$\\
Применяя быстрое возведение матрицы в степень, можно найти $a_n$ за $O(k^3\log n)$\\\\\\
Рассмотрим $\frac{P}{Q}$\\
$\frac{P(t)}{Q(t)} \cdot \frac{Q(-t)}{Q(-t)} = \frac{P(t)Q(-t)}{Q_2(t)}$, где $Q_2$ -- многочлен, где все нечетные коэффициенты нулевые\\
$Q_2 = \ot Q(t^2)$\\
Это следует из того, что $Q(t)Q(-t)$ -- четная функция\\
$\deg Q = \deg \ot Q$\\
$\frac{P(t)}{Q(t)} = \frac{P(t)Q(-t)}{\ot Q(t^2)} = \frac{\ot P(t^2) + t\ol P(t^2)}{\ot Q(t^2)}$ (разбили на четные и нечетные степени)\\
Заметим, что нечетная подпоследовательность и четная подпоследовательность не связаны\\
У последовательности четных членов производящая функция -- $\frac{\ot P}{\ot Q}$, у нечетных -- $\frac{\ol P}{\ot Q}$\\
Т.о. мы можем каждый раз уменьшать последовательность в два раза\\
Итого асимтотика $O(k^2\log n)$\\
\textbf{Теорема ч.2 (о линейных рекуррентных соотношениях)}\\
Тогда эквивалентны:
\begin{enumerate}
    \item $n \geq m$\ $a_n = \sum_{i=1}^k c_i a_{n-i}$
    \item $A(t) = \frac{P(t)}{Q(t)}, Q(t) = 1-c_1t-\ldots-c_kt^k$
    \item $a_n = \sum_{i=1}^s p_i(n) r_i^n, p_i$ -- многочлен, $r_i \in \Cset$
\end{enumerate}
\textbf{Доказательство $2 \Rto 3$}\\
Пусть $Q = \prod_{i=1}^{s}(1-r_it)^{d_i}$\\
$t_i=\frac{1}{r_i}$ -- корни кратности $d_i$\\
$\deg p_i = d_i-1$\\
\textbf{Лемма (о разложении на простые дроби)}\\
$Q(t) = \prod_{i=1}^{s} (1-r_it)^{d_i}$\\
Тогда $\frac{P(t)}{Q(t)} = \sum_{i=1}^s \frac{P_i(t)}{(1-r_it)^{d_i}}$\\\\
$\frac{P(t)}{Q(t)} = \sum_{i=1}^s \frac{P_i(t)}{(1-r_it)^{d_i}} = \sum_{i=1}^s A_i(t)$\\
$a_n = \sum_{i=1}^s a_{i,n}$\\
\textbf{Лемма}\\
$\frac1{(1-rt)^d} = \sum_{n=0}^\infty p_d(n)r^nt^n$\\
$\deg p_d = d-1$\\
\textbf{Доказательство}
\begin{enumerate}
    \item База $d = 1$:\\
    $\frac1{1-rt} = 1 + rt + r^2t^2 + \ldots; a_n=r^n$
    \item переход\\
    $(\frac1{(1-rt)^d})' = \sum_{n=0}^\infty (n+1)p_s(n+1)r^{n+1}t^n$\\
    $\frac1{(1-rt)^{s+1}} = \sum_{n=0}^\infty \frac{n+1}s p_s(n+1)r^nt^n$\\
    $p_{s+1}(n)=p_s(n+1)\frac{n+1}{s} = \sum_{i=0}^{s-1} p_{s,i}(n+1)^i \frac{n+1}{s}$\\
    $p_{s,i} = \frac{a_{s,i}}{s!}, a_{s,i} \in \Zset$
\end{enumerate}
\textbf{Доказательство $3\Rto 2$}\\
Достаточно доказать, что если $a_n = n^{d-1}r^n$, то $A(t) = \frac{P(t)}{(1-rt)^d}$\\
\begin{enumerate}
    \item $d=1$\\
    Слева:\\
    $a_n = r^n$\\
    Справа:\\
    $A(t) = \frac{1}{1-rt}$
    \item $A_d(t) = \frac{P_d(t)}{(1-rt)^d}$\\
    Справа:\\
    $\frac1rA'_d(t) = \frac1r\frac{P_d'(t)(1-rt)^d+rd(1-rt)^{d-1}P_d(t)}{(1-rt)^{2d}} = \frac1r\frac{P_d'(t)(1-rt)+rP_d(t)}{(1-rt)^{d+1}}$\\
    Слева:\\
    $a_n = (n+1)^{d-1}(n+1)r^{n+1}\frac1r=(n+1)^dr^{n}=n^dr^n + \sum_{i=1}^d \binom{d}{i}n^{d-i}r^n$\\
    $A(t) = \frac{1}{r}(A'_d(t)) - \sum_{i=1}^d\binom{d}{i}\frac{P_{d-i}(t)}{(1-rt)^{d-i+1}}$
\end{enumerate}
Попробуем найти производящую функции чисел Каталана\\
$c_n = \sum_{i=0}^{n-1} c_ic_{n-1-i}$\\
Пусть $C(t) = c_0 + c_1t + \ldots$\\
$C(t)C(t)t = C(t)-1$\\
$C^2(t)t + 1 = C(t)$\\
$C^2(t)t - C(t) + 1 = 0$\\
$C(t) = \frac{1\pm\sqrt{1-4t}}{2t}$\\
$\sqrt{1-4t} = \sum_{k=0}^\infty \binom{\frac12}{k}(-4t)^k$\\
$C(t) = \frac{1+\sqrt{1-4t}}{2t}$ -- некорректная дробь, т.к. на $t$ делить нельзя\\
$C(t) = \frac{1-\sqrt{1-4t}}{2t} = \frac{1-\sum_{k=0}^\infty \binom{\frac12}{k}(-4t)^k}{2t} = \frac{-\sum_{k=1}^\infty \binom{\frac12}{k}(-4t)^k}{2t}$\\
$C(t) = \frac{2^n(2n+1)!!}{n!}$ (почему-то численно не сходится)
\section{Конструируемые комбинаторные объекты}
Мы будем говорить о непомеченных комбинаторных объектах\\
Представим, что $A(t) \lrto a_0, a_1, \ldots, a_n, \ldots$\\
$a_n$ -- количество комбинаторных объектов размера $n$\\
Комбинаторные объекты размеров $n$ и $m$ можно сложить в комбинаторный объект размера $n+m$ единственным способом\\
$A\sqcup B \lrto A + B$ -- объединение дизъюнктных множество\\
$A \times B \lrto AB$\\
$C = List(A) = \sqcup_{k=0}^\infty A^k$\\
$C(t) = \sum_{k=0}^\infty A^k(t) = \frac{1}{1-A(t)}$\\
$List(A) = \ub{[\ ]}1 + A\times List(A)$\\
\textbf{Пример (натуральные числа)}\\
$\Nset_0 = \Nset \cup \{0\}$\\
$U = \{0\}$\\
$U(t) = t$\\
$\Nset_0 = List(U) = \frac{1}{1-t} = 1 + t + t^2 + t^3 + \ldots$\\
$\Nset = \frac{1}{1-t} - 1 = \frac{t}{1-t}$\\
\textbf{Пример (натуральные числа)}\\
$B=\{\circ, \bullet\}$\\
$B(t) = 2t$\\
$List(B) = \frac{1}{1-2t}$\\
\textbf{Пример (замощение)}\\
$D = \{-^2, \text{|}\}$\\
$D(t) = t + t^2$\\
$List(D) = \frac{1}{1-t-t^2}$\\\\
$Set(A) = \prod_{x\in A} (1+x)$ -- каждый объект либо берем, либо нет\\
//$w(x)$ -- количество объектов в $x$ | вес $x$\\
$Set(A) = \prod_{k=0}^\infty \prod_{x\in A, w(x)=k}(1+x)$ -- сгруппируем по весу\\
$Set(A) = \prod_{k=0}^\infty (1+t^k)^{a_k} = B$\\
//$[t^n]A$ -- возвращает множитель при $t^n$\\
$b_n = [t^n] \prod_{k=0}^\infty (1+t^k)^{a_k} = [t^n]\prod_{k=0}^n (1+t^k)^{a_k}$\\\\
$Set(U) = 1 + t$\\
$Set(B) = 1 + 2t + t^2$\\
$Set(N) = \prod_{k=1}^n (1+t^k) = 1 + t + t^2 + 2t^3 + 2t^4 + 3t^5 + 4t6+ \ldots$ -- количество разбиений на различные слагаемые\\\\
$Multiset(A) = \prod_{x\in A} (1+x+x^2+x^3 + \ldots) = \prod_{x\in A} \frac1{1-x} = \prod_{k=0}^\infty \frac{1}{(1-t^k)^{a_k}}$\\
$MSet(U) = \frac{1}{1-t}$\\
$MSet(B) = (\frac1{1-t})^2$\\
$MSet(N) = \sum_{k=0}^\infty p_nt^n, p_n$ -- число разбиений $n$ на слагаемые\\\\
$Cyc(A) = List(A) /_{\sim}, \sim$ -- равенство с точностью до перестановки\\
$C_n$ -- циклы веса $n$\\
$C_n = \bigcup_{l=1}^n C_{n,l}$\\
//todo продолжить
\section{Регулярные языки}
\textbf{Напоминание}\\
\textit{Регулярный язык} -- язык, который можно задать регулярным выражением\\
\textit{Регулярный язык} -- язык, который можно задать детерменированным конечным автоматом\\\\
Язык $L \subset \Sigma^*$\\
$\Sigma^m \lrto \lrto \frac1{1-|\Sigma|t}$\\
Казалось бы, $| \lrto \cdot, \cup \lrto Seq, + \lrto \frac1{1-\bullet}$\\
Но бывают проблемы\\
\textbf{Определение}\\
Регулярное выражение -- однозначное, если любая строка однозначно <<метчится>> с регулярным выражением\\
К примеру, $(a|b)^*a(a|b)^*$ неоднозначное, поэтому для него производящие функции будут работать неверно\\
Его можно перестроить в $b^*a(a|b)^*$\\
\textbf{Теорема}\\
$L$ -- регулярное $\LRto \ex S$ -- регулярное выражение для $L$\\\\
Пусть $L$ -- язык\\
$A$ -- ДКА для $L$\\
Для вершины $u: L_u = \{x: x \os x\leadsto t, t \in T\}$\\
$L = L_s, s$ -- стартовая\\
$u \not\in T: L_u = c_1 L_{\sigma(u, c_1)} \cup \ldots \cup c_m L_{\sigma(u, c_m)}$\\
$u \in T: L_u = c_1 L_{\sigma(u, c_1)} \cup \ldots \cup c_m L_{\sigma(u, c_m)} \cup \eps$\\
$u \not\in T: L_u(t) = \sum tL_{\sigma(u, c_i)}(t)$\\
$u \in T: L_u(t) = \sum tL_{\sigma(u, c_i)}(t) + 1$\\
$\vect{L(t)} = \begin{pmatrix}
    L_1(t)\\\vdots\\L_q(t)
\end{pmatrix}$
$\Delta_{i,j}= \text{число ребер} i \rto j$\\
$\vect{L(t)} = t\Delta \vect{L(t)} + \vect f$\\
$\vect f_i = \left\{\begin{array}{cc}
    1,& i \in T\\
    0,& i \not \in T
\end{array}\right.$\\
$(I - t\Delta)\vect{L(t)} = \vect f$\\
$\vect{L(t)} = (I - t\Delta)^{-1} \vect f$\\
$\det I-t\Delta = \sum_\sigma \prod_i (I-t\Delta)_{i, \sigma_i} = \prod_i (I-t\Delta)_{i,i} + \sum_{\sigma \neq id} \prod_i (I-t\Delta)_{i, \sigma_i} = \ub{1+tP(t)}{\prod_{i=1}^q (1-\sigma_{i,i}t)} + \ub{tQ(t)}{\sum_{\sigma \neq id} \prod_i (I-t\Delta)_{i, \sigma_i}} = 1 + t(P(t) + Q(t))$\\
$(I - t\Delta)^{-1} = \frac{Q(t)}{1 + t(P(t)+Q(t))}$\\\\
\textbf{Теорема}\\
$L$ -- регулярный $\Rto L(t)$ -- дробно-рациональное\\
$L(t) = \vect{S}^t (I-t\Delta)^{-1}\vect f$\\
$\vect S_i = \left\{\begin{array}{cc}
    1,& i = s\\
    0,& i \neq s
\end{array}\right.$\\\\
\textbf{Определение}\\
Бордер строки $s$ -- одновременный префикс и суффикс $s$\\
$c_i = \left\{\begin{array}{cc}
    1,& s[i:]=s[:-i]\\
    0&
\end{array}\right.$\\
$c(t)$ -- автокорреляционный многочлен $s$\\
$S$ -- не содержит подстроки $s$\\
$T$ -- содержит $s$, единственное вхождение как суффикса\\
$S + T = \eps + S\times \Sigma$\\
$S(t) + T(t) = 1 + mtS(t)$\\
$S(t)t^k = T(t)c(t)$\\
Отсюда $S(t) = \frac{c(t)}{(1-mt)c(t)+t^k}$\\
\textbf{Пентагональная теорема Эйлера}\\
Разбиения на слагаемые:\\
$P(t) = \prod_{i=1}^\infty \frac1{1-t^i} = \frac{1}{Q(t)}$\\
$Q(t) = \prod_{i=1}^\infty (1-t^i) = 1 - t - t^2 + t^5 + t^7 - t^{12} - t^{15} + \ldots$\\
$R(t) = \prod_{i=1}^\infty (1+t^i)$ -- разбиения на различные слагаемые\\
$q_n = e_n - o_n, e_n$ -- число разбиений на четное число различных слагаемых, $o_n$ -- на нечетное число различных слагаемых\\
\textbf{Лемма}\\
$n \neq \frac{3k^2 \pm  k}{2}$\\
Тогда $e_n = o_n$\\
$n = \frac{3k^2 \pm k}{2}$\\
$e_n - o_n = (-1)^k$\\
$Q(t) = 1 + \sum_{k=1}^\infty (-1)^k (t^{\frac{3k^2+k}2}+t^{\frac{3k^2-k}2})$
\section{Экспоненциальные производящие функции и помеченные комбинаторные объекты}
$a_0, a_1, \ldots \lrto A(t) = \sum_{n=0}^{\infty} \frac{a_n}{n!}t^n$\\
$b_0, a_2, \ldots \lrto B(t) = \sum_{n=0}^\infty \frac{b_n}{n!}t^n$\\
$a_n + b_n \lrto A(t) + B(t)$\\
$\frac{c_n}{n!} = \sum_{k=0}^{n} \binom{n}{k}a_k b_{n-k} \lrto A(t)B(t) = C(t)$\\\\
$A \times B \lrto A(t)B(t)$ -- количество пар с различными нумерациями\\
$a_n = n! \lrto \frac{1}{1-t}$\\
$b_n = a_{n+1} \lrto B = A'$\\
$a_n = 1 \lrto e^t$\\
Найдем $B = Seq(A): B = 1 + A\times B$\\
$B = \frac{1}{1-A}$\\
$Set = MSet = \sum_{k=0}^\infty \frac{A^k}{k!} = e^{A(t)}$\\
$Set(U = \{\circ\}) = e^t \lrto a_n = 1$\\
$B = \{\circ, \bullet\}$\\
$Set(B) = e^{2t}$\\
Числа Белла -- количество способов разбить множество на какие-то множества\\
$B = Set(\ub{\Nset}{Set(U) - 1}) = e^{e^t - 1}$\\\\
$A(t) = t^k e^t$ (размещения по $k$)\\
$a_n = \frac{n!}{(n-k)!}$\\
$C(t) = \frac{t^k}{k!} e^t$ (сочетания по $k$)\\
$C_n = \frac{n!}{(n-k)!k!}$\\
Числа Стирлинга по $k$\\
$\frac{(e^t - 1)^k}{k!}$ -- число Стирлинга 2 рода по $k$\\\\
$Cyc(A) = \sum_{k=1}^{\infty} \frac{A^k}{k} = -\ln(1 - A(t)) = \ln(\frac{1}{1-A(t)}) = \ln(Seq(A(t)))$\\
$Cyc(U)$ -- перестановки с точностью до циклического сдвига\\
$Set(Cyc (U)) = Seq (U)$\\
Числа Стирлинга 1 рода по $k$\\
$\frac{Cyc(U)^k}{k!}$\\
Деревья\\
$T = U \times Seq(T)$ -- деревья с порядком на детях\\
$T = U \times Set(T)$ -- деревья без порядка на детях

\end{document}